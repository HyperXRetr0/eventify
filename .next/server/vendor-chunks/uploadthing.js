"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/uploadthing";
exports.ids = ["vendor-chunks/uploadthing"];
exports.modules = {

/***/ "(ssr)/./node_modules/uploadthing/client/index.js":
/*!**************************************************!*\
  !*** ./node_modules/uploadthing/client/index.js ***!
  \**************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   genUploader: () => (/* binding */ genUploader),\n/* harmony export */   generateClientDropzoneAccept: () => (/* reexport safe */ _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateClientDropzoneAccept),\n/* harmony export */   generateMimeTypes: () => (/* reexport safe */ _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateMimeTypes),\n/* harmony export */   generatePermittedFileTypes: () => (/* reexport safe */ _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generatePermittedFileTypes),\n/* harmony export */   version: () => (/* binding */ version)\n/* harmony export */ });\n/* harmony import */ var _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @effect/schema/Schema */ \"(ssr)/./node_modules/@effect/schema/dist/esm/Schema.js\");\n/* harmony import */ var effect_Effect__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! effect/Effect */ \"(ssr)/./node_modules/effect/dist/esm/Effect.js\");\n/* harmony import */ var _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @uploadthing/shared */ \"(ssr)/./node_modules/@uploadthing/shared/dist/index.js\");\n/* harmony import */ var effect_Cause__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! effect/Cause */ \"(ssr)/./node_modules/effect/dist/esm/Cause.js\");\n/* harmony import */ var std_env__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! std-env */ \"(ssr)/./node_modules/std-env/dist/index.mjs\");\n\n\n\n\n\n\nvar version$1 = \"6.10.1\";\nconst uploadMultipartWithProgress = (file, presigned, opts)=>effect_Effect__WEBPACK_IMPORTED_MODULE_1__.gen(function*() {\n        let uploadedBytes = 0;\n        const etags = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_1__.forEach(presigned.urls, (url, index)=>{\n            const offset = presigned.chunkSize * index;\n            const end = Math.min(offset + presigned.chunkSize, file.size);\n            const chunk = file.slice(offset, end);\n            return uploadPart({\n                url,\n                chunk: chunk,\n                contentDisposition: presigned.contentDisposition,\n                fileType: file.type,\n                fileName: file.name,\n                onProgress: (delta)=>{\n                    uploadedBytes += delta;\n                    const percent = uploadedBytes / file.size * 100;\n                    opts.onUploadProgress?.({\n                        file: file.name,\n                        progress: percent\n                    });\n                }\n            }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_1__.andThen((tag)=>({\n                    tag,\n                    partNumber: index + 1\n                })), effect_Effect__WEBPACK_IMPORTED_MODULE_1__.retry({\n                while: (error)=>error instanceof _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError,\n                times: std_env__WEBPACK_IMPORTED_MODULE_2__.isTest ? 3 : 10,\n                schedule: _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.exponentialBackoff\n            }));\n        }, {\n            concurrency: \"inherit\"\n        }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_1__.tapErrorCause((error)=>opts.reportEventToUT(\"failure\", {\n                fileKey: presigned.key,\n                uploadId: presigned.uploadId,\n                fileName: file.name,\n                storageProviderError: effect_Cause__WEBPACK_IMPORTED_MODULE_3__.pretty(error).toString()\n            }, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Null)));\n        // Tell the server that the upload is complete\n        yield* opts.reportEventToUT(\"multipart-complete\", {\n            uploadId: presigned.uploadId,\n            fileKey: presigned.key,\n            etags\n        }, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Null);\n    });\nconst uploadPart = (opts)=>effect_Effect__WEBPACK_IMPORTED_MODULE_1__.async((resume)=>{\n        const xhr = new XMLHttpRequest();\n        xhr.open(\"PUT\", opts.url, true);\n        xhr.setRequestHeader(\"Content-Type\", opts.fileType);\n        xhr.setRequestHeader(\"Content-Disposition\", (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.contentDisposition)(opts.contentDisposition, opts.fileName));\n        xhr.addEventListener(\"load\", ()=>{\n            const etag = xhr.getResponseHeader(\"Etag\");\n            if (xhr.status >= 200 && xhr.status <= 299 && etag) {\n                return resume(effect_Effect__WEBPACK_IMPORTED_MODULE_1__.succeed(etag));\n            }\n            return resume(effect_Effect__WEBPACK_IMPORTED_MODULE_1__.fail(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError()));\n        });\n        xhr.addEventListener(\"error\", ()=>resume(effect_Effect__WEBPACK_IMPORTED_MODULE_1__.fail(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError())));\n        let lastProgress = 0;\n        xhr.upload.addEventListener(\"progress\", (e)=>{\n            const delta = e.loaded - lastProgress;\n            lastProgress += delta;\n            opts.onProgress(delta);\n        });\n        xhr.send(opts.chunk);\n    });\nconst uploadPresignedPostWithProgress = (file, presigned, opts)=>effect_Effect__WEBPACK_IMPORTED_MODULE_1__.async((resume)=>{\n        const xhr = new XMLHttpRequest();\n        xhr.open(\"POST\", presigned.url);\n        xhr.setRequestHeader(\"Accept\", \"application/xml\");\n        xhr.upload.addEventListener(\"progress\", ({ loaded, total })=>{\n            opts.onUploadProgress?.({\n                file: file.name,\n                progress: loaded / total * 100\n            });\n        });\n        xhr.addEventListener(\"load\", ()=>resume(xhr.status >= 200 && xhr.status < 300 ? effect_Effect__WEBPACK_IMPORTED_MODULE_1__.succeed(null) : opts.reportEventToUT(\"failure\", {\n                fileKey: presigned.key,\n                uploadId: null,\n                fileName: file.name,\n                storageProviderError: xhr.responseText\n            }, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Null)));\n        xhr.addEventListener(\"error\", ()=>resume(opts.reportEventToUT(\"failure\", {\n                fileKey: presigned.key,\n                uploadId: null,\n                fileName: file.name\n            }, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Null)));\n        const formData = new FormData();\n        Object.entries(presigned.fields).forEach(([k, v])=>formData.append(k, v));\n        formData.append(\"file\", file); // File data **MUST GO LAST**\n        xhr.send(formData);\n    });\n/**\n * =============================================================================\n * ======================== File Type Hierarchy ===============================\n * =============================================================================\n */ const FileUploadDataSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    name: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    size: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number,\n    type: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n});\nconst FileUploadDataWithCustomIdSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.extend(FileUploadDataSchema, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    customId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n}));\n_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.extend(FileUploadDataWithCustomIdSchema, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    key: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    url: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n}));\n/**\n * =============================================================================\n * ======================== Server Response Schemas ============================\n * =============================================================================\n */ const PresignedBaseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    key: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    fileName: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    fileType: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    fileUrl: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    pollingJwt: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    pollingUrl: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    contentDisposition: _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.ContentDispositionSchema,\n    customId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n});\nconst MPUResponseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.extend(PresignedBaseSchema, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    urls: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Array(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n    uploadId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    chunkSize: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number,\n    chunkCount: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number\n}));\nconst PSPResponseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.extend(PresignedBaseSchema, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    url: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    fields: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Record(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n}));\nconst PresignedURLResponseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Array(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Union(PSPResponseSchema, MPUResponseSchema));\n_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    status: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    fileData: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n        fileKey: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n        fileName: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n        fileSize: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number,\n        fileType: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n        metadata: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n        customId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n        callbackUrl: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n        callbackSlug: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n    }))\n});\n_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    success: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Boolean,\n    message: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n});\n_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    status: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n});\n/**\n * =============================================================================\n * ======================== Client Action Payloads ============================\n * =============================================================================\n */ _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    files: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Array(FileUploadDataSchema),\n    input: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Unknown\n});\n_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    fileKey: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    uploadId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n    storageProviderError: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n    fileName: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n});\n_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    fileKey: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    uploadId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    etags: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Array(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n        tag: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n        partNumber: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number\n    }))\n});\nconst maybeParseResponseXML = (maybeXml)=>{\n    const codeMatch = maybeXml.match(/<Code>(.*?)<\\/Code>/s);\n    const messageMatch = maybeXml.match(/<Message>(.*?)<\\/Message>/s);\n    const code = codeMatch?.[1];\n    const message = messageMatch?.[1];\n    if (!code || !message) return null;\n    return {\n        code: s3CodeToUploadThingCode[code] ?? DEFAULT_ERROR_CODE,\n        message\n    };\n};\n/**\n * Map S3 error codes to UploadThing error codes\n *\n * This is a subset of the S3 error codes, based on what seemed most likely to\n * occur in uploadthing. For a full list of S3 error codes, see:\n * https://docs.aws.amazon.com/AmazonS3/latest/API/ErrorResponses.html\n */ const DEFAULT_ERROR_CODE = \"UPLOAD_FAILED\";\nconst s3CodeToUploadThingCode = {\n    AccessDenied: \"FORBIDDEN\",\n    EntityTooSmall: \"TOO_SMALL\",\n    EntityTooLarge: \"TOO_LARGE\",\n    ExpiredToken: \"FORBIDDEN\",\n    IncorrectNumberOfFilesInPostRequest: \"TOO_MANY_FILES\",\n    InternalError: \"INTERNAL_SERVER_ERROR\",\n    KeyTooLongError: \"KEY_TOO_LONG\",\n    MaxMessageLengthExceeded: \"TOO_LARGE\"\n};\nconst createAPIRequestUrl = (config)=>{\n    const url = new URL(config.url);\n    const queryParams = new URLSearchParams(url.search);\n    queryParams.set(\"actionType\", config.actionType);\n    queryParams.set(\"slug\", config.slug);\n    url.search = queryParams.toString();\n    return url;\n};\n/**\n * Creates a \"client\" for reporting events to the UploadThing server via the user's API endpoint.\n * Events are handled in \"./handler.ts starting at L112\"\n */ const createUTReporter = (cfg)=>(type, payload, responseSchema)=>effect_Effect__WEBPACK_IMPORTED_MODULE_1__.gen(function*() {\n            const url = createAPIRequestUrl({\n                url: cfg.url,\n                slug: cfg.endpoint,\n                actionType: type\n            });\n            let headers = typeof cfg.headers === \"function\" ? cfg.headers() : cfg.headers;\n            if (headers instanceof Promise) {\n                headers = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_1__.promise(()=>headers);\n            }\n            const response = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)(url, responseSchema, {\n                method: \"POST\",\n                body: JSON.stringify(payload),\n                headers: {\n                    \"Content-Type\": \"application/json\",\n                    \"x-uploadthing-package\": cfg.package,\n                    \"x-uploadthing-version\": version$1,\n                    ...headers\n                }\n            }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_1__.catchTag(\"FetchError\", (e)=>effect_Effect__WEBPACK_IMPORTED_MODULE_1__.fail(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"INTERNAL_CLIENT_ERROR\",\n                    message: `Failed to report event \"${type}\" to UploadThing server`,\n                    cause: e\n                }))), effect_Effect__WEBPACK_IMPORTED_MODULE_1__.catchTag(\"ParseError\", (e)=>effect_Effect__WEBPACK_IMPORTED_MODULE_1__.fail(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"INTERNAL_CLIENT_ERROR\",\n                    message: \"Failed to parse response from UploadThing server\",\n                    cause: e\n                }))));\n            switch(type){\n                case \"failure\":\n                    {\n                        // why isn't this narrowed automatically?\n                        const p = payload;\n                        const parsed = maybeParseResponseXML(p.storageProviderError ?? \"\");\n                        if (parsed?.message) {\n                            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                                code: parsed.code,\n                                message: parsed.message\n                            });\n                        } else {\n                            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                                code: \"UPLOAD_FAILED\",\n                                message: `Failed to upload file ${p.fileName} to S3`,\n                                cause: p.storageProviderError\n                            });\n                        }\n                    }\n            }\n            return response;\n        });\nconst version = version$1;\nconst uploadFilesInternal = (endpoint, opts)=>effect_Effect__WEBPACK_IMPORTED_MODULE_1__.gen(function*() {\n        const reportEventToUT = createUTReporter({\n            endpoint: String(endpoint),\n            package: opts.package,\n            url: (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.resolveMaybeUrlArg)(opts.url),\n            headers: opts.headers\n        });\n        const presigneds = yield* reportEventToUT(\"upload\", {\n            input: \"input\" in opts ? opts.input : null,\n            files: opts.files.map((f)=>({\n                    name: f.name,\n                    size: f.size,\n                    type: f.type\n                }))\n        }, PresignedURLResponseSchema);\n        return yield* effect_Effect__WEBPACK_IMPORTED_MODULE_1__.forEach(presigneds, (presigned)=>uploadFile(String(endpoint), {\n                ...opts,\n                reportEventToUT\n            }, presigned), {\n            concurrency: 6\n        });\n    });\nconst genUploader = (initOpts)=>{\n    return (endpoint, opts)=>uploadFilesInternal(endpoint, {\n            ...opts,\n            url: (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.resolveMaybeUrlArg)(initOpts?.url),\n            package: initOpts.package,\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n            input: opts.input\n        }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_1__.provideService(_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.FetchContext, {\n            fetch: globalThis.fetch.bind(globalThis),\n            baseHeaders: {\n                \"x-uploadthing-version\": version$1,\n                \"x-uploadthing-api-key\": undefined,\n                \"x-uploadthing-fe-package\": initOpts.package,\n                \"x-uploadthing-be-adapter\": undefined\n            }\n        }), effect_Effect__WEBPACK_IMPORTED_MODULE_1__.runPromise);\n};\nconst uploadFile = (slug, opts, presigned)=>effect_Effect__WEBPACK_IMPORTED_MODULE_1__.gen(function*() {\n        const file = opts.files.find((f)=>f.name === presigned.fileName);\n        if (!file) {\n            console.error(\"No file found for presigned URL\", presigned);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"NOT_FOUND\",\n                message: \"No file found for presigned URL\",\n                cause: `Expected file with name ${presigned.fileName} but got '${opts.files.join(\",\")}'`\n            });\n        }\n        opts.onUploadBegin?.({\n            file: file.name\n        });\n        if (\"urls\" in presigned) {\n            yield* uploadMultipartWithProgress(file, presigned, opts);\n        } else {\n            yield* uploadPresignedPostWithProgress(file, presigned, opts);\n        }\n        const PollingResponse = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Union(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n            status: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Literal(\"done\"),\n            callbackData: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Any\n        }), _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n            status: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Literal(\"still waiting\")\n        }));\n        let serverData = null;\n        if (!opts.skipPolling) {\n            serverData = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)(presigned.pollingUrl, PollingResponse, {\n                headers: {\n                    authorization: presigned.pollingJwt\n                }\n            }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_1__.andThen((res)=>res.status === \"done\" ? effect_Effect__WEBPACK_IMPORTED_MODULE_1__.succeed(res.callbackData) : effect_Effect__WEBPACK_IMPORTED_MODULE_1__.fail(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError())), effect_Effect__WEBPACK_IMPORTED_MODULE_1__.retry({\n                while: (res)=>res instanceof _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError,\n                schedule: _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.exponentialBackoff\n            }));\n        }\n        return {\n            name: file.name,\n            size: file.size,\n            key: presigned.key,\n            // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n            serverData: serverData,\n            url: \"https://utfs.io/f/\" + presigned.key,\n            customId: presigned.customId,\n            type: file.type\n        };\n    });\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvdXBsb2FkdGhpbmcvY2xpZW50L2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFBMkM7QUFDSDtBQUM2STtBQUNuRTtBQUM1RTtBQUNMO0FBRWpDLElBQUllLFlBQVk7QUFFaEIsTUFBTUMsOEJBQThCLENBQUNDLE1BQU1DLFdBQVdDLE9BQU9sQiw4Q0FBVSxDQUFDO1FBQ2hFLElBQUlvQixnQkFBZ0I7UUFDcEIsTUFBTUMsUUFBUSxPQUFPckIsa0RBQWMsQ0FBQ2lCLFVBQVVNLElBQUksRUFBRSxDQUFDQyxLQUFLQztZQUN0RCxNQUFNQyxTQUFTVCxVQUFVVSxTQUFTLEdBQUdGO1lBQ3JDLE1BQU1HLE1BQU1DLEtBQUtDLEdBQUcsQ0FBQ0osU0FBU1QsVUFBVVUsU0FBUyxFQUFFWCxLQUFLZSxJQUFJO1lBQzVELE1BQU1DLFFBQVFoQixLQUFLaUIsS0FBSyxDQUFDUCxRQUFRRTtZQUNqQyxPQUFPTSxXQUFXO2dCQUNkVjtnQkFDQVEsT0FBT0E7Z0JBQ1A3QixvQkFBb0JjLFVBQVVkLGtCQUFrQjtnQkFDaERnQyxVQUFVbkIsS0FBS29CLElBQUk7Z0JBQ25CQyxVQUFVckIsS0FBS3NCLElBQUk7Z0JBQ25CQyxZQUFZLENBQUNDO29CQUNUcEIsaUJBQWlCb0I7b0JBQ2pCLE1BQU1DLFVBQVVyQixnQkFBZ0JKLEtBQUtlLElBQUksR0FBRztvQkFDNUNiLEtBQUt3QixnQkFBZ0IsR0FBRzt3QkFDcEIxQixNQUFNQSxLQUFLc0IsSUFBSTt3QkFDZkssVUFBVUY7b0JBQ2Q7Z0JBQ0o7WUFDSixHQUFHRyxJQUFJLENBQUM1QyxrREFBYyxDQUFDLENBQUM4QyxNQUFPO29CQUN2QkE7b0JBQ0FDLFlBQVl0QixRQUFRO2dCQUN4QixLQUFLekIsZ0RBQVksQ0FBQztnQkFDbEJpRCxPQUFPLENBQUNDLFFBQVFBLGlCQUFpQmpELDJEQUFVQTtnQkFDM0NrRCxPQUFPdEMsMkNBQU1BLEdBQUcsSUFBSTtnQkFDcEJ1QyxVQUFV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UUFBUXpFLDBEQUFTLENBQUM7UUFDdEI7UUFDQSxJQUFJNkwsYUFBYTtRQUNqQixJQUFJLENBQUMxSyxLQUFLMkssV0FBVyxFQUFFO1lBQ25CRCxhQUFhLE9BQU92TCxpRUFBWUEsQ0FBQ1ksVUFBVXFGLFVBQVUsRUFBRWtGLGlCQUFpQjtnQkFDcEVoQyxTQUFTO29CQUNMc0MsZUFBZTdLLFVBQVVvRixVQUFVO2dCQUN2QztZQUNKLEdBQUd6RCxJQUFJLENBQUM1QyxrREFBYyxDQUFDLENBQUMrTCxNQUFNQSxJQUFJdkgsTUFBTSxLQUFLLFNBQVN4RSxrREFBYyxDQUFDK0wsSUFBSUwsWUFBWSxJQUFJMUwsK0NBQVcsQ0FBQyxJQUFJQywyREFBVUEsTUFBTUQsZ0RBQVksQ0FBQztnQkFDbElpRCxPQUFPLENBQUM4SSxNQUFNQSxlQUFlOUwsMkRBQVVBO2dCQUN2Q21ELFVBQVVsRCxtRUFBa0JBO1lBQ2hDO1FBQ0o7UUFDQSxPQUFPO1lBQ0hvQyxNQUFNdEIsS0FBS3NCLElBQUk7WUFDZlAsTUFBTWYsS0FBS2UsSUFBSTtZQUNmMEIsS0FBS3hDLFVBQVV3QyxHQUFHO1lBQ2xCLG1FQUFtRTtZQUNuRW1JLFlBQVlBO1lBQ1pwSyxLQUFLLHVCQUF1QlAsVUFBVXdDLEdBQUc7WUFDekN3QyxVQUFVaEYsVUFBVWdGLFFBQVE7WUFDNUI3RCxNQUFNcEIsS0FBS29CLElBQUk7UUFDbkI7SUFDSjtBQUU0QiIsInNvdXJjZXMiOlsid2VicGFjazovL2V2ZW50bHkvLi9ub2RlX21vZHVsZXMvdXBsb2FkdGhpbmcvY2xpZW50L2luZGV4LmpzPzZmNDMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUyBmcm9tICdAZWZmZWN0L3NjaGVtYS9TY2hlbWEnO1xuaW1wb3J0ICogYXMgRWZmZWN0IGZyb20gJ2VmZmVjdC9FZmZlY3QnO1xuaW1wb3J0IHsgUmV0cnlFcnJvciwgZXhwb25lbnRpYWxCYWNrb2ZmLCBjb250ZW50RGlzcG9zaXRpb24sIENvbnRlbnREaXNwb3NpdGlvblNjaGVtYSwgZmV0Y2hFZmZKc29uLCBVcGxvYWRUaGluZ0Vycm9yLCByZXNvbHZlTWF5YmVVcmxBcmcsIEZldGNoQ29udGV4dCB9IGZyb20gJ0B1cGxvYWR0aGluZy9zaGFyZWQnO1xuZXhwb3J0IHsgZ2VuZXJhdGVDbGllbnREcm9wem9uZUFjY2VwdCwgZ2VuZXJhdGVNaW1lVHlwZXMsIGdlbmVyYXRlUGVybWl0dGVkRmlsZVR5cGVzIH0gZnJvbSAnQHVwbG9hZHRoaW5nL3NoYXJlZCc7XG5pbXBvcnQgKiBhcyBDYXVzZSBmcm9tICdlZmZlY3QvQ2F1c2UnO1xuaW1wb3J0IHsgaXNUZXN0IH0gZnJvbSAnc3RkLWVudic7XG5cbnZhciB2ZXJzaW9uJDEgPSBcIjYuMTAuMVwiO1xuXG5jb25zdCB1cGxvYWRNdWx0aXBhcnRXaXRoUHJvZ3Jlc3MgPSAoZmlsZSwgcHJlc2lnbmVkLCBvcHRzKT0+RWZmZWN0LmdlbihmdW5jdGlvbiooKSB7XG4gICAgICAgIGxldCB1cGxvYWRlZEJ5dGVzID0gMDtcbiAgICAgICAgY29uc3QgZXRhZ3MgPSB5aWVsZCogRWZmZWN0LmZvckVhY2gocHJlc2lnbmVkLnVybHMsICh1cmwsIGluZGV4KT0+e1xuICAgICAgICAgICAgY29uc3Qgb2Zmc2V0ID0gcHJlc2lnbmVkLmNodW5rU2l6ZSAqIGluZGV4O1xuICAgICAgICAgICAgY29uc3QgZW5kID0gTWF0aC5taW4ob2Zmc2V0ICsgcHJlc2lnbmVkLmNodW5rU2l6ZSwgZmlsZS5zaXplKTtcbiAgICAgICAgICAgIGNvbnN0IGNodW5rID0gZmlsZS5zbGljZShvZmZzZXQsIGVuZCk7XG4gICAgICAgICAgICByZXR1cm4gdXBsb2FkUGFydCh7XG4gICAgICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgICAgIGNodW5rOiBjaHVuayxcbiAgICAgICAgICAgICAgICBjb250ZW50RGlzcG9zaXRpb246IHByZXNpZ25lZC5jb250ZW50RGlzcG9zaXRpb24sXG4gICAgICAgICAgICAgICAgZmlsZVR5cGU6IGZpbGUudHlwZSxcbiAgICAgICAgICAgICAgICBmaWxlTmFtZTogZmlsZS5uYW1lLFxuICAgICAgICAgICAgICAgIG9uUHJvZ3Jlc3M6IChkZWx0YSk9PntcbiAgICAgICAgICAgICAgICAgICAgdXBsb2FkZWRCeXRlcyArPSBkZWx0YTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGVyY2VudCA9IHVwbG9hZGVkQnl0ZXMgLyBmaWxlLnNpemUgKiAxMDA7XG4gICAgICAgICAgICAgICAgICAgIG9wdHMub25VcGxvYWRQcm9ncmVzcz8uKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb2dyZXNzOiBwZXJjZW50XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLnBpcGUoRWZmZWN0LmFuZFRoZW4oKHRhZyk9Pih7XG4gICAgICAgICAgICAgICAgICAgIHRhZyxcbiAgICAgICAgICAgICAgICAgICAgcGFydE51bWJlcjogaW5kZXggKyAxXG4gICAgICAgICAgICAgICAgfSkpLCBFZmZlY3QucmV0cnkoe1xuICAgICAgICAgICAgICAgIHdoaWxlOiAoZXJyb3IpPT5lcnJvciBpbnN0YW5jZW9mIFJldHJ5RXJyb3IsXG4gICAgICAgICAgICAgICAgdGltZXM6IGlzVGVzdCA/IDMgOiAxMCxcbiAgICAgICAgICAgICAgICBzY2hlZHVsZTogZXhwb25lbnRpYWxCYWNrb2ZmXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH0sIHtcbiAgICAgICAgICAgIGNvbmN1cnJlbmN5OiBcImluaGVyaXRcIlxuICAgICAgICB9KS5waXBlKEVmZmVjdC50YXBFcnJvckNhdXNlKChlcnJvcik9Pm9wdHMucmVwb3J0RXZlbnRUb1VUKFwiZmFpbHVyZVwiLCB7XG4gICAgICAgICAgICAgICAgZmlsZUtleTogcHJlc2lnbmVkLmtleSxcbiAgICAgICAgICAgICAgICB1cGxvYWRJZDogcHJlc2lnbmVkLnVwbG9hZElkLFxuICAgICAgICAgICAgICAgIGZpbGVOYW1lOiBmaWxlLm5hbWUsXG4gICAgICAgICAgICAgICAgc3RvcmFnZVByb3ZpZGVyRXJyb3I6IENhdXNlLnByZXR0eShlcnJvcikudG9TdHJpbmcoKVxuICAgICAgICAgICAgfSwgUy5OdWxsKSkpO1xuICAgICAgICAvLyBUZWxsIHRoZSBzZXJ2ZXIgdGhhdCB0aGUgdXBsb2FkIGlzIGNvbXBsZXRlXG4gICAgICAgIHlpZWxkKiBvcHRzLnJlcG9ydEV2ZW50VG9VVChcIm11bHRpcGFydC1jb21wbGV0ZVwiLCB7XG4gICAgICAgICAgICB1cGxvYWRJZDogcHJlc2lnbmVkLnVwbG9hZElkLFxuICAgICAgICAgICAgZmlsZUtleTogcHJlc2lnbmVkLmtleSxcbiAgICAgICAgICAgIGV0YWdzXG4gICAgICAgIH0sIFMuTnVsbCk7XG4gICAgfSk7XG5jb25zdCB1cGxvYWRQYXJ0ID0gKG9wdHMpPT5FZmZlY3QuYXN5bmMoKHJlc3VtZSk9PntcbiAgICAgICAgY29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG4gICAgICAgIHhoci5vcGVuKFwiUFVUXCIsIG9wdHMudXJsLCB0cnVlKTtcbiAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoXCJDb250ZW50LVR5cGVcIiwgb3B0cy5maWxlVHlwZSk7XG4gICAgICAgIHhoci5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1EaXNwb3NpdGlvblwiLCBjb250ZW50RGlzcG9zaXRpb24ob3B0cy5jb250ZW50RGlzcG9zaXRpb24sIG9wdHMuZmlsZU5hbWUpKTtcbiAgICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpPT57XG4gICAgICAgICAgICBjb25zdCBldGFnID0geGhyLmdldFJlc3BvbnNlSGVhZGVyKFwiRXRhZ1wiKTtcbiAgICAgICAgICAgIGlmICh4aHIuc3RhdHVzID49IDIwMCAmJiB4aHIuc3RhdHVzIDw9IDI5OSAmJiBldGFnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VtZShFZmZlY3Quc3VjY2VlZChldGFnKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzdW1lKEVmZmVjdC5mYWlsKG5ldyBSZXRyeUVycm9yKCkpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHhoci5hZGRFdmVudExpc3RlbmVyKFwiZXJyb3JcIiwgKCk9PnJlc3VtZShFZmZlY3QuZmFpbChuZXcgUmV0cnlFcnJvcigpKSkpO1xuICAgICAgICBsZXQgbGFzdFByb2dyZXNzID0gMDtcbiAgICAgICAgeGhyLnVwbG9hZC5hZGRFdmVudExpc3RlbmVyKFwicHJvZ3Jlc3NcIiwgKGUpPT57XG4gICAgICAgICAgICBjb25zdCBkZWx0YSA9IGUubG9hZGVkIC0gbGFzdFByb2dyZXNzO1xuICAgICAgICAgICAgbGFzdFByb2dyZXNzICs9IGRlbHRhO1xuICAgICAgICAgICAgb3B0cy5vblByb2dyZXNzKGRlbHRhKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHhoci5zZW5kKG9wdHMuY2h1bmspO1xuICAgIH0pO1xuXG5jb25zdCB1cGxvYWRQcmVzaWduZWRQb3N0V2l0aFByb2dyZXNzID0gKGZpbGUsIHByZXNpZ25lZCwgb3B0cyk9PkVmZmVjdC5hc3luYygocmVzdW1lKT0+e1xuICAgICAgICBjb25zdCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgeGhyLm9wZW4oXCJQT1NUXCIsIHByZXNpZ25lZC51cmwpO1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihcIkFjY2VwdFwiLCBcImFwcGxpY2F0aW9uL3htbFwiKTtcbiAgICAgICAgeGhyLnVwbG9hZC5hZGRFdmVudExpc3RlbmVyKFwicHJvZ3Jlc3NcIiwgKHsgbG9hZGVkLCB0b3RhbCB9KT0+e1xuICAgICAgICAgICAgb3B0cy5vblVwbG9hZFByb2dyZXNzPy4oe1xuICAgICAgICAgICAgICAgIGZpbGU6IGZpbGUubmFtZSxcbiAgICAgICAgICAgICAgICBwcm9ncmVzczogbG9hZGVkIC8gdG90YWwgKiAxMDBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIsICgpPT5yZXN1bWUoeGhyLnN0YXR1cyA+PSAyMDAgJiYgeGhyLnN0YXR1cyA8IDMwMCA/IEVmZmVjdC5zdWNjZWVkKG51bGwpIDogb3B0cy5yZXBvcnRFdmVudFRvVVQoXCJmYWlsdXJlXCIsIHtcbiAgICAgICAgICAgICAgICBmaWxlS2V5OiBwcmVzaWduZWQua2V5LFxuICAgICAgICAgICAgICAgIHVwbG9hZElkOiBudWxsLFxuICAgICAgICAgICAgICAgIGZpbGVOYW1lOiBmaWxlLm5hbWUsXG4gICAgICAgICAgICAgICAgc3RvcmFnZVByb3ZpZGVyRXJyb3I6IHhoci5yZXNwb25zZVRleHRcbiAgICAgICAgICAgIH0sIFMuTnVsbCkpKTtcbiAgICAgICAgeGhyLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLCAoKT0+cmVzdW1lKG9wdHMucmVwb3J0RXZlbnRUb1VUKFwiZmFpbHVyZVwiLCB7XG4gICAgICAgICAgICAgICAgZmlsZUtleTogcHJlc2lnbmVkLmtleSxcbiAgICAgICAgICAgICAgICB1cGxvYWRJZDogbnVsbCxcbiAgICAgICAgICAgICAgICBmaWxlTmFtZTogZmlsZS5uYW1lXG4gICAgICAgICAgICB9LCBTLk51bGwpKSk7XG4gICAgICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XG4gICAgICAgIE9iamVjdC5lbnRyaWVzKHByZXNpZ25lZC5maWVsZHMpLmZvckVhY2goKFtrLCB2XSk9PmZvcm1EYXRhLmFwcGVuZChrLCB2KSk7XG4gICAgICAgIGZvcm1EYXRhLmFwcGVuZChcImZpbGVcIiwgZmlsZSk7IC8vIEZpbGUgZGF0YSAqKk1VU1QgR08gTEFTVCoqXG4gICAgICAgIHhoci5zZW5kKGZvcm1EYXRhKTtcbiAgICB9KTtcblxuLyoqXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogPT09PT09PT09PT09PT09PT09PT09PT09IEZpbGUgVHlwZSBIaWVyYXJjaHkgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqLyBjb25zdCBGaWxlVXBsb2FkRGF0YVNjaGVtYSA9IFMuU3RydWN0KHtcbiAgICBuYW1lOiBTLlN0cmluZyxcbiAgICBzaXplOiBTLk51bWJlcixcbiAgICB0eXBlOiBTLlN0cmluZ1xufSk7XG5jb25zdCBGaWxlVXBsb2FkRGF0YVdpdGhDdXN0b21JZFNjaGVtYSA9IFMuZXh0ZW5kKEZpbGVVcGxvYWREYXRhU2NoZW1hLCBTLlN0cnVjdCh7XG4gICAgY3VzdG9tSWQ6IFMuTnVsbE9yKFMuU3RyaW5nKVxufSkpO1xuUy5leHRlbmQoRmlsZVVwbG9hZERhdGFXaXRoQ3VzdG9tSWRTY2hlbWEsIFMuU3RydWN0KHtcbiAgICBrZXk6IFMuU3RyaW5nLFxuICAgIHVybDogUy5TdHJpbmdcbn0pKTtcbi8qKlxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqID09PT09PT09PT09PT09PT09PT09PT09PSBTZXJ2ZXIgUmVzcG9uc2UgU2NoZW1hcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICovIGNvbnN0IFByZXNpZ25lZEJhc2VTY2hlbWEgPSBTLlN0cnVjdCh7XG4gICAga2V5OiBTLlN0cmluZyxcbiAgICBmaWxlTmFtZTogUy5TdHJpbmcsXG4gICAgZmlsZVR5cGU6IFMuU3RyaW5nLFxuICAgIGZpbGVVcmw6IFMuU3RyaW5nLFxuICAgIHBvbGxpbmdKd3Q6IFMuU3RyaW5nLFxuICAgIHBvbGxpbmdVcmw6IFMuU3RyaW5nLFxuICAgIGNvbnRlbnREaXNwb3NpdGlvbjogQ29udGVudERpc3Bvc2l0aW9uU2NoZW1hLFxuICAgIGN1c3RvbUlkOiBTLk51bGxPcihTLlN0cmluZylcbn0pO1xuY29uc3QgTVBVUmVzcG9uc2VTY2hlbWEgPSBTLmV4dGVuZChQcmVzaWduZWRCYXNlU2NoZW1hLCBTLlN0cnVjdCh7XG4gICAgdXJsczogUy5BcnJheShTLlN0cmluZyksXG4gICAgdXBsb2FkSWQ6IFMuU3RyaW5nLFxuICAgIGNodW5rU2l6ZTogUy5OdW1iZXIsXG4gICAgY2h1bmtDb3VudDogUy5OdW1iZXJcbn0pKTtcbmNvbnN0IFBTUFJlc3BvbnNlU2NoZW1hID0gUy5leHRlbmQoUHJlc2lnbmVkQmFzZVNjaGVtYSwgUy5TdHJ1Y3Qoe1xuICAgIHVybDogUy5TdHJpbmcsXG4gICAgZmllbGRzOiBTLlJlY29yZChTLlN0cmluZywgUy5TdHJpbmcpXG59KSk7XG5jb25zdCBQcmVzaWduZWRVUkxSZXNwb25zZVNjaGVtYSA9IFMuQXJyYXkoUy5VbmlvbihQU1BSZXNwb25zZVNjaGVtYSwgTVBVUmVzcG9uc2VTY2hlbWEpKTtcblMuU3RydWN0KHtcbiAgICBzdGF0dXM6IFMuU3RyaW5nLFxuICAgIGZpbGVEYXRhOiBTLm9wdGlvbmFsKFMuU3RydWN0KHtcbiAgICAgICAgZmlsZUtleTogUy5OdWxsT3IoUy5TdHJpbmcpLFxuICAgICAgICBmaWxlTmFtZTogUy5TdHJpbmcsXG4gICAgICAgIGZpbGVTaXplOiBTLk51bWJlcixcbiAgICAgICAgZmlsZVR5cGU6IFMuU3RyaW5nLFxuICAgICAgICBtZXRhZGF0YTogUy5OdWxsT3IoUy5TdHJpbmcpLFxuICAgICAgICBjdXN0b21JZDogUy5OdWxsT3IoUy5TdHJpbmcpLFxuICAgICAgICBjYWxsYmFja1VybDogUy5vcHRpb25hbChTLlN0cmluZyksXG4gICAgICAgIGNhbGxiYWNrU2x1ZzogUy5vcHRpb25hbChTLlN0cmluZylcbiAgICB9KSlcbn0pO1xuUy5TdHJ1Y3Qoe1xuICAgIHN1Y2Nlc3M6IFMuQm9vbGVhbixcbiAgICBtZXNzYWdlOiBTLm9wdGlvbmFsKFMuU3RyaW5nKVxufSk7XG5TLlN0cnVjdCh7XG4gICAgc3RhdHVzOiBTLlN0cmluZ1xufSk7XG4vKipcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT0gQ2xpZW50IEFjdGlvbiBQYXlsb2FkcyA9PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICovIFMuU3RydWN0KHtcbiAgICBmaWxlczogUy5BcnJheShGaWxlVXBsb2FkRGF0YVNjaGVtYSksXG4gICAgaW5wdXQ6IFMuVW5rbm93blxufSk7XG5TLlN0cnVjdCh7XG4gICAgZmlsZUtleTogUy5TdHJpbmcsXG4gICAgdXBsb2FkSWQ6IFMuTnVsbE9yKFMuU3RyaW5nKSxcbiAgICBzdG9yYWdlUHJvdmlkZXJFcnJvcjogUy5vcHRpb25hbChTLlN0cmluZyksXG4gICAgZmlsZU5hbWU6IFMuU3RyaW5nXG59KTtcblMuU3RydWN0KHtcbiAgICBmaWxlS2V5OiBTLlN0cmluZyxcbiAgICB1cGxvYWRJZDogUy5TdHJpbmcsXG4gICAgZXRhZ3M6IFMuQXJyYXkoUy5TdHJ1Y3Qoe1xuICAgICAgICB0YWc6IFMuU3RyaW5nLFxuICAgICAgICBwYXJ0TnVtYmVyOiBTLk51bWJlclxuICAgIH0pKVxufSk7XG5cbmNvbnN0IG1heWJlUGFyc2VSZXNwb25zZVhNTCA9IChtYXliZVhtbCk9PntcbiAgICBjb25zdCBjb2RlTWF0Y2ggPSBtYXliZVhtbC5tYXRjaCgvPENvZGU+KC4qPyk8XFwvQ29kZT4vcyk7XG4gICAgY29uc3QgbWVzc2FnZU1hdGNoID0gbWF5YmVYbWwubWF0Y2goLzxNZXNzYWdlPiguKj8pPFxcL01lc3NhZ2U+L3MpO1xuICAgIGNvbnN0IGNvZGUgPSBjb2RlTWF0Y2g/LlsxXTtcbiAgICBjb25zdCBtZXNzYWdlID0gbWVzc2FnZU1hdGNoPy5bMV07XG4gICAgaWYgKCFjb2RlIHx8ICFtZXNzYWdlKSByZXR1cm4gbnVsbDtcbiAgICByZXR1cm4ge1xuICAgICAgICBjb2RlOiBzM0NvZGVUb1VwbG9hZFRoaW5nQ29kZVtjb2RlXSA/PyBERUZBVUxUX0VSUk9SX0NPREUsXG4gICAgICAgIG1lc3NhZ2VcbiAgICB9O1xufTtcbi8qKlxuICogTWFwIFMzIGVycm9yIGNvZGVzIHRvIFVwbG9hZFRoaW5nIGVycm9yIGNvZGVzXG4gKlxuICogVGhpcyBpcyBhIHN1YnNldCBvZiB0aGUgUzMgZXJyb3IgY29kZXMsIGJhc2VkIG9uIHdoYXQgc2VlbWVkIG1vc3QgbGlrZWx5IHRvXG4gKiBvY2N1ciBpbiB1cGxvYWR0aGluZy4gRm9yIGEgZnVsbCBsaXN0IG9mIFMzIGVycm9yIGNvZGVzLCBzZWU6XG4gKiBodHRwczovL2RvY3MuYXdzLmFtYXpvbi5jb20vQW1hem9uUzMvbGF0ZXN0L0FQSS9FcnJvclJlc3BvbnNlcy5odG1sXG4gKi8gY29uc3QgREVGQVVMVF9FUlJPUl9DT0RFID0gXCJVUExPQURfRkFJTEVEXCI7XG5jb25zdCBzM0NvZGVUb1VwbG9hZFRoaW5nQ29kZSA9IHtcbiAgICBBY2Nlc3NEZW5pZWQ6IFwiRk9SQklEREVOXCIsXG4gICAgRW50aXR5VG9vU21hbGw6IFwiVE9PX1NNQUxMXCIsXG4gICAgRW50aXR5VG9vTGFyZ2U6IFwiVE9PX0xBUkdFXCIsXG4gICAgRXhwaXJlZFRva2VuOiBcIkZPUkJJRERFTlwiLFxuICAgIEluY29ycmVjdE51bWJlck9mRmlsZXNJblBvc3RSZXF1ZXN0OiBcIlRPT19NQU5ZX0ZJTEVTXCIsXG4gICAgSW50ZXJuYWxFcnJvcjogXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIixcbiAgICBLZXlUb29Mb25nRXJyb3I6IFwiS0VZX1RPT19MT05HXCIsXG4gICAgTWF4TWVzc2FnZUxlbmd0aEV4Y2VlZGVkOiBcIlRPT19MQVJHRVwiXG59O1xuXG5jb25zdCBjcmVhdGVBUElSZXF1ZXN0VXJsID0gKGNvbmZpZyk9PntcbiAgICBjb25zdCB1cmwgPSBuZXcgVVJMKGNvbmZpZy51cmwpO1xuICAgIGNvbnN0IHF1ZXJ5UGFyYW1zID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh1cmwuc2VhcmNoKTtcbiAgICBxdWVyeVBhcmFtcy5zZXQoXCJhY3Rpb25UeXBlXCIsIGNvbmZpZy5hY3Rpb25UeXBlKTtcbiAgICBxdWVyeVBhcmFtcy5zZXQoXCJzbHVnXCIsIGNvbmZpZy5zbHVnKTtcbiAgICB1cmwuc2VhcmNoID0gcXVlcnlQYXJhbXMudG9TdHJpbmcoKTtcbiAgICByZXR1cm4gdXJsO1xufTtcbi8qKlxuICogQ3JlYXRlcyBhIFwiY2xpZW50XCIgZm9yIHJlcG9ydGluZyBldmVudHMgdG8gdGhlIFVwbG9hZFRoaW5nIHNlcnZlciB2aWEgdGhlIHVzZXIncyBBUEkgZW5kcG9pbnQuXG4gKiBFdmVudHMgYXJlIGhhbmRsZWQgaW4gXCIuL2hhbmRsZXIudHMgc3RhcnRpbmcgYXQgTDExMlwiXG4gKi8gY29uc3QgY3JlYXRlVVRSZXBvcnRlciA9IChjZmcpPT4odHlwZSwgcGF5bG9hZCwgcmVzcG9uc2VTY2hlbWEpPT5FZmZlY3QuZ2VuKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGNyZWF0ZUFQSVJlcXVlc3RVcmwoe1xuICAgICAgICAgICAgICAgIHVybDogY2ZnLnVybCxcbiAgICAgICAgICAgICAgICBzbHVnOiBjZmcuZW5kcG9pbnQsXG4gICAgICAgICAgICAgICAgYWN0aW9uVHlwZTogdHlwZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBsZXQgaGVhZGVycyA9IHR5cGVvZiBjZmcuaGVhZGVycyA9PT0gXCJmdW5jdGlvblwiID8gY2ZnLmhlYWRlcnMoKSA6IGNmZy5oZWFkZXJzO1xuICAgICAgICAgICAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBQcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycyA9IHlpZWxkKiBFZmZlY3QucHJvbWlzZSgoKT0+aGVhZGVycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IHlpZWxkKiBmZXRjaEVmZkpzb24odXJsLCByZXNwb25zZVNjaGVtYSwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocGF5bG9hZCksXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgICAgICAgXCJ4LXVwbG9hZHRoaW5nLXBhY2thZ2VcIjogY2ZnLnBhY2thZ2UsXG4gICAgICAgICAgICAgICAgICAgIFwieC11cGxvYWR0aGluZy12ZXJzaW9uXCI6IHZlcnNpb24kMSxcbiAgICAgICAgICAgICAgICAgICAgLi4uaGVhZGVyc1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pLnBpcGUoRWZmZWN0LmNhdGNoVGFnKFwiRmV0Y2hFcnJvclwiLCAoZSk9PkVmZmVjdC5mYWlsKG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgY29kZTogXCJJTlRFUk5BTF9DTElFTlRfRVJST1JcIixcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogYEZhaWxlZCB0byByZXBvcnQgZXZlbnQgXCIke3R5cGV9XCIgdG8gVXBsb2FkVGhpbmcgc2VydmVyYCxcbiAgICAgICAgICAgICAgICAgICAgY2F1c2U6IGVcbiAgICAgICAgICAgICAgICB9KSkpLCBFZmZlY3QuY2F0Y2hUYWcoXCJQYXJzZUVycm9yXCIsIChlKT0+RWZmZWN0LmZhaWwobmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBjb2RlOiBcIklOVEVSTkFMX0NMSUVOVF9FUlJPUlwiLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkZhaWxlZCB0byBwYXJzZSByZXNwb25zZSBmcm9tIFVwbG9hZFRoaW5nIHNlcnZlclwiLFxuICAgICAgICAgICAgICAgICAgICBjYXVzZTogZVxuICAgICAgICAgICAgICAgIH0pKSkpO1xuICAgICAgICAgICAgc3dpdGNoKHR5cGUpe1xuICAgICAgICAgICAgICAgIGNhc2UgXCJmYWlsdXJlXCI6XG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdoeSBpc24ndCB0aGlzIG5hcnJvd2VkIGF1dG9tYXRpY2FsbHk/XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBwID0gcGF5bG9hZDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhcnNlZCA9IG1heWJlUGFyc2VSZXNwb25zZVhNTChwLnN0b3JhZ2VQcm92aWRlckVycm9yID8/IFwiXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHBhcnNlZD8ubWVzc2FnZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB5aWVsZCogbmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiBwYXJzZWQuY29kZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogcGFyc2VkLm1lc3NhZ2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHlpZWxkKiBuZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IFwiVVBMT0FEX0ZBSUxFRFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBgRmFpbGVkIHRvIHVwbG9hZCBmaWxlICR7cC5maWxlTmFtZX0gdG8gUzNgLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXVzZTogcC5zdG9yYWdlUHJvdmlkZXJFcnJvclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgICAgIH0pO1xuXG5jb25zdCB2ZXJzaW9uID0gdmVyc2lvbiQxO1xuY29uc3QgdXBsb2FkRmlsZXNJbnRlcm5hbCA9IChlbmRwb2ludCwgb3B0cyk9PkVmZmVjdC5nZW4oZnVuY3Rpb24qKCkge1xuICAgICAgICBjb25zdCByZXBvcnRFdmVudFRvVVQgPSBjcmVhdGVVVFJlcG9ydGVyKHtcbiAgICAgICAgICAgIGVuZHBvaW50OiBTdHJpbmcoZW5kcG9pbnQpLFxuICAgICAgICAgICAgcGFja2FnZTogb3B0cy5wYWNrYWdlLFxuICAgICAgICAgICAgdXJsOiByZXNvbHZlTWF5YmVVcmxBcmcob3B0cy51cmwpLFxuICAgICAgICAgICAgaGVhZGVyczogb3B0cy5oZWFkZXJzXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBwcmVzaWduZWRzID0geWllbGQqIHJlcG9ydEV2ZW50VG9VVChcInVwbG9hZFwiLCB7XG4gICAgICAgICAgICBpbnB1dDogXCJpbnB1dFwiIGluIG9wdHMgPyBvcHRzLmlucHV0IDogbnVsbCxcbiAgICAgICAgICAgIGZpbGVzOiBvcHRzLmZpbGVzLm1hcCgoZik9Pih7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGYubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTogZi5zaXplLFxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBmLnR5cGVcbiAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgfSwgUHJlc2lnbmVkVVJMUmVzcG9uc2VTY2hlbWEpO1xuICAgICAgICByZXR1cm4geWllbGQqIEVmZmVjdC5mb3JFYWNoKHByZXNpZ25lZHMsIChwcmVzaWduZWQpPT51cGxvYWRGaWxlKFN0cmluZyhlbmRwb2ludCksIHtcbiAgICAgICAgICAgICAgICAuLi5vcHRzLFxuICAgICAgICAgICAgICAgIHJlcG9ydEV2ZW50VG9VVFxuICAgICAgICAgICAgfSwgcHJlc2lnbmVkKSwge1xuICAgICAgICAgICAgY29uY3VycmVuY3k6IDZcbiAgICAgICAgfSk7XG4gICAgfSk7XG5jb25zdCBnZW5VcGxvYWRlciA9IChpbml0T3B0cyk9PntcbiAgICByZXR1cm4gKGVuZHBvaW50LCBvcHRzKT0+dXBsb2FkRmlsZXNJbnRlcm5hbChlbmRwb2ludCwge1xuICAgICAgICAgICAgLi4ub3B0cyxcbiAgICAgICAgICAgIHVybDogcmVzb2x2ZU1heWJlVXJsQXJnKGluaXRPcHRzPy51cmwpLFxuICAgICAgICAgICAgcGFja2FnZTogaW5pdE9wdHMucGFja2FnZSxcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3NcbiAgICAgICAgICAgIGlucHV0OiBvcHRzLmlucHV0XG4gICAgICAgIH0pLnBpcGUoRWZmZWN0LnByb3ZpZGVTZXJ2aWNlKEZldGNoQ29udGV4dCwge1xuICAgICAgICAgICAgZmV0Y2g6IGdsb2JhbFRoaXMuZmV0Y2guYmluZChnbG9iYWxUaGlzKSxcbiAgICAgICAgICAgIGJhc2VIZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgXCJ4LXVwbG9hZHRoaW5nLXZlcnNpb25cIjogdmVyc2lvbiQxLFxuICAgICAgICAgICAgICAgIFwieC11cGxvYWR0aGluZy1hcGkta2V5XCI6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBcIngtdXBsb2FkdGhpbmctZmUtcGFja2FnZVwiOiBpbml0T3B0cy5wYWNrYWdlLFxuICAgICAgICAgICAgICAgIFwieC11cGxvYWR0aGluZy1iZS1hZGFwdGVyXCI6IHVuZGVmaW5lZFxuICAgICAgICAgICAgfVxuICAgICAgICB9KSwgRWZmZWN0LnJ1blByb21pc2UpO1xufTtcbmNvbnN0IHVwbG9hZEZpbGUgPSAoc2x1Zywgb3B0cywgcHJlc2lnbmVkKT0+RWZmZWN0LmdlbihmdW5jdGlvbiooKSB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSBvcHRzLmZpbGVzLmZpbmQoKGYpPT5mLm5hbWUgPT09IHByZXNpZ25lZC5maWxlTmFtZSk7XG4gICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihcIk5vIGZpbGUgZm91bmQgZm9yIHByZXNpZ25lZCBVUkxcIiwgcHJlc2lnbmVkKTtcbiAgICAgICAgICAgIHJldHVybiB5aWVsZCogbmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgIGNvZGU6IFwiTk9UX0ZPVU5EXCIsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJObyBmaWxlIGZvdW5kIGZvciBwcmVzaWduZWQgVVJMXCIsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGBFeHBlY3RlZCBmaWxlIHdpdGggbmFtZSAke3ByZXNpZ25lZC5maWxlTmFtZX0gYnV0IGdvdCAnJHtvcHRzLmZpbGVzLmpvaW4oXCIsXCIpfSdgXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBvcHRzLm9uVXBsb2FkQmVnaW4/Lih7XG4gICAgICAgICAgICBmaWxlOiBmaWxlLm5hbWVcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChcInVybHNcIiBpbiBwcmVzaWduZWQpIHtcbiAgICAgICAgICAgIHlpZWxkKiB1cGxvYWRNdWx0aXBhcnRXaXRoUHJvZ3Jlc3MoZmlsZSwgcHJlc2lnbmVkLCBvcHRzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHlpZWxkKiB1cGxvYWRQcmVzaWduZWRQb3N0V2l0aFByb2dyZXNzKGZpbGUsIHByZXNpZ25lZCwgb3B0cyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgUG9sbGluZ1Jlc3BvbnNlID0gUy5VbmlvbihTLlN0cnVjdCh7XG4gICAgICAgICAgICBzdGF0dXM6IFMuTGl0ZXJhbChcImRvbmVcIiksXG4gICAgICAgICAgICBjYWxsYmFja0RhdGE6IFMuQW55XG4gICAgICAgIH0pLCBTLlN0cnVjdCh7XG4gICAgICAgICAgICBzdGF0dXM6IFMuTGl0ZXJhbChcInN0aWxsIHdhaXRpbmdcIilcbiAgICAgICAgfSkpO1xuICAgICAgICBsZXQgc2VydmVyRGF0YSA9IG51bGw7XG4gICAgICAgIGlmICghb3B0cy5za2lwUG9sbGluZykge1xuICAgICAgICAgICAgc2VydmVyRGF0YSA9IHlpZWxkKiBmZXRjaEVmZkpzb24ocHJlc2lnbmVkLnBvbGxpbmdVcmwsIFBvbGxpbmdSZXNwb25zZSwge1xuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogcHJlc2lnbmVkLnBvbGxpbmdKd3RcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5waXBlKEVmZmVjdC5hbmRUaGVuKChyZXMpPT5yZXMuc3RhdHVzID09PSBcImRvbmVcIiA/IEVmZmVjdC5zdWNjZWVkKHJlcy5jYWxsYmFja0RhdGEpIDogRWZmZWN0LmZhaWwobmV3IFJldHJ5RXJyb3IoKSkpLCBFZmZlY3QucmV0cnkoe1xuICAgICAgICAgICAgICAgIHdoaWxlOiAocmVzKT0+cmVzIGluc3RhbmNlb2YgUmV0cnlFcnJvcixcbiAgICAgICAgICAgICAgICBzY2hlZHVsZTogZXhwb25lbnRpYWxCYWNrb2ZmXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IGZpbGUubmFtZSxcbiAgICAgICAgICAgIHNpemU6IGZpbGUuc2l6ZSxcbiAgICAgICAgICAgIGtleTogcHJlc2lnbmVkLmtleSxcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWFzc2lnbm1lbnRcbiAgICAgICAgICAgIHNlcnZlckRhdGE6IHNlcnZlckRhdGEsXG4gICAgICAgICAgICB1cmw6IFwiaHR0cHM6Ly91dGZzLmlvL2YvXCIgKyBwcmVzaWduZWQua2V5LFxuICAgICAgICAgICAgY3VzdG9tSWQ6IHByZXNpZ25lZC5jdXN0b21JZCxcbiAgICAgICAgICAgIHR5cGU6IGZpbGUudHlwZVxuICAgICAgICB9O1xuICAgIH0pO1xuXG5leHBvcnQgeyBnZW5VcGxvYWRlciwgdmVyc2lvbiB9O1xuIl0sIm5hbWVzIjpbIlMiLCJFZmZlY3QiLCJSZXRyeUVycm9yIiwiZXhwb25lbnRpYWxCYWNrb2ZmIiwiY29udGVudERpc3Bvc2l0aW9uIiwiQ29udGVudERpc3Bvc2l0aW9uU2NoZW1hIiwiZmV0Y2hFZmZKc29uIiwiVXBsb2FkVGhpbmdFcnJvciIsInJlc29sdmVNYXliZVVybEFyZyIsIkZldGNoQ29udGV4dCIsImdlbmVyYXRlQ2xpZW50RHJvcHpvbmVBY2NlcHQiLCJnZW5lcmF0ZU1pbWVUeXBlcyIsImdlbmVyYXRlUGVybWl0dGVkRmlsZVR5cGVzIiwiQ2F1c2UiLCJpc1Rlc3QiLCJ2ZXJzaW9uJDEiLCJ1cGxvYWRNdWx0aXBhcnRXaXRoUHJvZ3Jlc3MiLCJmaWxlIiwicHJlc2lnbmVkIiwib3B0cyIsImdlbiIsInVwbG9hZGVkQnl0ZXMiLCJldGFncyIsImZvckVhY2giLCJ1cmxzIiwidXJsIiwiaW5kZXgiLCJvZmZzZXQiLCJjaHVua1NpemUiLCJlbmQiLCJNYXRoIiwibWluIiwic2l6ZSIsImNodW5rIiwic2xpY2UiLCJ1cGxvYWRQYXJ0IiwiZmlsZVR5cGUiLCJ0eXBlIiwiZmlsZU5hbWUiLCJuYW1lIiwib25Qcm9ncmVzcyIsImRlbHRhIiwicGVyY2VudCIsIm9uVXBsb2FkUHJvZ3Jlc3MiLCJwcm9ncmVzcyIsInBpcGUiLCJhbmRUaGVuIiwidGFnIiwicGFydE51bWJlciIsInJldHJ5Iiwid2hpbGUiLCJlcnJvciIsInRpbWVzIiwic2NoZWR1bGUiLCJjb25jdXJyZW5jeSIsInRhcEVycm9yQ2F1c2UiLCJyZXBvcnRFdmVudFRvVVQiLCJmaWxlS2V5Iiwia2V5IiwidXBsb2FkSWQiLCJzdG9yYWdlUHJvdmlkZXJFcnJvciIsInByZXR0eSIsInRvU3RyaW5nIiwiTnVsbCIsImFzeW5jIiwicmVzdW1lIiwieGhyIiwiWE1MSHR0cFJlcXVlc3QiLCJvcGVuIiwic2V0UmVxdWVzdEhlYWRlciIsImFkZEV2ZW50TGlzdGVuZXIiLCJldGFnIiwiZ2V0UmVzcG9uc2VIZWFkZXIiLCJzdGF0dXMiLCJzdWNjZWVkIiwiZmFpbCIsImxhc3RQcm9ncmVzcyIsInVwbG9hZCIsImUiLCJsb2FkZWQiLCJzZW5kIiwidXBsb2FkUHJlc2lnbmVkUG9zdFdpdGhQcm9ncmVzcyIsInRvdGFsIiwicmVzcG9uc2VUZXh0IiwiZm9ybURhdGEiLCJGb3JtRGF0YSIsIk9iamVjdCIsImVudHJpZXMiLCJmaWVsZHMiLCJrIiwidiIsImFwcGVuZCIsIkZpbGVVcGxvYWREYXRhU2NoZW1hIiwiU3RydWN0IiwiU3RyaW5nIiwiTnVtYmVyIiwiRmlsZVVwbG9hZERhdGFXaXRoQ3VzdG9tSWRTY2hlbWEiLCJleHRlbmQiLCJjdXN0b21JZCIsIk51bGxPciIsIlByZXNpZ25lZEJhc2VTY2hlbWEiLCJmaWxlVXJsIiwicG9sbGluZ0p3dCIsInBvbGxpbmdVcmwiLCJNUFVSZXNwb25zZVNjaGVtYSIsIkFycmF5IiwiY2h1bmtDb3VudCIsIlBTUFJlc3BvbnNlU2NoZW1hIiwiUmVjb3JkIiwiUHJlc2lnbmVkVVJMUmVzcG9uc2VTY2hlbWEiLCJVbmlvbiIsImZpbGVEYXRhIiwib3B0aW9uYWwiLCJmaWxlU2l6ZSIsIm1ldGFkYXRhIiwiY2FsbGJhY2tVcmwiLCJjYWxsYmFja1NsdWciLCJzdWNjZXNzIiwiQm9vbGVhbiIsIm1lc3NhZ2UiLCJmaWxlcyIsImlucHV0IiwiVW5rbm93biIsIm1heWJlUGFyc2VSZXNwb25zZVhNTCIsIm1heWJlWG1sIiwiY29kZU1hdGNoIiwibWF0Y2giLCJtZXNzYWdlTWF0Y2giLCJjb2RlIiwiczNDb2RlVG9VcGxvYWRUaGluZ0NvZGUiLCJERUZBVUxUX0VSUk9SX0NPREUiLCJBY2Nlc3NEZW5pZWQiLCJFbnRpdHlUb29TbWFsbCIsIkVudGl0eVRvb0xhcmdlIiwiRXhwaXJlZFRva2VuIiwiSW5jb3JyZWN0TnVtYmVyT2ZGaWxlc0luUG9zdFJlcXVlc3QiLCJJbnRlcm5hbEVycm9yIiwiS2V5VG9vTG9uZ0Vycm9yIiwiTWF4TWVzc2FnZUxlbmd0aEV4Y2VlZGVkIiwiY3JlYXRlQVBJUmVxdWVzdFVybCIsImNvbmZpZyIsIlVSTCIsInF1ZXJ5UGFyYW1zIiwiVVJMU2VhcmNoUGFyYW1zIiwic2VhcmNoIiwic2V0IiwiYWN0aW9uVHlwZSIsInNsdWciLCJjcmVhdGVVVFJlcG9ydGVyIiwiY2ZnIiwicGF5bG9hZCIsInJlc3BvbnNlU2NoZW1hIiwiZW5kcG9pbnQiLCJoZWFkZXJzIiwiUHJvbWlzZSIsInByb21pc2UiLCJyZXNwb25zZSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwicGFja2FnZSIsImNhdGNoVGFnIiwiY2F1c2UiLCJwIiwicGFyc2VkIiwidmVyc2lvbiIsInVwbG9hZEZpbGVzSW50ZXJuYWwiLCJwcmVzaWduZWRzIiwibWFwIiwiZiIsInVwbG9hZEZpbGUiLCJnZW5VcGxvYWRlciIsImluaXRPcHRzIiwicHJvdmlkZVNlcnZpY2UiLCJmZXRjaCIsImdsb2JhbFRoaXMiLCJiaW5kIiwiYmFzZUhlYWRlcnMiLCJ1bmRlZmluZWQiLCJydW5Qcm9taXNlIiwiZmluZCIsImNvbnNvbGUiLCJqb2luIiwib25VcGxvYWRCZWdpbiIsIlBvbGxpbmdSZXNwb25zZSIsIkxpdGVyYWwiLCJjYWxsYmFja0RhdGEiLCJBbnkiLCJzZXJ2ZXJEYXRhIiwic2tpcFBvbGxpbmciLCJhdXRob3JpemF0aW9uIiwicmVzIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/uploadthing/client/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/uploadthing/internal/types.js":
/*!****************************************************!*\
  !*** ./node_modules/uploadthing/internal/types.js ***!
  \****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UTFiles: () => (/* binding */ UTFiles),\n/* harmony export */   VALID_ACTION_TYPES: () => (/* binding */ VALID_ACTION_TYPES),\n/* harmony export */   VALID_UT_HOOKS: () => (/* binding */ VALID_UT_HOOKS),\n/* harmony export */   isActionType: () => (/* binding */ isActionType),\n/* harmony export */   isUploadThingHook: () => (/* binding */ isUploadThingHook)\n/* harmony export */ });\n/**\n * Marker used to append a `customId` to the incoming file data in `.middleware()`\n * @example\n * ```ts\n * .middleware((opts) => {\n *   return {\n *     [UTFiles]: opts.files.map((file) => ({\n *       ...file,\n *       customId: generateId(),\n *     }))\n *   };\n * })\n * ```\n */ const UTFiles = Symbol(\"uploadthing-custom-id-symbol\");\n/**\n * Valid options for the `?actionType` query param\n */ const VALID_ACTION_TYPES = [\n    \"upload\",\n    \"failure\",\n    \"multipart-complete\"\n];\nconst isActionType = (input)=>typeof input === \"string\" && VALID_ACTION_TYPES.includes(input);\n/**\n * Valid options for the `uploadthing-hook` header\n * for requests coming from UT server\n */ const VALID_UT_HOOKS = [\n    \"callback\"\n];\nconst isUploadThingHook = (input)=>typeof input === \"string\" && VALID_UT_HOOKS.includes(input);\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdXBsb2FkdGhpbmcvaW50ZXJuYWwvdHlwZXMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7Ozs7Ozs7Ozs7OztDQWFDLEdBQUcsTUFBTUEsVUFBVUMsT0FBTztBQUMzQjs7Q0FFQyxHQUFHLE1BQU1DLHFCQUFxQjtJQUMzQjtJQUNBO0lBQ0E7Q0FDSDtBQUNELE1BQU1DLGVBQWUsQ0FBQ0MsUUFBUSxPQUFPQSxVQUFVLFlBQVlGLG1CQUFtQkcsUUFBUSxDQUFDRDtBQUN2Rjs7O0NBR0MsR0FBRyxNQUFNRSxpQkFBaUI7SUFDdkI7Q0FDSDtBQUNELE1BQU1DLG9CQUFvQixDQUFDSCxRQUFRLE9BQU9BLFVBQVUsWUFBWUUsZUFBZUQsUUFBUSxDQUFDRDtBQUVBIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXZlbnRseS8uL25vZGVfbW9kdWxlcy91cGxvYWR0aGluZy9pbnRlcm5hbC90eXBlcy5qcz84NjczIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogTWFya2VyIHVzZWQgdG8gYXBwZW5kIGEgYGN1c3RvbUlkYCB0byB0aGUgaW5jb21pbmcgZmlsZSBkYXRhIGluIGAubWlkZGxld2FyZSgpYFxuICogQGV4YW1wbGVcbiAqIGBgYHRzXG4gKiAubWlkZGxld2FyZSgob3B0cykgPT4ge1xuICogICByZXR1cm4ge1xuICogICAgIFtVVEZpbGVzXTogb3B0cy5maWxlcy5tYXAoKGZpbGUpID0+ICh7XG4gKiAgICAgICAuLi5maWxlLFxuICogICAgICAgY3VzdG9tSWQ6IGdlbmVyYXRlSWQoKSxcbiAqICAgICB9KSlcbiAqICAgfTtcbiAqIH0pXG4gKiBgYGBcbiAqLyBjb25zdCBVVEZpbGVzID0gU3ltYm9sKFwidXBsb2FkdGhpbmctY3VzdG9tLWlkLXN5bWJvbFwiKTtcbi8qKlxuICogVmFsaWQgb3B0aW9ucyBmb3IgdGhlIGA/YWN0aW9uVHlwZWAgcXVlcnkgcGFyYW1cbiAqLyBjb25zdCBWQUxJRF9BQ1RJT05fVFlQRVMgPSBbXG4gICAgXCJ1cGxvYWRcIixcbiAgICBcImZhaWx1cmVcIixcbiAgICBcIm11bHRpcGFydC1jb21wbGV0ZVwiXG5dO1xuY29uc3QgaXNBY3Rpb25UeXBlID0gKGlucHV0KT0+dHlwZW9mIGlucHV0ID09PSBcInN0cmluZ1wiICYmIFZBTElEX0FDVElPTl9UWVBFUy5pbmNsdWRlcyhpbnB1dCk7XG4vKipcbiAqIFZhbGlkIG9wdGlvbnMgZm9yIHRoZSBgdXBsb2FkdGhpbmctaG9va2AgaGVhZGVyXG4gKiBmb3IgcmVxdWVzdHMgY29taW5nIGZyb20gVVQgc2VydmVyXG4gKi8gY29uc3QgVkFMSURfVVRfSE9PS1MgPSBbXG4gICAgXCJjYWxsYmFja1wiXG5dO1xuY29uc3QgaXNVcGxvYWRUaGluZ0hvb2sgPSAoaW5wdXQpPT50eXBlb2YgaW5wdXQgPT09IFwic3RyaW5nXCIgJiYgVkFMSURfVVRfSE9PS1MuaW5jbHVkZXMoaW5wdXQpO1xuXG5leHBvcnQgeyBVVEZpbGVzLCBWQUxJRF9BQ1RJT05fVFlQRVMsIFZBTElEX1VUX0hPT0tTLCBpc0FjdGlvblR5cGUsIGlzVXBsb2FkVGhpbmdIb29rIH07XG4iXSwibmFtZXMiOlsiVVRGaWxlcyIsIlN5bWJvbCIsIlZBTElEX0FDVElPTl9UWVBFUyIsImlzQWN0aW9uVHlwZSIsImlucHV0IiwiaW5jbHVkZXMiLCJWQUxJRF9VVF9IT09LUyIsImlzVXBsb2FkVGhpbmdIb29rIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/uploadthing/internal/types.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/uploadthing/next/index.js":
/*!************************************************!*\
  !*** ./node_modules/uploadthing/next/index.js ***!
  \************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   UTFiles: () => (/* reexport safe */ uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_1__.UTFiles),\n/* harmony export */   createNextRouteHandler: () => (/* binding */ createNextRouteHandler),\n/* harmony export */   createRouteHandler: () => (/* binding */ createRouteHandler),\n/* harmony export */   createUploadthing: () => (/* binding */ createUploadthing)\n/* harmony export */ });\n/* harmony import */ var uploadthing_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! uploadthing/server */ \"(rsc)/./node_modules/uploadthing/server/index.js\");\n/* harmony import */ var uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! uploadthing/internal/types */ \"(rsc)/./node_modules/uploadthing/internal/types.js\");\n\n\nfunction defaultErrorFormatter(error) {\n    return {\n        message: error.message\n    };\n}\nfunction internalCreateBuilder(initDef = {}) {\n    const _def = {\n        // Default router config\n        routerConfig: {\n            image: {\n                maxFileSize: \"4MB\"\n            }\n        },\n        inputParser: {\n            parse: ()=>undefined,\n            _input: undefined,\n            _output: undefined\n        },\n        middleware: ()=>({}),\n        onUploadError: ()=>({}),\n        errorFormatter: initDef.errorFormatter ?? defaultErrorFormatter,\n        // Overload with properties passed in\n        ...initDef\n    };\n    return {\n        input (userParser) {\n            return internalCreateBuilder({\n                ..._def,\n                inputParser: userParser\n            });\n        },\n        middleware (userMiddleware) {\n            return internalCreateBuilder({\n                ..._def,\n                middleware: userMiddleware\n            });\n        },\n        onUploadComplete (userUploadComplete) {\n            return {\n                _def,\n                resolver: userUploadComplete\n            };\n        },\n        onUploadError (userOnUploadError) {\n            return internalCreateBuilder({\n                ..._def,\n                onUploadError: userOnUploadError\n            });\n        }\n    };\n}\nfunction createBuilder(opts) {\n    return (input)=>{\n        return internalCreateBuilder({\n            routerConfig: input,\n            ...opts\n        });\n    };\n}\nconst createUploadthing = (opts)=>createBuilder(opts);\nconst createRouteHandler = (opts)=>{\n    const handlers = (0,uploadthing_server__WEBPACK_IMPORTED_MODULE_0__.INTERNAL_DO_NOT_USE_createRouteHandlerCore)(opts, \"nextjs-app\");\n    return {\n        POST: (req)=>handlers.POST(req),\n        GET: (req)=>handlers.GET(req)\n    };\n};\n/**\n * @deprecated Use {@link createRouteHandler} instead\n */ const createNextRouteHandler = createRouteHandler;\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdXBsb2FkdGhpbmcvbmV4dC9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBZ0Y7QUFDM0I7QUFFckQsU0FBU0Usc0JBQXNCQyxLQUFLO0lBQ2hDLE9BQU87UUFDSEMsU0FBU0QsTUFBTUMsT0FBTztJQUMxQjtBQUNKO0FBRUEsU0FBU0Msc0JBQXNCQyxVQUFVLENBQUMsQ0FBQztJQUN2QyxNQUFNQyxPQUFPO1FBQ1Qsd0JBQXdCO1FBQ3hCQyxjQUFjO1lBQ1ZDLE9BQU87Z0JBQ0hDLGFBQWE7WUFDakI7UUFDSjtRQUNBQyxhQUFhO1lBQ1RDLE9BQU8sSUFBSUM7WUFDWEMsUUFBUUQ7WUFDUkUsU0FBU0Y7UUFDYjtRQUNBRyxZQUFZLElBQUssRUFBQztRQUNsQkMsZUFBZSxJQUFLLEVBQUM7UUFDckJDLGdCQUFnQlosUUFBUVksY0FBYyxJQUFJaEI7UUFDMUMscUNBQXFDO1FBQ3JDLEdBQUdJLE9BQU87SUFDZDtJQUNBLE9BQU87UUFDSGEsT0FBT0MsVUFBVTtZQUNiLE9BQU9mLHNCQUFzQjtnQkFDekIsR0FBR0UsSUFBSTtnQkFDUEksYUFBYVM7WUFDakI7UUFDSjtRQUNBSixZQUFZSyxjQUFjO1lBQ3RCLE9BQU9oQixzQkFBc0I7Z0JBQ3pCLEdBQUdFLElBQUk7Z0JBQ1BTLFlBQVlLO1lBQ2hCO1FBQ0o7UUFDQUMsa0JBQWtCQyxrQkFBa0I7WUFDaEMsT0FBTztnQkFDSGhCO2dCQUNBaUIsVUFBVUQ7WUFDZDtRQUNKO1FBQ0FOLGVBQWVRLGlCQUFpQjtZQUM1QixPQUFPcEIsc0JBQXNCO2dCQUN6QixHQUFHRSxJQUFJO2dCQUNQVSxlQUFlUTtZQUNuQjtRQUNKO0lBQ0o7QUFDSjtBQUNBLFNBQVNDLGNBQWNDLElBQUk7SUFDdkIsT0FBTyxDQUFDUjtRQUNKLE9BQU9kLHNCQUFzQjtZQUN6QkcsY0FBY1c7WUFDZCxHQUFHUSxJQUFJO1FBQ1g7SUFDSjtBQUNKO0FBRUEsTUFBTUMsb0JBQW9CLENBQUNELE9BQU9ELGNBQWNDO0FBQ2hELE1BQU1FLHFCQUFxQixDQUFDRjtJQUN4QixNQUFNRyxXQUFXOUIsOEZBQTBDQSxDQUFDMkIsTUFBTTtJQUNsRSxPQUFPO1FBQ0hJLE1BQU0sQ0FBQ0MsTUFBTUYsU0FBU0MsSUFBSSxDQUFDQztRQUMzQkMsS0FBSyxDQUFDRCxNQUFNRixTQUFTRyxHQUFHLENBQUNEO0lBQzdCO0FBQ0o7QUFDQTs7Q0FFQyxHQUFHLE1BQU1FLHlCQUF5Qkw7QUFFc0MiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9ldmVudGx5Ly4vbm9kZV9tb2R1bGVzL3VwbG9hZHRoaW5nL25leHQvaW5kZXguanM/YzcwNyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJTlRFUk5BTF9ET19OT1RfVVNFX2NyZWF0ZVJvdXRlSGFuZGxlckNvcmUgfSBmcm9tICd1cGxvYWR0aGluZy9zZXJ2ZXInO1xuZXhwb3J0IHsgVVRGaWxlcyB9IGZyb20gJ3VwbG9hZHRoaW5nL2ludGVybmFsL3R5cGVzJztcblxuZnVuY3Rpb24gZGVmYXVsdEVycm9yRm9ybWF0dGVyKGVycm9yKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZVxuICAgIH07XG59XG5cbmZ1bmN0aW9uIGludGVybmFsQ3JlYXRlQnVpbGRlcihpbml0RGVmID0ge30pIHtcbiAgICBjb25zdCBfZGVmID0ge1xuICAgICAgICAvLyBEZWZhdWx0IHJvdXRlciBjb25maWdcbiAgICAgICAgcm91dGVyQ29uZmlnOiB7XG4gICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgIG1heEZpbGVTaXplOiBcIjRNQlwiXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGlucHV0UGFyc2VyOiB7XG4gICAgICAgICAgICBwYXJzZTogKCk9PnVuZGVmaW5lZCxcbiAgICAgICAgICAgIF9pbnB1dDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgX291dHB1dDogdW5kZWZpbmVkXG4gICAgICAgIH0sXG4gICAgICAgIG1pZGRsZXdhcmU6ICgpPT4oe30pLFxuICAgICAgICBvblVwbG9hZEVycm9yOiAoKT0+KHt9KSxcbiAgICAgICAgZXJyb3JGb3JtYXR0ZXI6IGluaXREZWYuZXJyb3JGb3JtYXR0ZXIgPz8gZGVmYXVsdEVycm9yRm9ybWF0dGVyLFxuICAgICAgICAvLyBPdmVybG9hZCB3aXRoIHByb3BlcnRpZXMgcGFzc2VkIGluXG4gICAgICAgIC4uLmluaXREZWZcbiAgICB9O1xuICAgIHJldHVybiB7XG4gICAgICAgIGlucHV0ICh1c2VyUGFyc2VyKSB7XG4gICAgICAgICAgICByZXR1cm4gaW50ZXJuYWxDcmVhdGVCdWlsZGVyKHtcbiAgICAgICAgICAgICAgICAuLi5fZGVmLFxuICAgICAgICAgICAgICAgIGlucHV0UGFyc2VyOiB1c2VyUGFyc2VyXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcbiAgICAgICAgbWlkZGxld2FyZSAodXNlck1pZGRsZXdhcmUpIHtcbiAgICAgICAgICAgIHJldHVybiBpbnRlcm5hbENyZWF0ZUJ1aWxkZXIoe1xuICAgICAgICAgICAgICAgIC4uLl9kZWYsXG4gICAgICAgICAgICAgICAgbWlkZGxld2FyZTogdXNlck1pZGRsZXdhcmVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBvblVwbG9hZENvbXBsZXRlICh1c2VyVXBsb2FkQ29tcGxldGUpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgX2RlZixcbiAgICAgICAgICAgICAgICByZXNvbHZlcjogdXNlclVwbG9hZENvbXBsZXRlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9LFxuICAgICAgICBvblVwbG9hZEVycm9yICh1c2VyT25VcGxvYWRFcnJvcikge1xuICAgICAgICAgICAgcmV0dXJuIGludGVybmFsQ3JlYXRlQnVpbGRlcih7XG4gICAgICAgICAgICAgICAgLi4uX2RlZixcbiAgICAgICAgICAgICAgICBvblVwbG9hZEVycm9yOiB1c2VyT25VcGxvYWRFcnJvclxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xufVxuZnVuY3Rpb24gY3JlYXRlQnVpbGRlcihvcHRzKSB7XG4gICAgcmV0dXJuIChpbnB1dCk9PntcbiAgICAgICAgcmV0dXJuIGludGVybmFsQ3JlYXRlQnVpbGRlcih7XG4gICAgICAgICAgICByb3V0ZXJDb25maWc6IGlucHV0LFxuICAgICAgICAgICAgLi4ub3B0c1xuICAgICAgICB9KTtcbiAgICB9O1xufVxuXG5jb25zdCBjcmVhdGVVcGxvYWR0aGluZyA9IChvcHRzKT0+Y3JlYXRlQnVpbGRlcihvcHRzKTtcbmNvbnN0IGNyZWF0ZVJvdXRlSGFuZGxlciA9IChvcHRzKT0+e1xuICAgIGNvbnN0IGhhbmRsZXJzID0gSU5URVJOQUxfRE9fTk9UX1VTRV9jcmVhdGVSb3V0ZUhhbmRsZXJDb3JlKG9wdHMsIFwibmV4dGpzLWFwcFwiKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBQT1NUOiAocmVxKT0+aGFuZGxlcnMuUE9TVChyZXEpLFxuICAgICAgICBHRVQ6IChyZXEpPT5oYW5kbGVycy5HRVQocmVxKVxuICAgIH07XG59O1xuLyoqXG4gKiBAZGVwcmVjYXRlZCBVc2Uge0BsaW5rIGNyZWF0ZVJvdXRlSGFuZGxlcn0gaW5zdGVhZFxuICovIGNvbnN0IGNyZWF0ZU5leHRSb3V0ZUhhbmRsZXIgPSBjcmVhdGVSb3V0ZUhhbmRsZXI7XG5cbmV4cG9ydCB7IGNyZWF0ZU5leHRSb3V0ZUhhbmRsZXIsIGNyZWF0ZVJvdXRlSGFuZGxlciwgY3JlYXRlVXBsb2FkdGhpbmcgfTtcbiJdLCJuYW1lcyI6WyJJTlRFUk5BTF9ET19OT1RfVVNFX2NyZWF0ZVJvdXRlSGFuZGxlckNvcmUiLCJVVEZpbGVzIiwiZGVmYXVsdEVycm9yRm9ybWF0dGVyIiwiZXJyb3IiLCJtZXNzYWdlIiwiaW50ZXJuYWxDcmVhdGVCdWlsZGVyIiwiaW5pdERlZiIsIl9kZWYiLCJyb3V0ZXJDb25maWciLCJpbWFnZSIsIm1heEZpbGVTaXplIiwiaW5wdXRQYXJzZXIiLCJwYXJzZSIsInVuZGVmaW5lZCIsIl9pbnB1dCIsIl9vdXRwdXQiLCJtaWRkbGV3YXJlIiwib25VcGxvYWRFcnJvciIsImVycm9yRm9ybWF0dGVyIiwiaW5wdXQiLCJ1c2VyUGFyc2VyIiwidXNlck1pZGRsZXdhcmUiLCJvblVwbG9hZENvbXBsZXRlIiwidXNlclVwbG9hZENvbXBsZXRlIiwicmVzb2x2ZXIiLCJ1c2VyT25VcGxvYWRFcnJvciIsImNyZWF0ZUJ1aWxkZXIiLCJvcHRzIiwiY3JlYXRlVXBsb2FkdGhpbmciLCJjcmVhdGVSb3V0ZUhhbmRsZXIiLCJoYW5kbGVycyIsIlBPU1QiLCJyZXEiLCJHRVQiLCJjcmVhdGVOZXh0Um91dGVIYW5kbGVyIl0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/uploadthing/next/index.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/uploadthing/server/index.js":
/*!**************************************************!*\
  !*** ./node_modules/uploadthing/server/index.js ***!
  \**************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   INTERNAL_DO_NOT_USE_createRouteHandlerCore: () => (/* binding */ INTERNAL_DO_NOT_USE_createRouteHandlerCore),\n/* harmony export */   UTApi: () => (/* binding */ UTApi),\n/* harmony export */   UTFile: () => (/* binding */ UTFile),\n/* harmony export */   UTFiles: () => (/* reexport safe */ uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_2__.UTFiles),\n/* harmony export */   UploadThingError: () => (/* reexport safe */ _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError),\n/* harmony export */   createRouteHandler: () => (/* binding */ createRouteHandler),\n/* harmony export */   createServerHandler: () => (/* binding */ createServerHandler),\n/* harmony export */   createUploadthing: () => (/* binding */ createUploadthing),\n/* harmony export */   extractRouterConfig: () => (/* binding */ extractRouterConfig)\n/* harmony export */ });\n/* harmony import */ var _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @uploadthing/shared */ \"(rsc)/./node_modules/@uploadthing/shared/dist/index.js\");\n/* harmony import */ var _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @effect/schema/Schema */ \"(rsc)/./node_modules/@effect/schema/dist/esm/Schema.js\");\n/* harmony import */ var effect_Effect__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! effect/Effect */ \"(rsc)/./node_modules/effect/dist/esm/Effect.js\");\n/* harmony import */ var consola_core__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! consola/core */ \"(rsc)/./node_modules/consola/dist/core.mjs\");\n/* harmony import */ var effect_Logger__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! effect/Logger */ \"(rsc)/./node_modules/effect/dist/esm/Logger.js\");\n/* harmony import */ var effect_LogLevel__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! effect/LogLevel */ \"(rsc)/./node_modules/effect/dist/esm/LogLevel.js\");\n/* harmony import */ var std_env__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! std-env */ \"(rsc)/./node_modules/std-env/dist/index.mjs\");\n/* harmony import */ var effect_Context__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! effect/Context */ \"(rsc)/./node_modules/effect/dist/esm/Context.js\");\n/* harmony import */ var effect_Data__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! effect/Data */ \"(rsc)/./node_modules/effect/dist/esm/Data.js\");\n/* harmony import */ var uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! uploadthing/internal/types */ \"(rsc)/./node_modules/uploadthing/internal/types.js\");\n/* harmony import */ var _uploadthing_mime_types__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @uploadthing/mime-types */ \"(rsc)/./node_modules/@uploadthing/mime-types/dist/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar version = \"6.10.1\";\nfunction defaultErrorFormatter(error) {\n    return {\n        message: error.message\n    };\n}\nfunction formatError(error, router) {\n    const errorFormatter = router[Object.keys(router)[0]]?._def.errorFormatter ?? defaultErrorFormatter;\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    return errorFormatter(error);\n}\n/**\n * =============================================================================\n * ======================== File Type Hierarchy ===============================\n * =============================================================================\n */ const FileUploadDataSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    name: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    size: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number,\n    type: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n});\nconst FileUploadDataWithCustomIdSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.extend(FileUploadDataSchema, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    customId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n}));\nconst UploadedFileDataSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.extend(FileUploadDataWithCustomIdSchema, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    key: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    url: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n}));\n/**\n * =============================================================================\n * ======================== Server Response Schemas ============================\n * =============================================================================\n */ const PresignedBaseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    key: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    fileName: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    fileType: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    fileUrl: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    pollingJwt: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    pollingUrl: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    contentDisposition: _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.ContentDispositionSchema,\n    customId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n});\nconst MPUResponseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.extend(PresignedBaseSchema, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    urls: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Array(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n    uploadId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    chunkSize: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number,\n    chunkCount: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number\n}));\nconst PSPResponseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.extend(PresignedBaseSchema, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    url: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    fields: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Record(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n}));\nconst PresignedURLResponseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Array(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Union(PSPResponseSchema, MPUResponseSchema));\nconst PollUploadResponseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    status: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    fileData: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n        fileKey: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n        fileName: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n        fileSize: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number,\n        fileType: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n        metadata: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n        customId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n        callbackUrl: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n        callbackSlug: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n    }))\n});\nconst FailureCallbackResponseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    success: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Boolean,\n    message: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n});\nconst ServerCallbackPostResponseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    status: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n});\n/**\n * =============================================================================\n * ======================== Client Action Payloads ============================\n * =============================================================================\n */ const UploadActionPayload = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    files: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Array(FileUploadDataSchema),\n    input: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Unknown\n});\nconst FailureActionPayload = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    fileKey: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    uploadId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.NullOr(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n    storageProviderError: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String),\n    fileName: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n});\nconst MultipartCompleteActionPayload = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n    fileKey: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    uploadId: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n    etags: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Array(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n        tag: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n        partNumber: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number\n    }))\n});\nconst isValidResponse = (response)=>{\n    if (!response.ok) return false;\n    if (response.status >= 400) return false;\n    if (!response.headers.has(\"x-uploadthing-version\")) return false;\n    return true;\n};\nconst conditionalDevServer = (fileKey, apiKey)=>{\n    return effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n        const file = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateUploadThingURL)(`/api/pollUpload/${fileKey}`), PollUploadResponseSchema).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen((res)=>res.status === \"done\" ? effect_Effect__WEBPACK_IMPORTED_MODULE_5__.succeed(res.fileData) : effect_Effect__WEBPACK_IMPORTED_MODULE_5__.fail(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError())), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.retry({\n            while: (err)=>err instanceof _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError,\n            schedule: _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.exponentialBackoff\n        }), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTag(\"RetryError\", (e)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.die(e)));\n        if (file === undefined) {\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(`Failed to simulate callback for file ${fileKey}`);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"UPLOAD_FAILED\",\n                message: \"File took too long to upload\"\n            });\n        }\n        let callbackUrl = file.callbackUrl + `?slug=${file.callbackSlug}`;\n        if (!callbackUrl.startsWith(\"http\")) callbackUrl = \"http://\" + callbackUrl;\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logInfo(`SIMULATING FILE UPLOAD WEBHOOK CALLBACK`, callbackUrl);\n        const payload = JSON.stringify({\n            status: \"uploaded\",\n            metadata: JSON.parse(file.metadata ?? \"{}\"),\n            file: {\n                url: `https://utfs.io/f/${encodeURIComponent(fileKey)}`,\n                key: fileKey,\n                name: file.fileName,\n                size: file.fileSize,\n                customId: file.customId,\n                type: file.fileType\n            }\n        });\n        const signature = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tryPromise({\n            try: ()=>(0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.signPayload)(payload, apiKey),\n            catch: (e)=>new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: \"Failed to sign payload\",\n                    cause: e\n                })\n        });\n        const callbackResponse = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEff)(callbackUrl, {\n            method: \"POST\",\n            body: payload,\n            headers: {\n                \"Content-Type\": \"application/json\",\n                \"uploadthing-hook\": \"callback\",\n                \"x-uploadthing-signature\": signature\n            }\n        }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTag(\"FetchError\", ()=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.succeed(new Response(null, {\n                status: 500\n            }))));\n        if (isValidResponse(callbackResponse)) {\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logInfo(\"Successfully simulated callback for file\", fileKey);\n        } else {\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(`\nFailed to simulate callback for file '${file.fileKey}'. Is your webhook configured correctly?\n  - Make sure the URL '${callbackUrl}' is accessible without any authentication. You can verify this by running 'curl -X POST ${callbackUrl}' in your terminal\n  - Still facing issues? Read https://docs.uploadthing.com/faq for common issues\n`.trim());\n        }\n        return file;\n    });\n};\nconst colorize = (str, level)=>{\n    // TODO: Maybe check is shell supports colors\n    switch(level){\n        case \"error\":\n        case \"fatal\":\n            return `\\x1b[41m\\x1b[30m${str}\\x1b[0m`;\n        case \"warn\":\n            return `\\x1b[43m\\x1b[30m${str}\\x1b[0m`;\n        case \"info\":\n        case \"log\":\n            return `\\x1b[44m\\x1b[30m${str}\\x1b[0m`;\n        case \"debug\":\n            return `\\x1b[47m\\x1b[30m${str}\\x1b[0m`;\n        case \"trace\":\n            return `\\x1b[47m\\x1b[30m${str}\\x1b[0m`;\n        case \"success\":\n            return `\\x1b[42m\\x1b[30m${str}\\x1b[0m`;\n        default:\n            return str;\n    }\n};\nconst icons = {\n    fatal: \"⨯\",\n    error: \"⨯\",\n    warn: \"⚠️\",\n    info: \"ℹ\",\n    log: \"ℹ\",\n    debug: \"⚙\",\n    trace: \"→\",\n    success: \"✓\"\n};\nfunction formatStack(stack) {\n    const cwd = \"cwd\" in std_env__WEBPACK_IMPORTED_MODULE_6__.process && typeof std_env__WEBPACK_IMPORTED_MODULE_6__.process.cwd === \"function\" ? std_env__WEBPACK_IMPORTED_MODULE_6__.process.cwd() : \"__UnknownCWD__\";\n    return \"  \" + stack.split(\"\\n\").splice(1).map((l)=>l.trim().replace(\"file://\", \"\").replace(cwd + \"/\", \"\")).join(\"\\n  \");\n}\nfunction formatArgs(args) {\n    const fmtArgs = args.map((arg)=>{\n        if ((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.isObject)(arg) && typeof arg.stack === \"string\") {\n            return arg.message + \"\\n\" + formatStack(arg.stack);\n        }\n        // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n        return arg;\n    });\n    return fmtArgs.map((arg)=>{\n        if (typeof arg === \"string\") {\n            return arg;\n        }\n        return JSON.stringify(arg, null, 4);\n    });\n}\nconst logger = (0,consola_core__WEBPACK_IMPORTED_MODULE_1__.createConsola)({\n    reporters: [\n        {\n            log: (logObj)=>{\n                const { type, tag, date, args } = logObj;\n                const icon = icons[type];\n                const logPrefix = colorize(` ${icon} ${tag} ${date.toLocaleTimeString()} `, type);\n                const lines = formatArgs(args).join(\" \") // concat all arguments to one space-separated string (like console does)\n                .split(\"\\n\") // split all the newlines (e.g. from logged JSON.stringified objects)\n                .map((l)=>logPrefix + \" \" + l) // prepend the log prefix to each line\n                .join(\"\\n\"); // join all the lines back together\n                // eslint-disable-next-line no-console\n                console.log(lines);\n            }\n        }\n    ],\n    defaults: {\n        tag: \"UPLOADTHING\"\n    }\n});\nconst effectLoggerLevelToConsolaLevel = {\n    All: \"verbose\",\n    Fatal: \"error\",\n    Error: \"error\",\n    Info: \"info\",\n    Debug: \"debug\",\n    Trace: \"trace\",\n    Warning: \"warn\",\n    None: \"silent\"\n};\nconst withMinimalLogLevel = (level = \"info\")=>{\n    return effect_Logger__WEBPACK_IMPORTED_MODULE_7__.withMinimumLogLevel({\n        silent: effect_LogLevel__WEBPACK_IMPORTED_MODULE_8__.None,\n        error: effect_LogLevel__WEBPACK_IMPORTED_MODULE_8__.Error,\n        warn: effect_LogLevel__WEBPACK_IMPORTED_MODULE_8__.Warning,\n        info: effect_LogLevel__WEBPACK_IMPORTED_MODULE_8__.Info,\n        debug: effect_LogLevel__WEBPACK_IMPORTED_MODULE_8__.Debug,\n        trace: effect_LogLevel__WEBPACK_IMPORTED_MODULE_8__.Trace,\n        verbose: effect_LogLevel__WEBPACK_IMPORTED_MODULE_8__.All\n    }[level]);\n};\nconst ConsolaLogger = effect_Logger__WEBPACK_IMPORTED_MODULE_7__.replace(effect_Logger__WEBPACK_IMPORTED_MODULE_7__.defaultLogger, effect_Logger__WEBPACK_IMPORTED_MODULE_7__.make(({ logLevel, message })=>{\n    // FIXME: Probably log other stuff than just message?\n    logger[effectLoggerLevelToConsolaLevel[logLevel._tag]](message);\n}));\nconst uploadMultipart = (file, presigned)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(`Uploading file ${file.name} with ${presigned.urls.length} chunks of size ${presigned.chunkSize} bytes each`);\n        const etags = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.forEach(presigned.urls, (url, index)=>{\n            const offset = presigned.chunkSize * index;\n            const end = Math.min(offset + presigned.chunkSize, file.size);\n            const chunk = file.slice(offset, end);\n            return uploadPart({\n                url,\n                chunk: chunk,\n                contentDisposition: presigned.contentDisposition,\n                contentType: file.type,\n                fileName: file.name,\n                maxRetries: 10,\n                key: presigned.key,\n                uploadId: presigned.uploadId\n            }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen((etag)=>({\n                    tag: etag,\n                    partNumber: index + 1\n                })), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTag(\"RetryError\", (e)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.die(e)));\n        }, {\n            concurrency: \"inherit\"\n        });\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"File\", file.name, \"uploaded successfully.\");\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Completing multipart upload...\");\n        yield* completeMultipartUpload(presigned, etags);\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Multipart upload complete.\");\n    });\n/**\n * Used by server uploads where progress is not needed.\n * Uses normal fetch API.\n */ const uploadPart = (opts)=>(0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEff)(opts.url, {\n        method: \"PUT\",\n        body: opts.chunk,\n        headers: {\n            \"Content-Type\": opts.contentType,\n            \"Content-Disposition\": (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.contentDisposition)(opts.contentDisposition, opts.fileName)\n        }\n    }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen((res)=>res.ok && res.headers.get(\"Etag\") ? effect_Effect__WEBPACK_IMPORTED_MODULE_5__.succeed(res.headers.get(\"Etag\")) : effect_Effect__WEBPACK_IMPORTED_MODULE_5__.fail(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError())), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.retry({\n        while: (res)=>res instanceof _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError,\n        schedule: _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.exponentialBackoff,\n        times: opts.maxRetries\n    }), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tapErrorTag(\"RetryError\", ()=>abortMultipartUpload({\n            key: opts.key,\n            uploadId: opts.uploadId\n        }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen((res)=>{\n            effect_Effect__WEBPACK_IMPORTED_MODULE_5__.fail(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"UPLOAD_FAILED\",\n                message: `Failed to upload file ${opts.fileName} to S3`,\n                cause: res\n            }));\n        }))));\nconst completeMultipartUpload = (presigned, etags)=>(0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateUploadThingURL)(\"/api/completeMultipart\"), _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n        success: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Boolean,\n        message: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.optional(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String)\n    }), {\n        method: \"POST\",\n        body: JSON.stringify({\n            fileKey: presigned.key,\n            uploadId: presigned.uploadId,\n            etags\n        }),\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    });\nconst abortMultipartUpload = (presigned)=>(0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateUploadThingURL)(\"/api/failureCallback\"), FailureCallbackResponseSchema, {\n        method: \"POST\",\n        body: JSON.stringify({\n            fileKey: presigned.key,\n            uploadId: presigned.uploadId\n        }),\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    });\nfunction getParseFn(parser) {\n    if (typeof parser.parse === \"function\") {\n        return parser.parse;\n    }\n    throw new Error(\"Invalid parser\");\n}\nconst getApiKey = (apiKey)=>{\n    if (apiKey) return apiKey;\n    if (std_env__WEBPACK_IMPORTED_MODULE_6__.process.env.UPLOADTHING_SECRET) return std_env__WEBPACK_IMPORTED_MODULE_6__.process.env.UPLOADTHING_SECRET;\n    return undefined;\n};\nconst getApiKeyOrThrow = (apiKey)=>{\n    const key = getApiKey(apiKey);\n    if (!key?.startsWith(\"sk_\")) {\n        throw new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n            code: \"MISSING_ENV\",\n            message: \"Missing or invalid API key. API keys must start with `sk_`.\"\n        });\n    }\n    return key;\n};\nclass FileSizeMismatch extends (0,effect_Data__WEBPACK_IMPORTED_MODULE_9__.TaggedError)(\"FileSizeMismatch\") {\n    constructor(type, max, actual){\n        const reason = `You uploaded a ${type} file that was ${(0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.bytesToFileSize)(actual)}, but the limit for that type is ${max}`;\n        super({\n            reason\n        });\n    }\n}\nclass FileCountMismatch extends (0,effect_Data__WEBPACK_IMPORTED_MODULE_9__.TaggedError)(\"FileCountMismatch\") {\n    constructor(type, boundtype, bound, actual){\n        const reason = `You uploaded ${actual} file(s) of type '${type}', but the ${boundtype} for that type is ${bound}`;\n        super({\n            reason\n        });\n    }\n}\n// Verify that the uploaded files doesn't violate the route config,\n// e.g. uploading more videos than allowed, or a file that is larger than allowed.\n// This is double-checked on infra side, but we want to fail early to avoid network latency.\nconst assertFilesMeetConfig = (files, routeConfig)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n        const counts = {};\n        for (const file of files){\n            const type = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.getTypeFromFileName)(file.name, (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.objectKeys)(routeConfig));\n            counts[type] = (counts[type] ?? 0) + 1;\n            const sizeLimit = routeConfig[type]?.maxFileSize;\n            if (!sizeLimit) {\n                return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.InvalidRouteConfigError(type, \"maxFileSize\");\n            }\n            const sizeLimitBytes = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fileSizeToBytes)(sizeLimit);\n            if (file.size > sizeLimitBytes) {\n                return yield* new FileSizeMismatch(type, sizeLimit, file.size);\n            }\n        }\n        for(const _key in counts){\n            const key = _key;\n            const config = routeConfig[key];\n            if (!config) return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.InvalidRouteConfigError(key);\n            const count = counts[key];\n            const min = config.minFileCount;\n            const max = config.maxFileCount;\n            if (min > max) {\n                return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"Invalid config during file count - minFileCount > maxFileCount\",\n                    cause: `minFileCount must be less than maxFileCount for key ${key}. got: ${min} > ${max}`\n                });\n            }\n            if (count < min) {\n                return yield* new FileCountMismatch(key, \"minimum\", min, count);\n            }\n            if (count > max) {\n                return yield* new FileCountMismatch(key, \"maximum\", max, count);\n            }\n        }\n        return null;\n    });\nclass RequestInput extends effect_Context__WEBPACK_IMPORTED_MODULE_10__.Tag(\"uploadthing/RequestInput\")() {\n}\nconst parseAndValidateRequest = (input, opts, adapter)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n        const req = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.isEffect(input.req) ? input.req : effect_Effect__WEBPACK_IMPORTED_MODULE_5__.succeed(input.req);\n        // Get inputs from query and params\n        const url = new URL(req.url);\n        const headers = req.headers;\n        const params = url.searchParams;\n        const action = params.get(\"actionType\");\n        const slug = params.get(\"slug\");\n        const hook = headers.get(\"uploadthing-hook\");\n        const utFrontendPackage = headers.get(\"x-uploadthing-package\") ?? \"unknown\";\n        const clientVersion = headers.get(\"x-uploadthing-version\");\n        const apiKey = getApiKey(opts.config?.uploadthingSecret);\n        if (clientVersion != null && clientVersion !== version) {\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(`Client version mismatch. Server version: ${version}, Client version: ${clientVersion}`);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Client version mismatch\",\n                cause: `Server version: ${version}, Client version: ${clientVersion}`\n            });\n        }\n        if (!slug) {\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"No slug provided in params:\", params);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"No slug provided in params\"\n            });\n        }\n        if (slug && typeof slug !== \"string\") {\n            const msg = `Expected slug to be of type 'string', got '${typeof slug}'`;\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(msg);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"`slug` must be a string\",\n                cause: msg\n            });\n        }\n        if (!apiKey) {\n            const msg = `No secret provided, please set UPLOADTHING_SECRET in your env file or in the config`;\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(msg);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"MISSING_ENV\",\n                message: `No secret provided`,\n                cause: msg\n            });\n        }\n        if (!apiKey.startsWith(\"sk_\")) {\n            const msg = `Invalid secret provided, UPLOADTHING_SECRET must start with 'sk_'`;\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(msg);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"MISSING_ENV\",\n                message: \"Invalid API key. API keys must start with 'sk_'.\",\n                cause: msg\n            });\n        }\n        if (utFrontendPackage && typeof utFrontendPackage !== \"string\") {\n            const msg = `Expected x-uploadthing-package to be of type 'string', got '${typeof utFrontendPackage}'`;\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(msg);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"`x-uploadthing-package` must be a string. eg. '@uploadthing/react'\",\n                cause: msg\n            });\n        }\n        const uploadable = opts.router[slug];\n        if (!uploadable) {\n            const msg = `No file route found for slug ${slug}`;\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(msg);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"NOT_FOUND\",\n                message: msg\n            });\n        }\n        if (action && !(0,uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_2__.isActionType)(action)) {\n            const msg = `Expected ${uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_2__.VALID_ACTION_TYPES.map((x)=>`\"${x}\"`).join(\", \").replace(/,(?!.*,)/, \" or\")} but got \"${action}\"`;\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"Invalid action type\", msg);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"BAD_REQUEST\",\n                cause: `Invalid action type ${action}`,\n                message: msg\n            });\n        }\n        if (hook && !(0,uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_2__.isUploadThingHook)(hook)) {\n            const msg = `Expected ${uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_2__.VALID_UT_HOOKS.map((x)=>`\"${x}\"`).join(\", \").replace(/,(?!.*,)/, \" or\")} but got \"${hook}\"`;\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"Invalid uploadthing hook\", msg);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"BAD_REQUEST\",\n                cause: `Invalid uploadthing hook ${hook}`,\n                message: msg\n            });\n        }\n        if (!action && !hook || action && hook) {\n            const msg = `Exactly one of 'actionType' or 'uploadthing-hook' must be provided`;\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(msg);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: msg\n            });\n        }\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"✔︎ All request input is valid\");\n        // FIXME: This should probably provide the full context at once instead of\n        // partially in the `runRequestHandlerAsync` and partially in here...\n        // Ref: https://discord.com/channels/@me/1201977154577891369/1207441839972548669\n        const contextValue = yield* _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.FetchContext;\n        contextValue.baseHeaders[\"x-uploadthing-api-key\"] = apiKey;\n        contextValue.baseHeaders[\"x-uploadthing-fe-package\"] = utFrontendPackage;\n        contextValue.baseHeaders[\"x-uploadthing-be-adapter\"] = adapter;\n        const { isDev = std_env__WEBPACK_IMPORTED_MODULE_6__.isDevelopment } = opts.config ?? {};\n        if (isDev) yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logInfo(\"UploadThing dev server is now running!\");\n        const base = {\n            req,\n            config: opts.config ?? {},\n            middlewareArgs: input.middlewareArgs,\n            isDev,\n            apiKey,\n            slug,\n            uploadable,\n            hook: null,\n            action: null\n        };\n        return action ? {\n            ...base,\n            action: action\n        } : {\n            ...base,\n            hook: hook\n        };\n    });\nconst resolveCallbackUrl = effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n    const { config, req, isDev } = yield* RequestInput;\n    let callbackUrl = new URL(req.url);\n    if (config?.callbackUrl) {\n        callbackUrl = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.getFullApiUrl)(config.callbackUrl);\n    } else if (std_env__WEBPACK_IMPORTED_MODULE_6__.process.env.UPLOADTHING_URL) {\n        callbackUrl = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.getFullApiUrl)(std_env__WEBPACK_IMPORTED_MODULE_6__.process.env.UPLOADTHING_URL);\n    }\n    if (isDev || !callbackUrl.host.includes(\"localhost\")) {\n        return callbackUrl;\n    }\n    // Production builds have to have a public URL so UT can send webhook\n    // Parse the URL from the headers\n    let parsedFromHeaders = req.headers.get(\"origin\") ?? req.headers.get(\"referer\") ?? req.headers.get(\"host\") ?? req.headers.get(\"x-forwarded-host\");\n    if (parsedFromHeaders && !parsedFromHeaders.includes(\"http\")) {\n        parsedFromHeaders = (req.headers.get(\"x-forwarded-proto\") ?? \"https\") + \"://\" + parsedFromHeaders;\n    }\n    if (!parsedFromHeaders || parsedFromHeaders.includes(\"localhost\")) {\n        // Didn't find a valid URL in the headers, log a warning and use the original url anyway\n        effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logWarning(\"You are using a localhost callback url in production which is not supported.\", \"Read more and learn how to fix it here: https://docs.uploadthing.com/faq#my-callback-runs-in-development-but-not-in-production\");\n        return callbackUrl;\n    }\n    return yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.getFullApiUrl)(parsedFromHeaders);\n});\n/**\n * Allows adapters to be fully async/await instead of providing services and running Effect programs\n */ const runRequestHandlerAsync = (handler, args, config)=>handler(args).pipe(withMinimalLogLevel(config?.logLevel), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.provide(ConsolaLogger), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.provideService(_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.FetchContext, {\n        fetch: config?.fetch ?? globalThis.fetch,\n        baseHeaders: {\n            \"x-uploadthing-version\": version,\n            // These are filled in later in `parseAndValidateRequest`\n            \"x-uploadthing-api-key\": undefined,\n            \"x-uploadthing-be-adapter\": undefined,\n            \"x-uploadthing-fe-package\": undefined\n        }\n    }), asHandlerOutput, effect_Effect__WEBPACK_IMPORTED_MODULE_5__.runPromise);\nconst asHandlerOutput = (effect)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchAll(effect, (error)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.succeed({\n            success: false,\n            error\n        }));\nconst handleRequest = RequestInput.pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen(({ action, hook })=>{\n    if (hook === \"callback\") return handleCallbackRequest;\n    switch(action){\n        case \"upload\":\n            return handleUploadAction;\n        case \"multipart-complete\":\n            return handleMultipartCompleteAction;\n        case \"failure\":\n            return handleMultipartFailureAction;\n    }\n}), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.map((output)=>({\n        success: true,\n        ...output\n    })));\nconst buildRequestHandler = (opts, adapter)=>(input)=>handleRequest.pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.provideServiceEffect(RequestInput, parseAndValidateRequest(input, opts, adapter)), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTags({\n            FetchError: (e)=>new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: typeof e.error === \"string\" ? e.error : e.message,\n                    cause: e,\n                    data: e.data\n                }),\n            ParseError: (e)=>new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: \"An error occured while parsing input/output\",\n                    cause: e\n                })\n        }), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tapError((e)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(e.message)));\nconst handleCallbackRequest = effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n    const { req, uploadable, apiKey } = yield* RequestInput;\n    const verified = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tryPromise({\n        try: async ()=>(0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.verifySignature)(await req.clone().text(), req.headers.get(\"x-uploadthing-signature\"), apiKey),\n        catch: ()=>new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Invalid signature\"\n            })\n    });\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Signature verified:\", verified);\n    if (!verified) {\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"Invalid signature\");\n        return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n            code: \"BAD_REQUEST\",\n            message: \"Invalid signature\"\n        });\n    }\n    const requestInput = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.parseRequestJson)(req, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n        status: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n        file: UploadedFileDataSchema,\n        metadata: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Record(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String, _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Unknown)\n    }));\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Handling callback request with input:\", requestInput);\n    const serverData = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tryPromise({\n        try: async ()=>uploadable.resolver({\n                file: requestInput.file,\n                metadata: requestInput.metadata\n            }),\n        catch: (error)=>new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"INTERNAL_SERVER_ERROR\",\n                message: \"Failed to run onUploadComplete\",\n                cause: error\n            })\n    }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tapError((error)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"Failed to run onUploadComplete. You probably shouldn't be throwing errors here.\", error)));\n    const payload = {\n        fileKey: requestInput.file.key,\n        callbackData: serverData ?? null\n    };\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"'onUploadComplete' callback finished. Sending response to UploadThing:\", payload);\n    yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateUploadThingURL)(\"/api/serverCallback\"), ServerCallbackPostResponseSchema, {\n        method: \"POST\",\n        body: JSON.stringify(payload),\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    });\n    return {\n        body: null\n    };\n});\nconst runRouteMiddleware = (opts)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n        const { uploadable, middlewareArgs } = yield* RequestInput;\n        const { files, input } = opts;\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Running middleware\");\n        const metadata = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tryPromise({\n            try: async ()=>uploadable._def.middleware({\n                    ...middlewareArgs,\n                    input,\n                    files\n                }),\n            catch: (error)=>error instanceof _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError ? error : new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"INTERNAL_SERVER_ERROR\",\n                    message: \"Failed to run middleware\",\n                    cause: error\n                })\n        }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tapError((error)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"An error occured in your middleware function\", error)));\n        if (metadata[uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_2__.UTFiles] && metadata[uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_2__.UTFiles].length !== files.length) {\n            const msg = `Expected files override to have the same length as original files, got ${metadata[uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_2__.UTFiles].length} but expected ${files.length}`;\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(msg);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Files override must have the same length as files\",\n                cause: msg\n            });\n        }\n        // Attach customIds from middleware to the files\n        const filesWithCustomIds = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.forEach(files, (file, idx)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n                const theirs = metadata[uploadthing_internal_types__WEBPACK_IMPORTED_MODULE_2__.UTFiles]?.[idx];\n                if (theirs && theirs.size !== file.size) {\n                    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logWarning(\"File size mismatch. Reverting to original size\");\n                }\n                return {\n                    name: theirs?.name ?? file.name,\n                    size: file.size,\n                    customId: theirs?.customId\n                };\n            }));\n        return {\n            metadata,\n            filesWithCustomIds\n        };\n    });\nconst handleUploadAction = effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n    const opts = yield* RequestInput;\n    const { files, input } = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.parseRequestJson)(opts.req, UploadActionPayload);\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Handling upload request with input:\", {\n        files,\n        input\n    });\n    // validate the input\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Parsing user input\");\n    const inputParser = opts.uploadable._def.inputParser;\n    const parsedInput = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tryPromise({\n        try: async ()=>getParseFn(inputParser)(input),\n        catch: (error)=>new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"BAD_REQUEST\",\n                message: \"Invalid input\",\n                cause: error\n            })\n    }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tapError((error)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"An error occured trying to parse input\", error)));\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Input parsed successfully\", parsedInput);\n    const { metadata, filesWithCustomIds } = yield* runRouteMiddleware({\n        input: parsedInput,\n        files\n    });\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Parsing route config\", opts.uploadable._def.routerConfig);\n    const parsedConfig = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fillInputRouteConfig)(opts.uploadable._def.routerConfig).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTag(\"InvalidRouteConfig\", (err)=>new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n            code: \"BAD_REQUEST\",\n            message: \"Invalid config\",\n            cause: err\n        })));\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Route config parsed successfully\", parsedConfig);\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Validating files meet the config requirements\", files);\n    yield* assertFilesMeetConfig(files, parsedConfig).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchAll((e)=>new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n            code: \"BAD_REQUEST\",\n            message: `Invalid config: ${e._tag}`,\n            cause: \"reason\" in e ? e.reason : e.message\n        })));\n    const callbackUrl = yield* resolveCallbackUrl.pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tapError((error)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"Failed to resolve callback URL\", error)), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTag(\"InvalidURL\", (err)=>new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n            code: \"INTERNAL_SERVER_ERROR\",\n            message: err.message\n        })));\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Retrieving presigned URLs from UploadThing. Callback URL is:\", callbackUrl.href);\n    const presignedUrls = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateUploadThingURL)(\"/api/prepareUpload\"), PresignedURLResponseSchema, {\n        method: \"POST\",\n        body: JSON.stringify({\n            files: filesWithCustomIds,\n            routeConfig: parsedConfig,\n            metadata,\n            callbackUrl: callbackUrl.origin + callbackUrl.pathname,\n            callbackSlug: opts.slug\n        }),\n        headers: {\n            \"Content-Type\": \"application/json\"\n        }\n    });\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"UploadThing responded with:\", presignedUrls);\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Sending presigned URLs to client\");\n    let promise = undefined;\n    if (opts.isDev) {\n        const fetchContext = yield* _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.FetchContext;\n        promise = effect_Effect__WEBPACK_IMPORTED_MODULE_5__.forEach(presignedUrls, (file)=>conditionalDevServer(file.key, opts.apiKey), {\n            concurrency: 10\n        }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.provide(ConsolaLogger), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.provideService(_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.FetchContext, fetchContext), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.runPromise);\n    }\n    return {\n        body: presignedUrls,\n        cleanup: promise\n    };\n});\nconst handleMultipartCompleteAction = effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n    const opts = yield* RequestInput;\n    const requestInput = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.parseRequestJson)(opts.req, MultipartCompleteActionPayload);\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Handling multipart-complete request with input:\", requestInput);\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Notifying UploadThing that multipart upload is complete\");\n    const completionResponse = yield* completeMultipartUpload({\n        key: requestInput.fileKey,\n        uploadId: requestInput.uploadId\n    }, requestInput.etags);\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"UploadThing responded with:\", completionResponse);\n    return {\n        body: null\n    };\n});\nconst handleMultipartFailureAction = effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n    const { req, uploadable } = yield* RequestInput;\n    const { fileKey, uploadId } = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.parseRequestJson)(req, FailureActionPayload);\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Handling failure request with input:\", {\n        fileKey,\n        uploadId\n    });\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Notifying UploadThing that upload failed\");\n    const failureResponse = yield* abortMultipartUpload({\n        key: fileKey,\n        uploadId\n    });\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"UploadThing responded with:\", failureResponse);\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Running 'onUploadError' callback\");\n    yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__[\"try\"]({\n        try: ()=>{\n            uploadable._def.onUploadError({\n                error: new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"UPLOAD_FAILED\",\n                    message: `Upload failed for ${fileKey}`\n                }),\n                fileKey\n            });\n        },\n        catch: (error)=>new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"INTERNAL_SERVER_ERROR\",\n                message: \"Failed to run onUploadError\",\n                cause: error\n            })\n    }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tapError((error)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"Failed to run onUploadError. You probably shouldn't be throwing errors here.\", error)));\n    return {\n        body: null\n    };\n});\nconst buildPermissionsInfoHandler = (opts)=>{\n    return ()=>{\n        const permissions = (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.objectKeys)(opts.router).map((slug)=>{\n            const route = opts.router[slug];\n            const config = effect_Effect__WEBPACK_IMPORTED_MODULE_5__.runSync((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fillInputRouteConfig)(route._def.routerConfig));\n            return {\n                slug,\n                config\n            };\n        });\n        return permissions;\n    };\n};\nfunction incompatibleNodeGuard() {\n    if (typeof std_env__WEBPACK_IMPORTED_MODULE_6__.process === \"undefined\") return;\n    let major;\n    let minor;\n    const maybeNodeVersion = std_env__WEBPACK_IMPORTED_MODULE_6__.process.versions?.node?.split(\".\");\n    if (maybeNodeVersion) {\n        [major, minor] = maybeNodeVersion.map((v)=>parseInt(v, 10));\n    }\n    const maybeNodePath = std_env__WEBPACK_IMPORTED_MODULE_6__.process.env?.NODE;\n    if (!major && maybeNodePath) {\n        const nodeVersion = /v(\\d+)\\.(\\d+)\\.(\\d+)/.exec(maybeNodePath)?.[0];\n        if (nodeVersion) {\n            [major, minor] = nodeVersion.substring(1).split(\".\").map((v)=>parseInt(v, 10));\n        }\n    }\n    if (!major || !minor) return;\n    // Require ^18.13.0\n    if (major > 18) return;\n    if (major === 18 && minor >= 13) return;\n    effect_Effect__WEBPACK_IMPORTED_MODULE_5__.runSync(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(`YOU ARE USING A LEGACY (${major}.${minor}) NODE VERSION WHICH ISN'T OFFICIALLY SUPPORTED. PLEASE UPGRADE TO NODE ^18.13.`));\n    // Kill the process if it isn't going to work correctly anyway\n    // If we've gotten this far we know we have a Node.js runtime so exit is defined. Override std-env type.\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access, @typescript-eslint/no-unsafe-call\n    std_env__WEBPACK_IMPORTED_MODULE_6__.process.exit?.(1);\n}\nfunction internalCreateBuilder(initDef = {}) {\n    const _def = {\n        // Default router config\n        routerConfig: {\n            image: {\n                maxFileSize: \"4MB\"\n            }\n        },\n        inputParser: {\n            parse: ()=>undefined,\n            _input: undefined,\n            _output: undefined\n        },\n        middleware: ()=>({}),\n        onUploadError: ()=>({}),\n        errorFormatter: initDef.errorFormatter ?? defaultErrorFormatter,\n        // Overload with properties passed in\n        ...initDef\n    };\n    return {\n        input (userParser) {\n            return internalCreateBuilder({\n                ..._def,\n                inputParser: userParser\n            });\n        },\n        middleware (userMiddleware) {\n            return internalCreateBuilder({\n                ..._def,\n                middleware: userMiddleware\n            });\n        },\n        onUploadComplete (userUploadComplete) {\n            return {\n                _def,\n                resolver: userUploadComplete\n            };\n        },\n        onUploadError (userOnUploadError) {\n            return internalCreateBuilder({\n                ..._def,\n                onUploadError: userOnUploadError\n            });\n        }\n    };\n}\nfunction createBuilder(opts) {\n    return (input)=>{\n        return internalCreateBuilder({\n            routerConfig: input,\n            ...opts\n        });\n    };\n}\n/**\n * Extension of the Blob class that simplifies setting the `name` and `customId` properties,\n * similar to the built-in File class from Node > 20.\n */ class UTFile extends Blob {\n    constructor(parts, name, options){\n        const optionsWithDefaults = {\n            ...options,\n            type: options?.type ?? ((0,_uploadthing_mime_types__WEBPACK_IMPORTED_MODULE_3__.lookup)(name) || \"application/octet-stream\"),\n            lastModified: options?.lastModified ?? Date.now()\n        };\n        super(parts, optionsWithDefaults);\n        this.name = name;\n        this.customId = optionsWithDefaults.customId;\n        this.lastModified = optionsWithDefaults.lastModified;\n    }\n}\nconst uploadPresignedPost = (file, presigned)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(`Uploading file ${file.name} using presigned POST URL`);\n        const formData = new FormData();\n        Object.entries(presigned.fields).forEach(([k, v])=>formData.append(k, v));\n        formData.append(\"file\", file); // File data **MUST GO LAST**\n        const res = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEff)(presigned.url, {\n            method: \"POST\",\n            body: formData,\n            headers: new Headers({\n                Accept: \"application/xml\"\n            })\n        }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tapErrorCause(()=>(0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateUploadThingURL)(\"/api/failureCallback\"), FailureCallbackResponseSchema, {\n                method: \"POST\",\n                body: JSON.stringify({\n                    fileKey: presigned.key,\n                    uploadId: null\n                }),\n                headers: {\n                    \"Content-Type\": \"application/json\"\n                }\n            })));\n        if (!res.ok) {\n            const text = yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.promise(res.text);\n            yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(`Failed to upload file ${file.name} to presigned POST URL. Response: ${text}`);\n            return yield* new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                code: \"UPLOAD_FAILED\",\n                message: \"Failed to upload file\",\n                cause: text\n            });\n        }\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"File\", file.name, \"uploaded successfully\");\n    });\nfunction guardServerOnly() {\n    if (false) {}\n}\nconst uploadFilesInternal = (input)=>getPresignedUrls(input).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen((presigneds)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.forEach(presigneds, (file)=>uploadFile(file).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.match({\n                onFailure: (error)=>({\n                        data: null,\n                        error: _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError.toObject(error instanceof _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError ? error : new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                            message: \"Failed to upload file.\",\n                            code: \"BAD_REQUEST\",\n                            cause: error\n                        }))\n                    }),\n                onSuccess: (data)=>({\n                        data,\n                        error: null\n                    })\n            })), {\n            concurrency: 10\n        })));\n/**\n * FIXME: downloading everything into memory and then upload\n * isn't the best. We should support streams so we can download\n * just as much as we need at any time.\n */ const downloadFiles = (urls, downloadErrors)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.forEach(urls, (_url, idx)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n            let url = (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.isObject)(_url) ? _url.url : _url;\n            if (typeof url === \"string\") {\n                // since dataurls will result in name being too long, tell the user\n                // to use uploadFiles instead.\n                if (url.startsWith(\"data:\")) {\n                    downloadErrors[idx] = _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError.toObject(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                        code: \"BAD_REQUEST\",\n                        message: \"Please use uploadFiles() for data URLs. uploadFilesFromUrl() is intended for use with remote URLs only.\"\n                    }));\n                    return null;\n                }\n            }\n            url = new URL(url);\n            const { name = url.pathname.split(\"/\").pop() ?? \"unknown-filename\", customId = undefined } = (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.isObject)(_url) ? _url : {};\n            const response = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEff)(url);\n            if (!response.ok) {\n                downloadErrors[idx] = _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError.toObject(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"Failed to download requested file.\",\n                    cause: response\n                }));\n                return undefined;\n            }\n            return yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.promise(()=>response.blob()).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen((blob)=>new UTFile([\n                    blob\n                ], name, {\n                    customId\n                })));\n        }), {\n        concurrency: 10\n    });\nconst getPresignedUrls = (input)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n        const { files, metadata, contentDisposition, acl } = input;\n        const fileData = files.map((file)=>({\n                name: file.name ?? \"unnamed-blob\",\n                type: file.type,\n                size: file.size,\n                ...\"customId\" in file ? {\n                    customId: file.customId\n                } : {}\n            }));\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Getting presigned URLs for files\", fileData);\n        const responseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n            data: PresignedURLResponseSchema\n        });\n        const presigneds = yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateUploadThingURL)(\"/api/uploadFiles\"), responseSchema, {\n            method: \"POST\",\n            cache: \"no-store\",\n            body: JSON.stringify({\n                files: fileData,\n                metadata,\n                contentDisposition,\n                acl\n            }),\n            headers: {\n                \"Content-Type\": \"application/json\"\n            }\n        }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTag(\"ParseError\", (e)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.die(e)), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTag(\"FetchError\", (e)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.die(e)));\n        yield* effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Got presigned URLs:\", presigneds.data);\n        return files.map((file, i)=>({\n                file,\n                presigned: presigneds.data[i]\n            }));\n    });\nconst uploadFile = (input)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.gen(function*() {\n        const { file, presigned } = input;\n        if (\"urls\" in presigned) {\n            yield* uploadMultipart(file, presigned);\n        } else {\n            yield* uploadPresignedPost(file, presigned);\n        }\n        yield* (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateUploadThingURL)(`/api/pollUpload/${presigned.key}`), PollUploadResponseSchema).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tap(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Polled upload\", presigned.key)), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen((res)=>res.status === \"done\" ? effect_Effect__WEBPACK_IMPORTED_MODULE_5__.succeed(undefined) : effect_Effect__WEBPACK_IMPORTED_MODULE_5__.fail(new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError())), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.retry({\n            while: (err)=>err instanceof _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.RetryError,\n            schedule: _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.exponentialBackoff\n        }), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTag(\"RetryError\", (e)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.die(e)));\n        return {\n            key: presigned.key,\n            url: presigned.fileUrl,\n            name: file.name,\n            size: file.size,\n            type: file.type,\n            customId: \"customId\" in file ? file.customId ?? null : null\n        };\n    });\nfunction parseTimeToSeconds(time) {\n    const match = time.toString().split(/(\\d+)/).filter(Boolean);\n    const num = Number(match[0]);\n    const unit = (match[1] ?? \"s\").trim().slice(0, 1);\n    const multiplier = {\n        s: 1,\n        m: 60,\n        h: 3600,\n        d: 86400\n    }[unit];\n    return num * multiplier;\n}\nclass UTApi {\n    constructor(opts){\n        this.requestUploadThing = (pathname, body, responseSchema)=>{\n            const url = (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.generateUploadThingURL)(pathname);\n            effect_Effect__WEBPACK_IMPORTED_MODULE_5__.runSync(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Requesting UploadThing:\", {\n                url,\n                body,\n                headers: this.defaultHeaders\n            }));\n            return (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.fetchEffJson)(url, responseSchema, {\n                method: \"POST\",\n                cache: \"no-store\",\n                body: JSON.stringify(body),\n                headers: {\n                    ...(0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.filterObjectValues)(this.defaultHeaders, (v)=>typeof v === \"string\"),\n                    \"Content-Type\": \"application/json\"\n                }\n            }).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTag(\"FetchError\", (err)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"Request failed:\", err).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen(()=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.die(err)))), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.catchTag(\"ParseError\", (err)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logError(\"Response parsing failed:\", err).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen(()=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.die(err)))), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.tap((res)=>effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"UploadThing response:\", res)));\n        };\n        this.executeAsync = (program)=>program.pipe(withMinimalLogLevel(this.logLevel), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.provide(ConsolaLogger), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.provideService(_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.FetchContext, {\n                fetch: this.fetch,\n                baseHeaders: this.defaultHeaders\n            }), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.runPromise);\n        /**\n   * Request to delete files from UploadThing storage.\n   * @param {string | string[]} fileKeys\n   *\n   * @example\n   * await deleteFiles(\"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\");\n   *\n   * @example\n   * await deleteFiles([\"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\",\"1649353b-04ea-48a2-9db7-31de7f562c8d_image2.jpg\"])\n   *\n   * @example\n   * await deleteFiles(\"myCustomIdentifier\", { keyType: \"customId\" })\n   */ this.deleteFiles = async (keys, opts)=>{\n            guardServerOnly();\n            const { keyType = this.defaultKeyType } = opts ?? {};\n            const responseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n                success: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Boolean\n            });\n            return await this.executeAsync(this.requestUploadThing(\"/api/deleteFiles\", keyType === \"fileKey\" ? {\n                fileKeys: (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.asArray)(keys)\n            } : {\n                customIds: (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.asArray)(keys)\n            }, responseSchema));\n        };\n        /**\n   * Request file URLs from UploadThing storage.\n   * @param {string | string[]} fileKeys\n   *\n   * @example\n   * const data = await getFileUrls(\"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\");\n   * console.log(data); // [{key: \"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\", url: \"https://uploadthing.com/f/2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\"}]\n   *\n   * @example\n   * const data = await getFileUrls([\"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\",\"1649353b-04ea-48a2-9db7-31de7f562c8d_image2.jpg\"])\n   * console.log(data) // [{key: \"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\", url: \"https://uploadthing.com/f/2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\" },{key: \"1649353b-04ea-48a2-9db7-31de7f562c8d_image2.jpg\", url: \"https://uploadthing.com/f/1649353b-04ea-48a2-9db7-31de7f562c8d_image2.jpg\"}]\n   */ this.getFileUrls = async (keys, opts)=>{\n            guardServerOnly();\n            const { keyType = this.defaultKeyType } = opts ?? {};\n            const responseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n                data: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Array(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n                    key: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n                    url: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n                }))\n            });\n            return await this.executeAsync(this.requestUploadThing(\"/api/getFileUrl\", keyType === \"fileKey\" ? {\n                fileKeys: keys\n            } : {\n                customIds: keys\n            }, responseSchema));\n        };\n        /**\n   * Request file list from UploadThing storage.\n   * @param {object} opts\n   * @param {number} opts.limit The maximum number of files to return\n   * @param {number} opts.offset The number of files to skip\n   *\n   * @example\n   * const data = await listFiles({ limit: 1 });\n   * console.log(data); // { key: \"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\", id: \"2e0fdb64-9957-4262-8e45-f372ba903ac8\" }\n   */ this.listFiles = async (opts)=>{\n            guardServerOnly();\n            const responseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n                files: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Array(_effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n                    id: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n                    key: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n                    name: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n                    status: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Literal(\"Deletion Pending\", \"Failed\", \"Uploaded\", \"Uploading\")\n                }))\n            });\n            return await this.executeAsync(this.requestUploadThing(\"/api/listFiles\", {\n                ...opts\n            }, responseSchema));\n        };\n        this.renameFiles = async (updates)=>{\n            guardServerOnly();\n            const responseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n                success: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Boolean\n            });\n            return await this.executeAsync(this.requestUploadThing(\"/api/renameFiles\", {\n                updates: (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.asArray)(updates)\n            }, responseSchema));\n        };\n        /** @deprecated Use {@link renameFiles} instead. */ this.renameFile = this.renameFiles;\n        this.getUsageInfo = async ()=>{\n            guardServerOnly();\n            const responseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n                totalBytes: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number,\n                totalReadable: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n                appTotalBytes: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number,\n                appTotalReadable: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String,\n                filesUploaded: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number,\n                limitBytes: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Number,\n                limitReadable: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n            });\n            return await this.executeAsync(this.requestUploadThing(\"/api/getUsageInfo\", {}, responseSchema));\n        };\n        /** Request a presigned url for a private file(s) */ this.getSignedURL = async (key, opts)=>{\n            guardServerOnly();\n            const expiresIn = opts?.expiresIn ? parseTimeToSeconds(opts.expiresIn) : undefined;\n            const { keyType = this.defaultKeyType } = opts ?? {};\n            if (opts?.expiresIn && isNaN(expiresIn)) {\n                throw new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"expiresIn must be a valid time string, for example '1d', '2 days', or a number of seconds.\"\n                });\n            }\n            if (expiresIn && expiresIn > 86400 * 7) {\n                throw new _uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.UploadThingError({\n                    code: \"BAD_REQUEST\",\n                    message: \"expiresIn must be less than 7 days (604800 seconds).\"\n                });\n            }\n            const responseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n                url: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.String\n            });\n            return await this.executeAsync(this.requestUploadThing(\"/api/requestFileAccess\", keyType === \"fileKey\" ? {\n                fileKey: key,\n                expiresIn\n            } : {\n                customId: key,\n                expiresIn\n            }, responseSchema));\n        };\n        /**\n   * Update the ACL of a file or set of files.\n   *\n   * @example\n   * // Make a single file public\n   * await utapi.updateACL(\"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\", \"public-read\");\n   *\n   * // Make multiple files private\n   * await utapi.updateACL(\n   *   [\n   *     \"2e0fdb64-9957-4262-8e45-f372ba903ac8_image.jpg\",\n   *     \"1649353b-04ea-48a2-9db7-31de7f562c8d_image2.jpg\",\n   *   ],\n   *   \"private\",\n   * );\n   */ this.updateACL = async (keys, acl, opts)=>{\n            guardServerOnly();\n            const { keyType = this.defaultKeyType } = opts ?? {};\n            const updates = (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.asArray)(keys).map((key)=>{\n                return keyType === \"fileKey\" ? {\n                    fileKey: key,\n                    acl\n                } : {\n                    customId: key,\n                    acl\n                };\n            });\n            const responseSchema = _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Struct({\n                success: _effect_schema_Schema__WEBPACK_IMPORTED_MODULE_4__.Boolean\n            });\n            return await this.executeAsync(this.requestUploadThing(\"/api/updateACL\", {\n                updates\n            }, responseSchema));\n        };\n        // Assert some stuff\n        guardServerOnly();\n        incompatibleNodeGuard();\n        const apiKey = getApiKeyOrThrow(opts?.apiKey);\n        this.fetch = opts?.fetch ?? globalThis.fetch;\n        this.defaultHeaders = {\n            \"x-uploadthing-api-key\": apiKey,\n            \"x-uploadthing-version\": version,\n            \"x-uploadthing-be-adapter\": \"server-sdk\",\n            \"x-uploadthing-fe-package\": undefined\n        };\n        this.defaultKeyType = opts?.defaultKeyType ?? \"fileKey\";\n        this.logLevel = opts?.logLevel;\n    }\n    async uploadFiles(files, opts) {\n        guardServerOnly();\n        const uploads = await this.executeAsync(uploadFilesInternal({\n            files: (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.asArray)(files),\n            contentDisposition: opts?.contentDisposition ?? \"inline\",\n            metadata: opts?.metadata ?? {},\n            acl: opts?.acl\n        }));\n        const uploadFileResponse = Array.isArray(files) ? uploads : uploads[0];\n        effect_Effect__WEBPACK_IMPORTED_MODULE_5__.runSync(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Finished uploading:\", uploadFileResponse));\n        return uploadFileResponse;\n    }\n    async uploadFilesFromUrl(urls, opts) {\n        guardServerOnly();\n        const downloadErrors = {};\n        const uploads = await this.executeAsync(downloadFiles((0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.asArray)(urls), downloadErrors).pipe(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen((files)=>files.filter((f)=>f != null)), effect_Effect__WEBPACK_IMPORTED_MODULE_5__.andThen((files)=>uploadFilesInternal({\n                files,\n                contentDisposition: opts?.contentDisposition ?? \"inline\",\n                metadata: opts?.metadata ?? {},\n                acl: opts?.acl\n            }))));\n        /** Put it all back together, preserve the order of files */ const responses = (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.asArray)(urls).map((_, index)=>{\n            if (downloadErrors[index]) {\n                return {\n                    data: null,\n                    error: downloadErrors[index]\n                };\n            }\n            return uploads.shift();\n        });\n        /** Return single object or array based on input urls */ const uploadFileResponse = Array.isArray(urls) ? responses : responses[0];\n        effect_Effect__WEBPACK_IMPORTED_MODULE_5__.runSync(effect_Effect__WEBPACK_IMPORTED_MODULE_5__.logDebug(\"Finished uploading:\", uploadFileResponse));\n        return uploadFileResponse;\n    }\n}\nconst createUploadthing = (opts)=>createBuilder(opts);\n/** @internal */ const INTERNAL_DO_NOT_USE_createRouteHandlerCore = (opts, adapter)=>{\n    incompatibleNodeGuard();\n    const requestHandler = buildRequestHandler(opts, adapter);\n    const getBuildPerms = buildPermissionsInfoHandler(opts);\n    const POST = async (request)=>{\n        const req = request instanceof Request ? request : request.request;\n        const response = await runRequestHandlerAsync(requestHandler, {\n            req,\n            middlewareArgs: {\n                req,\n                event: undefined,\n                res: undefined\n            }\n        }, opts.config);\n        if (response.success === false) {\n            return Response.json(formatError(response.error, opts.router), {\n                status: (0,_uploadthing_shared__WEBPACK_IMPORTED_MODULE_0__.getStatusCodeFromError)(response.error),\n                headers: {\n                    \"x-uploadthing-version\": version\n                }\n            });\n        }\n        const res = Response.json(response.body, {\n            headers: {\n                \"x-uploadthing-version\": version\n            }\n        });\n        // @ts-expect-error - this is a custom property\n        res.cleanup = response.cleanup;\n        return res;\n    };\n    const GET = (request)=>{\n        return Response.json(getBuildPerms(), {\n            headers: {\n                \"x-uploadthing-version\": version\n            }\n        });\n    };\n    return {\n        GET,\n        POST\n    };\n};\nconst createRouteHandler = (opts)=>INTERNAL_DO_NOT_USE_createRouteHandlerCore(opts, \"server\");\nconst extractRouterConfig = (router)=>buildPermissionsInfoHandler({\n        router\n    })();\n/**\n * @deprecated Use {@link createRouteHandler} instead\n */ const createServerHandler = createRouteHandler;\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvdXBsb2FkdGhpbmcvc2VydmVyL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQW1iO0FBQzVYO0FBQ1o7QUFDSDtBQUNLO0FBQ0w7QUFDVTtBQUNEO0FBQ1A7QUFDQTtBQUNnRjtBQUNyRTtBQUNKO0FBRWpELElBQUlzQyxVQUFVO0FBRWQsU0FBU0Msc0JBQXNCQyxLQUFLO0lBQ2hDLE9BQU87UUFDSEMsU0FBU0QsTUFBTUMsT0FBTztJQUMxQjtBQUNKO0FBQ0EsU0FBU0MsWUFBWUYsS0FBSyxFQUFFRyxNQUFNO0lBQzlCLE1BQU1DLGlCQUFpQkQsTUFBTSxDQUFDRSxPQUFPQyxJQUFJLENBQUNILE9BQU8sQ0FBQyxFQUFFLENBQUMsRUFBRUksS0FBS0gsa0JBQWtCTDtJQUM5RSwrREFBK0Q7SUFDL0QsT0FBT0ssZUFBZUo7QUFDMUI7QUFFQTs7OztDQUlDLEdBQUcsTUFBTVEsdUJBQXVCekIseURBQVEsQ0FBQztJQUN0QzJCLE1BQU0zQix5REFBUTtJQUNkNkIsTUFBTTdCLHlEQUFRO0lBQ2QrQixNQUFNL0IseURBQVE7QUFDbEI7QUFDQSxNQUFNZ0MsbUNBQW1DaEMseURBQVEsQ0FBQ3lCLHNCQUFzQnpCLHlEQUFRLENBQUM7SUFDN0VrQyxVQUFVbEMseURBQVEsQ0FBQ0EseURBQVE7QUFDL0I7QUFDQSxNQUFNb0MseUJBQXlCcEMseURBQVEsQ0FBQ2dDLGtDQUFrQ2hDLHlEQUFRLENBQUM7SUFDL0VxQyxLQUFLckMseURBQVE7SUFDYnNDLEtBQUt0Qyx5REFBUTtBQUNqQjtBQUNBOzs7O0NBSUMsR0FBRyxNQUFNdUMsc0JBQXNCdkMseURBQVEsQ0FBQztJQUNyQ3FDLEtBQUtyQyx5REFBUTtJQUNid0MsVUFBVXhDLHlEQUFRO0lBQ2xCeUMsVUFBVXpDLHlEQUFRO0lBQ2xCMEMsU0FBUzFDLHlEQUFRO0lBQ2pCMkMsWUFBWTNDLHlEQUFRO0lBQ3BCNEMsWUFBWTVDLHlEQUFRO0lBQ3BC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LFNBQVNxQyxJQUFJLEVBQUU7WUFDckNuQyxTQUFTO2dCQUNMLHlCQUF5Qm5FO1lBQzdCO1FBQ0o7UUFDQSwrQ0FBK0M7UUFDL0MyRSxJQUFJMk0sT0FBTyxHQUFHck4sU0FBU3FOLE9BQU87UUFDOUIsT0FBTzNNO0lBQ1g7SUFDQSxNQUFNMFUsTUFBTSxDQUFDSjtRQUNULE9BQU8xUyxTQUFTNlMsSUFBSSxDQUFDTCxpQkFBaUI7WUFDbEM1VSxTQUFTO2dCQUNMLHlCQUF5Qm5FO1lBQzdCO1FBQ0o7SUFDSjtJQUNBLE9BQU87UUFDSHFaO1FBQ0FMO0lBQ0o7QUFDSjtBQUNBLE1BQU1NLHFCQUFxQixDQUFDeE8sT0FBTytOLDJDQUEyQy9OLE1BQU07QUFDcEYsTUFBTXlPLHNCQUFzQixDQUFDbFosU0FBU3FSLDRCQUE0QjtRQUMxRHJSO0lBQ0o7QUFDSjs7Q0FFQyxHQUFHLE1BQU1tWixzQkFBc0JGO0FBRXNIIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZXZlbnRseS8uL25vZGVfbW9kdWxlcy91cGxvYWR0aGluZy9zZXJ2ZXIvaW5kZXguanM/ZWI2NCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBDb250ZW50RGlzcG9zaXRpb25TY2hlbWEsIGZldGNoRWZmSnNvbiwgZ2VuZXJhdGVVcGxvYWRUaGluZ1VSTCwgUmV0cnlFcnJvciwgZXhwb25lbnRpYWxCYWNrb2ZmLCBVcGxvYWRUaGluZ0Vycm9yLCBzaWduUGF5bG9hZCwgZmV0Y2hFZmYsIGlzT2JqZWN0LCBjb250ZW50RGlzcG9zaXRpb24sIGJ5dGVzVG9GaWxlU2l6ZSwgZ2V0VHlwZUZyb21GaWxlTmFtZSwgb2JqZWN0S2V5cywgSW52YWxpZFJvdXRlQ29uZmlnRXJyb3IsIGZpbGVTaXplVG9CeXRlcywgRmV0Y2hDb250ZXh0LCBnZXRGdWxsQXBpVXJsLCB2ZXJpZnlTaWduYXR1cmUsIHBhcnNlUmVxdWVzdEpzb24sIGZpbGxJbnB1dFJvdXRlQ29uZmlnLCBmaWx0ZXJPYmplY3RWYWx1ZXMsIGFzQXJyYXksIGdldFN0YXR1c0NvZGVGcm9tRXJyb3IgfSBmcm9tICdAdXBsb2FkdGhpbmcvc2hhcmVkJztcbmV4cG9ydCB7IFVwbG9hZFRoaW5nRXJyb3IgfSBmcm9tICdAdXBsb2FkdGhpbmcvc2hhcmVkJztcbmltcG9ydCAqIGFzIFMgZnJvbSAnQGVmZmVjdC9zY2hlbWEvU2NoZW1hJztcbmltcG9ydCAqIGFzIEVmZmVjdCBmcm9tICdlZmZlY3QvRWZmZWN0JztcbmltcG9ydCB7IGNyZWF0ZUNvbnNvbGEgfSBmcm9tICdjb25zb2xhL2NvcmUnO1xuaW1wb3J0ICogYXMgTG9nZ2VyIGZyb20gJ2VmZmVjdC9Mb2dnZXInO1xuaW1wb3J0ICogYXMgRWZmZWN0TG9nTGV2ZWwgZnJvbSAnZWZmZWN0L0xvZ0xldmVsJztcbmltcG9ydCB7IHByb2Nlc3MsIGlzRGV2ZWxvcG1lbnQgfSBmcm9tICdzdGQtZW52JztcbmltcG9ydCAqIGFzIENvbnRleHQgZnJvbSAnZWZmZWN0L0NvbnRleHQnO1xuaW1wb3J0IHsgVGFnZ2VkRXJyb3IgfSBmcm9tICdlZmZlY3QvRGF0YSc7XG5pbXBvcnQgeyBpc0FjdGlvblR5cGUsIFZBTElEX0FDVElPTl9UWVBFUywgaXNVcGxvYWRUaGluZ0hvb2ssIFZBTElEX1VUX0hPT0tTLCBVVEZpbGVzIH0gZnJvbSAndXBsb2FkdGhpbmcvaW50ZXJuYWwvdHlwZXMnO1xuZXhwb3J0IHsgVVRGaWxlcyB9IGZyb20gJ3VwbG9hZHRoaW5nL2ludGVybmFsL3R5cGVzJztcbmltcG9ydCB7IGxvb2t1cCB9IGZyb20gJ0B1cGxvYWR0aGluZy9taW1lLXR5cGVzJztcblxudmFyIHZlcnNpb24gPSBcIjYuMTAuMVwiO1xuXG5mdW5jdGlvbiBkZWZhdWx0RXJyb3JGb3JtYXR0ZXIoZXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlXG4gICAgfTtcbn1cbmZ1bmN0aW9uIGZvcm1hdEVycm9yKGVycm9yLCByb3V0ZXIpIHtcbiAgICBjb25zdCBlcnJvckZvcm1hdHRlciA9IHJvdXRlcltPYmplY3Qua2V5cyhyb3V0ZXIpWzBdXT8uX2RlZi5lcnJvckZvcm1hdHRlciA/PyBkZWZhdWx0RXJyb3JGb3JtYXR0ZXI7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtcmV0dXJuXG4gICAgcmV0dXJuIGVycm9yRm9ybWF0dGVyKGVycm9yKTtcbn1cblxuLyoqXG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogPT09PT09PT09PT09PT09PT09PT09PT09IEZpbGUgVHlwZSBIaWVyYXJjaHkgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqLyBjb25zdCBGaWxlVXBsb2FkRGF0YVNjaGVtYSA9IFMuU3RydWN0KHtcbiAgICBuYW1lOiBTLlN0cmluZyxcbiAgICBzaXplOiBTLk51bWJlcixcbiAgICB0eXBlOiBTLlN0cmluZ1xufSk7XG5jb25zdCBGaWxlVXBsb2FkRGF0YVdpdGhDdXN0b21JZFNjaGVtYSA9IFMuZXh0ZW5kKEZpbGVVcGxvYWREYXRhU2NoZW1hLCBTLlN0cnVjdCh7XG4gICAgY3VzdG9tSWQ6IFMuTnVsbE9yKFMuU3RyaW5nKVxufSkpO1xuY29uc3QgVXBsb2FkZWRGaWxlRGF0YVNjaGVtYSA9IFMuZXh0ZW5kKEZpbGVVcGxvYWREYXRhV2l0aEN1c3RvbUlkU2NoZW1hLCBTLlN0cnVjdCh7XG4gICAga2V5OiBTLlN0cmluZyxcbiAgICB1cmw6IFMuU3RyaW5nXG59KSk7XG4vKipcbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKiA9PT09PT09PT09PT09PT09PT09PT09PT0gU2VydmVyIFJlc3BvbnNlIFNjaGVtYXMgPT09PT09PT09PT09PT09PT09PT09PT09PT09PVxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqLyBjb25zdCBQcmVzaWduZWRCYXNlU2NoZW1hID0gUy5TdHJ1Y3Qoe1xuICAgIGtleTogUy5TdHJpbmcsXG4gICAgZmlsZU5hbWU6IFMuU3RyaW5nLFxuICAgIGZpbGVUeXBlOiBTLlN0cmluZyxcbiAgICBmaWxlVXJsOiBTLlN0cmluZyxcbiAgICBwb2xsaW5nSnd0OiBTLlN0cmluZyxcbiAgICBwb2xsaW5nVXJsOiBTLlN0cmluZyxcbiAgICBjb250ZW50RGlzcG9zaXRpb246IENvbnRlbnREaXNwb3NpdGlvblNjaGVtYSxcbiAgICBjdXN0b21JZDogUy5OdWxsT3IoUy5TdHJpbmcpXG59KTtcbmNvbnN0IE1QVVJlc3BvbnNlU2NoZW1hID0gUy5leHRlbmQoUHJlc2lnbmVkQmFzZVNjaGVtYSwgUy5TdHJ1Y3Qoe1xuICAgIHVybHM6IFMuQXJyYXkoUy5TdHJpbmcpLFxuICAgIHVwbG9hZElkOiBTLlN0cmluZyxcbiAgICBjaHVua1NpemU6IFMuTnVtYmVyLFxuICAgIGNodW5rQ291bnQ6IFMuTnVtYmVyXG59KSk7XG5jb25zdCBQU1BSZXNwb25zZVNjaGVtYSA9IFMuZXh0ZW5kKFByZXNpZ25lZEJhc2VTY2hlbWEsIFMuU3RydWN0KHtcbiAgICB1cmw6IFMuU3RyaW5nLFxuICAgIGZpZWxkczogUy5SZWNvcmQoUy5TdHJpbmcsIFMuU3RyaW5nKVxufSkpO1xuY29uc3QgUHJlc2lnbmVkVVJMUmVzcG9uc2VTY2hlbWEgPSBTLkFycmF5KFMuVW5pb24oUFNQUmVzcG9uc2VTY2hlbWEsIE1QVVJlc3BvbnNlU2NoZW1hKSk7XG5jb25zdCBQb2xsVXBsb2FkUmVzcG9uc2VTY2hlbWEgPSBTLlN0cnVjdCh7XG4gICAgc3RhdHVzOiBTLlN0cmluZyxcbiAgICBmaWxlRGF0YTogUy5vcHRpb25hbChTLlN0cnVjdCh7XG4gICAgICAgIGZpbGVLZXk6IFMuTnVsbE9yKFMuU3RyaW5nKSxcbiAgICAgICAgZmlsZU5hbWU6IFMuU3RyaW5nLFxuICAgICAgICBmaWxlU2l6ZTogUy5OdW1iZXIsXG4gICAgICAgIGZpbGVUeXBlOiBTLlN0cmluZyxcbiAgICAgICAgbWV0YWRhdGE6IFMuTnVsbE9yKFMuU3RyaW5nKSxcbiAgICAgICAgY3VzdG9tSWQ6IFMuTnVsbE9yKFMuU3RyaW5nKSxcbiAgICAgICAgY2FsbGJhY2tVcmw6IFMub3B0aW9uYWwoUy5TdHJpbmcpLFxuICAgICAgICBjYWxsYmFja1NsdWc6IFMub3B0aW9uYWwoUy5TdHJpbmcpXG4gICAgfSkpXG59KTtcbmNvbnN0IEZhaWx1cmVDYWxsYmFja1Jlc3BvbnNlU2NoZW1hID0gUy5TdHJ1Y3Qoe1xuICAgIHN1Y2Nlc3M6IFMuQm9vbGVhbixcbiAgICBtZXNzYWdlOiBTLm9wdGlvbmFsKFMuU3RyaW5nKVxufSk7XG5jb25zdCBTZXJ2ZXJDYWxsYmFja1Bvc3RSZXNwb25zZVNjaGVtYSA9IFMuU3RydWN0KHtcbiAgICBzdGF0dXM6IFMuU3RyaW5nXG59KTtcbi8qKlxuICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqID09PT09PT09PT09PT09PT09PT09PT09PSBDbGllbnQgQWN0aW9uIFBheWxvYWRzID09PT09PT09PT09PT09PT09PT09PT09PT09PT1cbiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09XG4gKi8gY29uc3QgVXBsb2FkQWN0aW9uUGF5bG9hZCA9IFMuU3RydWN0KHtcbiAgICBmaWxlczogUy5BcnJheShGaWxlVXBsb2FkRGF0YVNjaGVtYSksXG4gICAgaW5wdXQ6IFMuVW5rbm93blxufSk7XG5jb25zdCBGYWlsdXJlQWN0aW9uUGF5bG9hZCA9IFMuU3RydWN0KHtcbiAgICBmaWxlS2V5OiBTLlN0cmluZyxcbiAgICB1cGxvYWRJZDogUy5OdWxsT3IoUy5TdHJpbmcpLFxuICAgIHN0b3JhZ2VQcm92aWRlckVycm9yOiBTLm9wdGlvbmFsKFMuU3RyaW5nKSxcbiAgICBmaWxlTmFtZTogUy5TdHJpbmdcbn0pO1xuY29uc3QgTXVsdGlwYXJ0Q29tcGxldGVBY3Rpb25QYXlsb2FkID0gUy5TdHJ1Y3Qoe1xuICAgIGZpbGVLZXk6IFMuU3RyaW5nLFxuICAgIHVwbG9hZElkOiBTLlN0cmluZyxcbiAgICBldGFnczogUy5BcnJheShTLlN0cnVjdCh7XG4gICAgICAgIHRhZzogUy5TdHJpbmcsXG4gICAgICAgIHBhcnROdW1iZXI6IFMuTnVtYmVyXG4gICAgfSkpXG59KTtcblxuY29uc3QgaXNWYWxpZFJlc3BvbnNlID0gKHJlc3BvbnNlKT0+e1xuICAgIGlmICghcmVzcG9uc2Uub2spIHJldHVybiBmYWxzZTtcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID49IDQwMCkgcmV0dXJuIGZhbHNlO1xuICAgIGlmICghcmVzcG9uc2UuaGVhZGVycy5oYXMoXCJ4LXVwbG9hZHRoaW5nLXZlcnNpb25cIikpIHJldHVybiBmYWxzZTtcbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5jb25zdCBjb25kaXRpb25hbERldlNlcnZlciA9IChmaWxlS2V5LCBhcGlLZXkpPT57XG4gICAgcmV0dXJuIEVmZmVjdC5nZW4oZnVuY3Rpb24qKCkge1xuICAgICAgICBjb25zdCBmaWxlID0geWllbGQqIGZldGNoRWZmSnNvbihnZW5lcmF0ZVVwbG9hZFRoaW5nVVJMKGAvYXBpL3BvbGxVcGxvYWQvJHtmaWxlS2V5fWApLCBQb2xsVXBsb2FkUmVzcG9uc2VTY2hlbWEpLnBpcGUoRWZmZWN0LmFuZFRoZW4oKHJlcyk9PnJlcy5zdGF0dXMgPT09IFwiZG9uZVwiID8gRWZmZWN0LnN1Y2NlZWQocmVzLmZpbGVEYXRhKSA6IEVmZmVjdC5mYWlsKG5ldyBSZXRyeUVycm9yKCkpKSwgRWZmZWN0LnJldHJ5KHtcbiAgICAgICAgICAgIHdoaWxlOiAoZXJyKT0+ZXJyIGluc3RhbmNlb2YgUmV0cnlFcnJvcixcbiAgICAgICAgICAgIHNjaGVkdWxlOiBleHBvbmVudGlhbEJhY2tvZmZcbiAgICAgICAgfSksIEVmZmVjdC5jYXRjaFRhZyhcIlJldHJ5RXJyb3JcIiwgKGUpPT5FZmZlY3QuZGllKGUpKSk7XG4gICAgICAgIGlmIChmaWxlID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgIHlpZWxkKiBFZmZlY3QubG9nRXJyb3IoYEZhaWxlZCB0byBzaW11bGF0ZSBjYWxsYmFjayBmb3IgZmlsZSAke2ZpbGVLZXl9YCk7XG4gICAgICAgICAgICByZXR1cm4geWllbGQqIG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICBjb2RlOiBcIlVQTE9BRF9GQUlMRURcIixcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkZpbGUgdG9vayB0b28gbG9uZyB0byB1cGxvYWRcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IGNhbGxiYWNrVXJsID0gZmlsZS5jYWxsYmFja1VybCArIGA/c2x1Zz0ke2ZpbGUuY2FsbGJhY2tTbHVnfWA7XG4gICAgICAgIGlmICghY2FsbGJhY2tVcmwuc3RhcnRzV2l0aChcImh0dHBcIikpIGNhbGxiYWNrVXJsID0gXCJodHRwOi8vXCIgKyBjYWxsYmFja1VybDtcbiAgICAgICAgeWllbGQqIEVmZmVjdC5sb2dJbmZvKGBTSU1VTEFUSU5HIEZJTEUgVVBMT0FEIFdFQkhPT0sgQ0FMTEJBQ0tgLCBjYWxsYmFja1VybCk7XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBzdGF0dXM6IFwidXBsb2FkZWRcIixcbiAgICAgICAgICAgIG1ldGFkYXRhOiBKU09OLnBhcnNlKGZpbGUubWV0YWRhdGEgPz8gXCJ7fVwiKSxcbiAgICAgICAgICAgIGZpbGU6IHtcbiAgICAgICAgICAgICAgICB1cmw6IGBodHRwczovL3V0ZnMuaW8vZi8ke2VuY29kZVVSSUNvbXBvbmVudChmaWxlS2V5KX1gLFxuICAgICAgICAgICAgICAgIGtleTogZmlsZUtleSxcbiAgICAgICAgICAgICAgICBuYW1lOiBmaWxlLmZpbGVOYW1lLFxuICAgICAgICAgICAgICAgIHNpemU6IGZpbGUuZmlsZVNpemUsXG4gICAgICAgICAgICAgICAgY3VzdG9tSWQ6IGZpbGUuY3VzdG9tSWQsXG4gICAgICAgICAgICAgICAgdHlwZTogZmlsZS5maWxlVHlwZVxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0geWllbGQqIEVmZmVjdC50cnlQcm9taXNlKHtcbiAgICAgICAgICAgIHRyeTogKCk9PnNpZ25QYXlsb2FkKHBheWxvYWQsIGFwaUtleSksXG4gICAgICAgICAgICBjYXRjaDogKGUpPT5uZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgIGNvZGU6IFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiRmFpbGVkIHRvIHNpZ24gcGF5bG9hZFwiLFxuICAgICAgICAgICAgICAgICAgICBjYXVzZTogZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBjYWxsYmFja1Jlc3BvbnNlID0geWllbGQqIGZldGNoRWZmKGNhbGxiYWNrVXJsLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgYm9keTogcGF5bG9hZCxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgICBcInVwbG9hZHRoaW5nLWhvb2tcIjogXCJjYWxsYmFja1wiLFxuICAgICAgICAgICAgICAgIFwieC11cGxvYWR0aGluZy1zaWduYXR1cmVcIjogc2lnbmF0dXJlXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLnBpcGUoRWZmZWN0LmNhdGNoVGFnKFwiRmV0Y2hFcnJvclwiLCAoKT0+RWZmZWN0LnN1Y2NlZWQobmV3IFJlc3BvbnNlKG51bGwsIHtcbiAgICAgICAgICAgICAgICBzdGF0dXM6IDUwMFxuICAgICAgICAgICAgfSkpKSk7XG4gICAgICAgIGlmIChpc1ZhbGlkUmVzcG9uc2UoY2FsbGJhY2tSZXNwb25zZSkpIHtcbiAgICAgICAgICAgIHlpZWxkKiBFZmZlY3QubG9nSW5mbyhcIlN1Y2Nlc3NmdWxseSBzaW11bGF0ZWQgY2FsbGJhY2sgZm9yIGZpbGVcIiwgZmlsZUtleSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB5aWVsZCogRWZmZWN0LmxvZ0Vycm9yKGBcbkZhaWxlZCB0byBzaW11bGF0ZSBjYWxsYmFjayBmb3IgZmlsZSAnJHtmaWxlLmZpbGVLZXl9Jy4gSXMgeW91ciB3ZWJob29rIGNvbmZpZ3VyZWQgY29ycmVjdGx5P1xuICAtIE1ha2Ugc3VyZSB0aGUgVVJMICcke2NhbGxiYWNrVXJsfScgaXMgYWNjZXNzaWJsZSB3aXRob3V0IGFueSBhdXRoZW50aWNhdGlvbi4gWW91IGNhbiB2ZXJpZnkgdGhpcyBieSBydW5uaW5nICdjdXJsIC1YIFBPU1QgJHtjYWxsYmFja1VybH0nIGluIHlvdXIgdGVybWluYWxcbiAgLSBTdGlsbCBmYWNpbmcgaXNzdWVzPyBSZWFkIGh0dHBzOi8vZG9jcy51cGxvYWR0aGluZy5jb20vZmFxIGZvciBjb21tb24gaXNzdWVzXG5gLnRyaW0oKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpbGU7XG4gICAgfSk7XG59O1xuXG5jb25zdCBjb2xvcml6ZSA9IChzdHIsIGxldmVsKT0+e1xuICAgIC8vIFRPRE86IE1heWJlIGNoZWNrIGlzIHNoZWxsIHN1cHBvcnRzIGNvbG9yc1xuICAgIHN3aXRjaChsZXZlbCl7XG4gICAgICAgIGNhc2UgXCJlcnJvclwiOlxuICAgICAgICBjYXNlIFwiZmF0YWxcIjpcbiAgICAgICAgICAgIHJldHVybiBgXFx4MWJbNDFtXFx4MWJbMzBtJHtzdHJ9XFx4MWJbMG1gO1xuICAgICAgICBjYXNlIFwid2FyblwiOlxuICAgICAgICAgICAgcmV0dXJuIGBcXHgxYls0M21cXHgxYlszMG0ke3N0cn1cXHgxYlswbWA7XG4gICAgICAgIGNhc2UgXCJpbmZvXCI6XG4gICAgICAgIGNhc2UgXCJsb2dcIjpcbiAgICAgICAgICAgIHJldHVybiBgXFx4MWJbNDRtXFx4MWJbMzBtJHtzdHJ9XFx4MWJbMG1gO1xuICAgICAgICBjYXNlIFwiZGVidWdcIjpcbiAgICAgICAgICAgIHJldHVybiBgXFx4MWJbNDdtXFx4MWJbMzBtJHtzdHJ9XFx4MWJbMG1gO1xuICAgICAgICBjYXNlIFwidHJhY2VcIjpcbiAgICAgICAgICAgIHJldHVybiBgXFx4MWJbNDdtXFx4MWJbMzBtJHtzdHJ9XFx4MWJbMG1gO1xuICAgICAgICBjYXNlIFwic3VjY2Vzc1wiOlxuICAgICAgICAgICAgcmV0dXJuIGBcXHgxYls0Mm1cXHgxYlszMG0ke3N0cn1cXHgxYlswbWA7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gc3RyO1xuICAgIH1cbn07XG5jb25zdCBpY29ucyA9IHtcbiAgICBmYXRhbDogXCLiqK9cIixcbiAgICBlcnJvcjogXCLiqK9cIixcbiAgICB3YXJuOiBcIuKaoO+4j1wiLFxuICAgIGluZm86IFwi4oS5XCIsXG4gICAgbG9nOiBcIuKEuVwiLFxuICAgIGRlYnVnOiBcIuKamVwiLFxuICAgIHRyYWNlOiBcIuKGklwiLFxuICAgIHN1Y2Nlc3M6IFwi4pyTXCJcbn07XG5mdW5jdGlvbiBmb3JtYXRTdGFjayhzdGFjaykge1xuICAgIGNvbnN0IGN3ZCA9IFwiY3dkXCIgaW4gcHJvY2VzcyAmJiB0eXBlb2YgcHJvY2Vzcy5jd2QgPT09IFwiZnVuY3Rpb25cIiA/IHByb2Nlc3MuY3dkKCkgOiBcIl9fVW5rbm93bkNXRF9fXCI7XG4gICAgcmV0dXJuIFwiICBcIiArIHN0YWNrLnNwbGl0KFwiXFxuXCIpLnNwbGljZSgxKS5tYXAoKGwpPT5sLnRyaW0oKS5yZXBsYWNlKFwiZmlsZTovL1wiLCBcIlwiKS5yZXBsYWNlKGN3ZCArIFwiL1wiLCBcIlwiKSkuam9pbihcIlxcbiAgXCIpO1xufVxuZnVuY3Rpb24gZm9ybWF0QXJncyhhcmdzKSB7XG4gICAgY29uc3QgZm10QXJncyA9IGFyZ3MubWFwKChhcmcpPT57XG4gICAgICAgIGlmIChpc09iamVjdChhcmcpICYmIHR5cGVvZiBhcmcuc3RhY2sgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBhcmcubWVzc2FnZSArIFwiXFxuXCIgKyBmb3JtYXRTdGFjayhhcmcuc3RhY2spO1xuICAgICAgICB9XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLXJldHVyblxuICAgICAgICByZXR1cm4gYXJnO1xuICAgIH0pO1xuICAgIHJldHVybiBmbXRBcmdzLm1hcCgoYXJnKT0+e1xuICAgICAgICBpZiAodHlwZW9mIGFyZyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgcmV0dXJuIGFyZztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoYXJnLCBudWxsLCA0KTtcbiAgICB9KTtcbn1cbmNvbnN0IGxvZ2dlciA9IGNyZWF0ZUNvbnNvbGEoe1xuICAgIHJlcG9ydGVyczogW1xuICAgICAgICB7XG4gICAgICAgICAgICBsb2c6IChsb2dPYmopPT57XG4gICAgICAgICAgICAgICAgY29uc3QgeyB0eXBlLCB0YWcsIGRhdGUsIGFyZ3MgfSA9IGxvZ09iajtcbiAgICAgICAgICAgICAgICBjb25zdCBpY29uID0gaWNvbnNbdHlwZV07XG4gICAgICAgICAgICAgICAgY29uc3QgbG9nUHJlZml4ID0gY29sb3JpemUoYCAke2ljb259ICR7dGFnfSAke2RhdGUudG9Mb2NhbGVUaW1lU3RyaW5nKCl9IGAsIHR5cGUpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGxpbmVzID0gZm9ybWF0QXJncyhhcmdzKS5qb2luKFwiIFwiKSAvLyBjb25jYXQgYWxsIGFyZ3VtZW50cyB0byBvbmUgc3BhY2Utc2VwYXJhdGVkIHN0cmluZyAobGlrZSBjb25zb2xlIGRvZXMpXG4gICAgICAgICAgICAgICAgLnNwbGl0KFwiXFxuXCIpIC8vIHNwbGl0IGFsbCB0aGUgbmV3bGluZXMgKGUuZy4gZnJvbSBsb2dnZWQgSlNPTi5zdHJpbmdpZmllZCBvYmplY3RzKVxuICAgICAgICAgICAgICAgIC5tYXAoKGwpPT5sb2dQcmVmaXggKyBcIiBcIiArIGwpIC8vIHByZXBlbmQgdGhlIGxvZyBwcmVmaXggdG8gZWFjaCBsaW5lXG4gICAgICAgICAgICAgICAgLmpvaW4oXCJcXG5cIik7IC8vIGpvaW4gYWxsIHRoZSBsaW5lcyBiYWNrIHRvZ2V0aGVyXG4gICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhsaW5lcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICBdLFxuICAgIGRlZmF1bHRzOiB7XG4gICAgICAgIHRhZzogXCJVUExPQURUSElOR1wiXG4gICAgfVxufSk7XG5jb25zdCBlZmZlY3RMb2dnZXJMZXZlbFRvQ29uc29sYUxldmVsID0ge1xuICAgIEFsbDogXCJ2ZXJib3NlXCIsXG4gICAgRmF0YWw6IFwiZXJyb3JcIixcbiAgICBFcnJvcjogXCJlcnJvclwiLFxuICAgIEluZm86IFwiaW5mb1wiLFxuICAgIERlYnVnOiBcImRlYnVnXCIsXG4gICAgVHJhY2U6IFwidHJhY2VcIixcbiAgICBXYXJuaW5nOiBcIndhcm5cIixcbiAgICBOb25lOiBcInNpbGVudFwiXG59O1xuY29uc3Qgd2l0aE1pbmltYWxMb2dMZXZlbCA9IChsZXZlbCA9IFwiaW5mb1wiKT0+e1xuICAgIHJldHVybiBMb2dnZXIud2l0aE1pbmltdW1Mb2dMZXZlbCh7XG4gICAgICAgIHNpbGVudDogRWZmZWN0TG9nTGV2ZWwuTm9uZSxcbiAgICAgICAgZXJyb3I6IEVmZmVjdExvZ0xldmVsLkVycm9yLFxuICAgICAgICB3YXJuOiBFZmZlY3RMb2dMZXZlbC5XYXJuaW5nLFxuICAgICAgICBpbmZvOiBFZmZlY3RMb2dMZXZlbC5JbmZvLFxuICAgICAgICBkZWJ1ZzogRWZmZWN0TG9nTGV2ZWwuRGVidWcsXG4gICAgICAgIHRyYWNlOiBFZmZlY3RMb2dMZXZlbC5UcmFjZSxcbiAgICAgICAgdmVyYm9zZTogRWZmZWN0TG9nTGV2ZWwuQWxsXG4gICAgfVtsZXZlbF0pO1xufTtcbmNvbnN0IENvbnNvbGFMb2dnZXIgPSBMb2dnZXIucmVwbGFjZShMb2dnZXIuZGVmYXVsdExvZ2dlciwgTG9nZ2VyLm1ha2UoKHsgbG9nTGV2ZWwsIG1lc3NhZ2UgfSk9PntcbiAgICAvLyBGSVhNRTogUHJvYmFibHkgbG9nIG90aGVyIHN0dWZmIHRoYW4ganVzdCBtZXNzYWdlP1xuICAgIGxvZ2dlcltlZmZlY3RMb2dnZXJMZXZlbFRvQ29uc29sYUxldmVsW2xvZ0xldmVsLl90YWddXShtZXNzYWdlKTtcbn0pKTtcblxuY29uc3QgdXBsb2FkTXVsdGlwYXJ0ID0gKGZpbGUsIHByZXNpZ25lZCk9PkVmZmVjdC5nZW4oZnVuY3Rpb24qKCkge1xuICAgICAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKGBVcGxvYWRpbmcgZmlsZSAke2ZpbGUubmFtZX0gd2l0aCAke3ByZXNpZ25lZC51cmxzLmxlbmd0aH0gY2h1bmtzIG9mIHNpemUgJHtwcmVzaWduZWQuY2h1bmtTaXplfSBieXRlcyBlYWNoYCk7XG4gICAgICAgIGNvbnN0IGV0YWdzID0geWllbGQqIEVmZmVjdC5mb3JFYWNoKHByZXNpZ25lZC51cmxzLCAodXJsLCBpbmRleCk9PntcbiAgICAgICAgICAgIGNvbnN0IG9mZnNldCA9IHByZXNpZ25lZC5jaHVua1NpemUgKiBpbmRleDtcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IE1hdGgubWluKG9mZnNldCArIHByZXNpZ25lZC5jaHVua1NpemUsIGZpbGUuc2l6ZSk7XG4gICAgICAgICAgICBjb25zdCBjaHVuayA9IGZpbGUuc2xpY2Uob2Zmc2V0LCBlbmQpO1xuICAgICAgICAgICAgcmV0dXJuIHVwbG9hZFBhcnQoe1xuICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICBjaHVuazogY2h1bmssXG4gICAgICAgICAgICAgICAgY29udGVudERpc3Bvc2l0aW9uOiBwcmVzaWduZWQuY29udGVudERpc3Bvc2l0aW9uLFxuICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiBmaWxlLnR5cGUsXG4gICAgICAgICAgICAgICAgZmlsZU5hbWU6IGZpbGUubmFtZSxcbiAgICAgICAgICAgICAgICBtYXhSZXRyaWVzOiAxMCxcbiAgICAgICAgICAgICAgICBrZXk6IHByZXNpZ25lZC5rZXksXG4gICAgICAgICAgICAgICAgdXBsb2FkSWQ6IHByZXNpZ25lZC51cGxvYWRJZFxuICAgICAgICAgICAgfSkucGlwZShFZmZlY3QuYW5kVGhlbigoZXRhZyk9Pih7XG4gICAgICAgICAgICAgICAgICAgIHRhZzogZXRhZyxcbiAgICAgICAgICAgICAgICAgICAgcGFydE51bWJlcjogaW5kZXggKyAxXG4gICAgICAgICAgICAgICAgfSkpLCBFZmZlY3QuY2F0Y2hUYWcoXCJSZXRyeUVycm9yXCIsIChlKT0+RWZmZWN0LmRpZShlKSkpO1xuICAgICAgICB9LCB7XG4gICAgICAgICAgICBjb25jdXJyZW5jeTogXCJpbmhlcml0XCJcbiAgICAgICAgfSk7XG4gICAgICAgIHlpZWxkKiBFZmZlY3QubG9nRGVidWcoXCJGaWxlXCIsIGZpbGUubmFtZSwgXCJ1cGxvYWRlZCBzdWNjZXNzZnVsbHkuXCIpO1xuICAgICAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiQ29tcGxldGluZyBtdWx0aXBhcnQgdXBsb2FkLi4uXCIpO1xuICAgICAgICB5aWVsZCogY29tcGxldGVNdWx0aXBhcnRVcGxvYWQocHJlc2lnbmVkLCBldGFncyk7XG4gICAgICAgIHlpZWxkKiBFZmZlY3QubG9nRGVidWcoXCJNdWx0aXBhcnQgdXBsb2FkIGNvbXBsZXRlLlwiKTtcbiAgICB9KTtcbi8qKlxuICogVXNlZCBieSBzZXJ2ZXIgdXBsb2FkcyB3aGVyZSBwcm9ncmVzcyBpcyBub3QgbmVlZGVkLlxuICogVXNlcyBub3JtYWwgZmV0Y2ggQVBJLlxuICovIGNvbnN0IHVwbG9hZFBhcnQgPSAob3B0cyk9PmZldGNoRWZmKG9wdHMudXJsLCB7XG4gICAgICAgIG1ldGhvZDogXCJQVVRcIixcbiAgICAgICAgYm9keTogb3B0cy5jaHVuayxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogb3B0cy5jb250ZW50VHlwZSxcbiAgICAgICAgICAgIFwiQ29udGVudC1EaXNwb3NpdGlvblwiOiBjb250ZW50RGlzcG9zaXRpb24ob3B0cy5jb250ZW50RGlzcG9zaXRpb24sIG9wdHMuZmlsZU5hbWUpXG4gICAgICAgIH1cbiAgICB9KS5waXBlKEVmZmVjdC5hbmRUaGVuKChyZXMpPT5yZXMub2sgJiYgcmVzLmhlYWRlcnMuZ2V0KFwiRXRhZ1wiKSA/IEVmZmVjdC5zdWNjZWVkKHJlcy5oZWFkZXJzLmdldChcIkV0YWdcIikpIDogRWZmZWN0LmZhaWwobmV3IFJldHJ5RXJyb3IoKSkpLCBFZmZlY3QucmV0cnkoe1xuICAgICAgICB3aGlsZTogKHJlcyk9PnJlcyBpbnN0YW5jZW9mIFJldHJ5RXJyb3IsXG4gICAgICAgIHNjaGVkdWxlOiBleHBvbmVudGlhbEJhY2tvZmYsXG4gICAgICAgIHRpbWVzOiBvcHRzLm1heFJldHJpZXNcbiAgICB9KSwgRWZmZWN0LnRhcEVycm9yVGFnKFwiUmV0cnlFcnJvclwiLCAoKT0+Ly8gTWF4IHJldHJpZXMgZXhjZWVkZWQsIHRlbGwgVVQgc2VydmVyIHRoYXQgdXBsb2FkIGZhaWxlZFxuICAgICAgICBhYm9ydE11bHRpcGFydFVwbG9hZCh7XG4gICAgICAgICAgICBrZXk6IG9wdHMua2V5LFxuICAgICAgICAgICAgdXBsb2FkSWQ6IG9wdHMudXBsb2FkSWRcbiAgICAgICAgfSkucGlwZShFZmZlY3QuYW5kVGhlbigocmVzKT0+e1xuICAgICAgICAgICAgRWZmZWN0LmZhaWwobmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgIGNvZGU6IFwiVVBMT0FEX0ZBSUxFRFwiLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IGBGYWlsZWQgdG8gdXBsb2FkIGZpbGUgJHtvcHRzLmZpbGVOYW1lfSB0byBTM2AsXG4gICAgICAgICAgICAgICAgY2F1c2U6IHJlc1xuICAgICAgICAgICAgfSkpO1xuICAgICAgICB9KSkpKTtcbmNvbnN0IGNvbXBsZXRlTXVsdGlwYXJ0VXBsb2FkID0gKHByZXNpZ25lZCwgZXRhZ3MpPT5mZXRjaEVmZkpzb24oZ2VuZXJhdGVVcGxvYWRUaGluZ1VSTChcIi9hcGkvY29tcGxldGVNdWx0aXBhcnRcIiksIFMuU3RydWN0KHtcbiAgICAgICAgc3VjY2VzczogUy5Cb29sZWFuLFxuICAgICAgICBtZXNzYWdlOiBTLm9wdGlvbmFsKFMuU3RyaW5nKVxuICAgIH0pLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGZpbGVLZXk6IHByZXNpZ25lZC5rZXksXG4gICAgICAgICAgICB1cGxvYWRJZDogcHJlc2lnbmVkLnVwbG9hZElkLFxuICAgICAgICAgICAgZXRhZ3NcbiAgICAgICAgfSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICAgIH1cbiAgICB9KTtcbmNvbnN0IGFib3J0TXVsdGlwYXJ0VXBsb2FkID0gKHByZXNpZ25lZCk9PmZldGNoRWZmSnNvbihnZW5lcmF0ZVVwbG9hZFRoaW5nVVJMKFwiL2FwaS9mYWlsdXJlQ2FsbGJhY2tcIiksIEZhaWx1cmVDYWxsYmFja1Jlc3BvbnNlU2NoZW1hLCB7XG4gICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIGZpbGVLZXk6IHByZXNpZ25lZC5rZXksXG4gICAgICAgICAgICB1cGxvYWRJZDogcHJlc2lnbmVkLnVwbG9hZElkXG4gICAgICAgIH0pLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgICB9XG4gICAgfSk7XG5cbmZ1bmN0aW9uIGdldFBhcnNlRm4ocGFyc2VyKSB7XG4gICAgaWYgKHR5cGVvZiBwYXJzZXIucGFyc2UgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gcGFyc2VyLnBhcnNlO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJJbnZhbGlkIHBhcnNlclwiKTtcbn1cblxuY29uc3QgZ2V0QXBpS2V5ID0gKGFwaUtleSk9PntcbiAgICBpZiAoYXBpS2V5KSByZXR1cm4gYXBpS2V5O1xuICAgIGlmIChwcm9jZXNzLmVudi5VUExPQURUSElOR19TRUNSRVQpIHJldHVybiBwcm9jZXNzLmVudi5VUExPQURUSElOR19TRUNSRVQ7XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5jb25zdCBnZXRBcGlLZXlPclRocm93ID0gKGFwaUtleSk9PntcbiAgICBjb25zdCBrZXkgPSBnZXRBcGlLZXkoYXBpS2V5KTtcbiAgICBpZiAoIWtleT8uc3RhcnRzV2l0aChcInNrX1wiKSkge1xuICAgICAgICB0aHJvdyBuZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICBjb2RlOiBcIk1JU1NJTkdfRU5WXCIsXG4gICAgICAgICAgICBtZXNzYWdlOiBcIk1pc3Npbmcgb3IgaW52YWxpZCBBUEkga2V5LiBBUEkga2V5cyBtdXN0IHN0YXJ0IHdpdGggYHNrX2AuXCJcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJldHVybiBrZXk7XG59O1xuXG5jbGFzcyBGaWxlU2l6ZU1pc21hdGNoIGV4dGVuZHMgVGFnZ2VkRXJyb3IoXCJGaWxlU2l6ZU1pc21hdGNoXCIpIHtcbiAgICBjb25zdHJ1Y3Rvcih0eXBlLCBtYXgsIGFjdHVhbCl7XG4gICAgICAgIGNvbnN0IHJlYXNvbiA9IGBZb3UgdXBsb2FkZWQgYSAke3R5cGV9IGZpbGUgdGhhdCB3YXMgJHtieXRlc1RvRmlsZVNpemUoYWN0dWFsKX0sIGJ1dCB0aGUgbGltaXQgZm9yIHRoYXQgdHlwZSBpcyAke21heH1gO1xuICAgICAgICBzdXBlcih7XG4gICAgICAgICAgICByZWFzb25cbiAgICAgICAgfSk7XG4gICAgfVxufVxuY2xhc3MgRmlsZUNvdW50TWlzbWF0Y2ggZXh0ZW5kcyBUYWdnZWRFcnJvcihcIkZpbGVDb3VudE1pc21hdGNoXCIpIHtcbiAgICBjb25zdHJ1Y3Rvcih0eXBlLCBib3VuZHR5cGUsIGJvdW5kLCBhY3R1YWwpe1xuICAgICAgICBjb25zdCByZWFzb24gPSBgWW91IHVwbG9hZGVkICR7YWN0dWFsfSBmaWxlKHMpIG9mIHR5cGUgJyR7dHlwZX0nLCBidXQgdGhlICR7Ym91bmR0eXBlfSBmb3IgdGhhdCB0eXBlIGlzICR7Ym91bmR9YDtcbiAgICAgICAgc3VwZXIoe1xuICAgICAgICAgICAgcmVhc29uXG4gICAgICAgIH0pO1xuICAgIH1cbn1cbi8vIFZlcmlmeSB0aGF0IHRoZSB1cGxvYWRlZCBmaWxlcyBkb2Vzbid0IHZpb2xhdGUgdGhlIHJvdXRlIGNvbmZpZyxcbi8vIGUuZy4gdXBsb2FkaW5nIG1vcmUgdmlkZW9zIHRoYW4gYWxsb3dlZCwgb3IgYSBmaWxlIHRoYXQgaXMgbGFyZ2VyIHRoYW4gYWxsb3dlZC5cbi8vIFRoaXMgaXMgZG91YmxlLWNoZWNrZWQgb24gaW5mcmEgc2lkZSwgYnV0IHdlIHdhbnQgdG8gZmFpbCBlYXJseSB0byBhdm9pZCBuZXR3b3JrIGxhdGVuY3kuXG5jb25zdCBhc3NlcnRGaWxlc01lZXRDb25maWcgPSAoZmlsZXMsIHJvdXRlQ29uZmlnKT0+RWZmZWN0LmdlbihmdW5jdGlvbiooKSB7XG4gICAgICAgIGNvbnN0IGNvdW50cyA9IHt9O1xuICAgICAgICBmb3IgKGNvbnN0IGZpbGUgb2YgZmlsZXMpe1xuICAgICAgICAgICAgY29uc3QgdHlwZSA9IHlpZWxkKiBnZXRUeXBlRnJvbUZpbGVOYW1lKGZpbGUubmFtZSwgb2JqZWN0S2V5cyhyb3V0ZUNvbmZpZykpO1xuICAgICAgICAgICAgY291bnRzW3R5cGVdID0gKGNvdW50c1t0eXBlXSA/PyAwKSArIDE7XG4gICAgICAgICAgICBjb25zdCBzaXplTGltaXQgPSByb3V0ZUNvbmZpZ1t0eXBlXT8ubWF4RmlsZVNpemU7XG4gICAgICAgICAgICBpZiAoIXNpemVMaW1pdCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB5aWVsZCogbmV3IEludmFsaWRSb3V0ZUNvbmZpZ0Vycm9yKHR5cGUsIFwibWF4RmlsZVNpemVcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBzaXplTGltaXRCeXRlcyA9IHlpZWxkKiBmaWxlU2l6ZVRvQnl0ZXMoc2l6ZUxpbWl0KTtcbiAgICAgICAgICAgIGlmIChmaWxlLnNpemUgPiBzaXplTGltaXRCeXRlcykge1xuICAgICAgICAgICAgICAgIHJldHVybiB5aWVsZCogbmV3IEZpbGVTaXplTWlzbWF0Y2godHlwZSwgc2l6ZUxpbWl0LCBmaWxlLnNpemUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvcihjb25zdCBfa2V5IGluIGNvdW50cyl7XG4gICAgICAgICAgICBjb25zdCBrZXkgPSBfa2V5O1xuICAgICAgICAgICAgY29uc3QgY29uZmlnID0gcm91dGVDb25maWdba2V5XTtcbiAgICAgICAgICAgIGlmICghY29uZmlnKSByZXR1cm4geWllbGQqIG5ldyBJbnZhbGlkUm91dGVDb25maWdFcnJvcihrZXkpO1xuICAgICAgICAgICAgY29uc3QgY291bnQgPSBjb3VudHNba2V5XTtcbiAgICAgICAgICAgIGNvbnN0IG1pbiA9IGNvbmZpZy5taW5GaWxlQ291bnQ7XG4gICAgICAgICAgICBjb25zdCBtYXggPSBjb25maWcubWF4RmlsZUNvdW50O1xuICAgICAgICAgICAgaWYgKG1pbiA+IG1heCkge1xuICAgICAgICAgICAgICAgIHJldHVybiB5aWVsZCogbmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBjb2RlOiBcIkJBRF9SRVFVRVNUXCIsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiSW52YWxpZCBjb25maWcgZHVyaW5nIGZpbGUgY291bnQgLSBtaW5GaWxlQ291bnQgPiBtYXhGaWxlQ291bnRcIixcbiAgICAgICAgICAgICAgICAgICAgY2F1c2U6IGBtaW5GaWxlQ291bnQgbXVzdCBiZSBsZXNzIHRoYW4gbWF4RmlsZUNvdW50IGZvciBrZXkgJHtrZXl9LiBnb3Q6ICR7bWlufSA+ICR7bWF4fWBcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjb3VudCA8IG1pbikge1xuICAgICAgICAgICAgICAgIHJldHVybiB5aWVsZCogbmV3IEZpbGVDb3VudE1pc21hdGNoKGtleSwgXCJtaW5pbXVtXCIsIG1pbiwgY291bnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNvdW50ID4gbWF4KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHlpZWxkKiBuZXcgRmlsZUNvdW50TWlzbWF0Y2goa2V5LCBcIm1heGltdW1cIiwgbWF4LCBjb3VudCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfSk7XG5jbGFzcyBSZXF1ZXN0SW5wdXQgZXh0ZW5kcyBDb250ZXh0LlRhZyhcInVwbG9hZHRoaW5nL1JlcXVlc3RJbnB1dFwiKSgpIHtcbn1cbmNvbnN0IHBhcnNlQW5kVmFsaWRhdGVSZXF1ZXN0ID0gKGlucHV0LCBvcHRzLCBhZGFwdGVyKT0+RWZmZWN0LmdlbihmdW5jdGlvbiooKSB7XG4gICAgICAgIGNvbnN0IHJlcSA9IHlpZWxkKiBFZmZlY3QuaXNFZmZlY3QoaW5wdXQucmVxKSA/IGlucHV0LnJlcSA6IEVmZmVjdC5zdWNjZWVkKGlucHV0LnJlcSk7XG4gICAgICAgIC8vIEdldCBpbnB1dHMgZnJvbSBxdWVyeSBhbmQgcGFyYW1zXG4gICAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwocmVxLnVybCk7XG4gICAgICAgIGNvbnN0IGhlYWRlcnMgPSByZXEuaGVhZGVycztcbiAgICAgICAgY29uc3QgcGFyYW1zID0gdXJsLnNlYXJjaFBhcmFtcztcbiAgICAgICAgY29uc3QgYWN0aW9uID0gcGFyYW1zLmdldChcImFjdGlvblR5cGVcIik7XG4gICAgICAgIGNvbnN0IHNsdWcgPSBwYXJhbXMuZ2V0KFwic2x1Z1wiKTtcbiAgICAgICAgY29uc3QgaG9vayA9IGhlYWRlcnMuZ2V0KFwidXBsb2FkdGhpbmctaG9va1wiKTtcbiAgICAgICAgY29uc3QgdXRGcm9udGVuZFBhY2thZ2UgPSBoZWFkZXJzLmdldChcIngtdXBsb2FkdGhpbmctcGFja2FnZVwiKSA/PyBcInVua25vd25cIjtcbiAgICAgICAgY29uc3QgY2xpZW50VmVyc2lvbiA9IGhlYWRlcnMuZ2V0KFwieC11cGxvYWR0aGluZy12ZXJzaW9uXCIpO1xuICAgICAgICBjb25zdCBhcGlLZXkgPSBnZXRBcGlLZXkob3B0cy5jb25maWc/LnVwbG9hZHRoaW5nU2VjcmV0KTtcbiAgICAgICAgaWYgKGNsaWVudFZlcnNpb24gIT0gbnVsbCAmJiBjbGllbnRWZXJzaW9uICE9PSB2ZXJzaW9uKSB7XG4gICAgICAgICAgICB5aWVsZCogRWZmZWN0LmxvZ0Vycm9yKGBDbGllbnQgdmVyc2lvbiBtaXNtYXRjaC4gU2VydmVyIHZlcnNpb246ICR7dmVyc2lvbn0sIENsaWVudCB2ZXJzaW9uOiAke2NsaWVudFZlcnNpb259YCk7XG4gICAgICAgICAgICByZXR1cm4geWllbGQqIG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICBjb2RlOiBcIkJBRF9SRVFVRVNUXCIsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJDbGllbnQgdmVyc2lvbiBtaXNtYXRjaFwiLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBgU2VydmVyIHZlcnNpb246ICR7dmVyc2lvbn0sIENsaWVudCB2ZXJzaW9uOiAke2NsaWVudFZlcnNpb259YFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFzbHVnKSB7XG4gICAgICAgICAgICB5aWVsZCogRWZmZWN0LmxvZ0Vycm9yKFwiTm8gc2x1ZyBwcm92aWRlZCBpbiBwYXJhbXM6XCIsIHBhcmFtcyk7XG4gICAgICAgICAgICByZXR1cm4geWllbGQqIG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICBjb2RlOiBcIkJBRF9SRVFVRVNUXCIsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJObyBzbHVnIHByb3ZpZGVkIGluIHBhcmFtc1wiXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc2x1ZyAmJiB0eXBlb2Ygc2x1ZyAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgY29uc3QgbXNnID0gYEV4cGVjdGVkIHNsdWcgdG8gYmUgb2YgdHlwZSAnc3RyaW5nJywgZ290ICcke3R5cGVvZiBzbHVnfSdgO1xuICAgICAgICAgICAgeWllbGQqIEVmZmVjdC5sb2dFcnJvcihtc2cpO1xuICAgICAgICAgICAgcmV0dXJuIHlpZWxkKiBuZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogXCJCQURfUkVRVUVTVFwiLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiYHNsdWdgIG11c3QgYmUgYSBzdHJpbmdcIixcbiAgICAgICAgICAgICAgICBjYXVzZTogbXNnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWFwaUtleSkge1xuICAgICAgICAgICAgY29uc3QgbXNnID0gYE5vIHNlY3JldCBwcm92aWRlZCwgcGxlYXNlIHNldCBVUExPQURUSElOR19TRUNSRVQgaW4geW91ciBlbnYgZmlsZSBvciBpbiB0aGUgY29uZmlnYDtcbiAgICAgICAgICAgIHlpZWxkKiBFZmZlY3QubG9nRXJyb3IobXNnKTtcbiAgICAgICAgICAgIHJldHVybiB5aWVsZCogbmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgIGNvZGU6IFwiTUlTU0lOR19FTlZcIixcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBgTm8gc2VjcmV0IHByb3ZpZGVkYCxcbiAgICAgICAgICAgICAgICBjYXVzZTogbXNnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWFwaUtleS5zdGFydHNXaXRoKFwic2tfXCIpKSB7XG4gICAgICAgICAgICBjb25zdCBtc2cgPSBgSW52YWxpZCBzZWNyZXQgcHJvdmlkZWQsIFVQTE9BRFRISU5HX1NFQ1JFVCBtdXN0IHN0YXJ0IHdpdGggJ3NrXydgO1xuICAgICAgICAgICAgeWllbGQqIEVmZmVjdC5sb2dFcnJvcihtc2cpO1xuICAgICAgICAgICAgcmV0dXJuIHlpZWxkKiBuZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogXCJNSVNTSU5HX0VOVlwiLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiSW52YWxpZCBBUEkga2V5LiBBUEkga2V5cyBtdXN0IHN0YXJ0IHdpdGggJ3NrXycuXCIsXG4gICAgICAgICAgICAgICAgY2F1c2U6IG1zZ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHV0RnJvbnRlbmRQYWNrYWdlICYmIHR5cGVvZiB1dEZyb250ZW5kUGFja2FnZSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgY29uc3QgbXNnID0gYEV4cGVjdGVkIHgtdXBsb2FkdGhpbmctcGFja2FnZSB0byBiZSBvZiB0eXBlICdzdHJpbmcnLCBnb3QgJyR7dHlwZW9mIHV0RnJvbnRlbmRQYWNrYWdlfSdgO1xuICAgICAgICAgICAgeWllbGQqIEVmZmVjdC5sb2dFcnJvcihtc2cpO1xuICAgICAgICAgICAgcmV0dXJuIHlpZWxkKiBuZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogXCJCQURfUkVRVUVTVFwiLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiYHgtdXBsb2FkdGhpbmctcGFja2FnZWAgbXVzdCBiZSBhIHN0cmluZy4gZWcuICdAdXBsb2FkdGhpbmcvcmVhY3QnXCIsXG4gICAgICAgICAgICAgICAgY2F1c2U6IG1zZ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdXBsb2FkYWJsZSA9IG9wdHMucm91dGVyW3NsdWddO1xuICAgICAgICBpZiAoIXVwbG9hZGFibGUpIHtcbiAgICAgICAgICAgIGNvbnN0IG1zZyA9IGBObyBmaWxlIHJvdXRlIGZvdW5kIGZvciBzbHVnICR7c2x1Z31gO1xuICAgICAgICAgICAgeWllbGQqIEVmZmVjdC5sb2dFcnJvcihtc2cpO1xuICAgICAgICAgICAgcmV0dXJuIHlpZWxkKiBuZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogXCJOT1RfRk9VTkRcIixcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBtc2dcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhY3Rpb24gJiYgIWlzQWN0aW9uVHlwZShhY3Rpb24pKSB7XG4gICAgICAgICAgICBjb25zdCBtc2cgPSBgRXhwZWN0ZWQgJHtWQUxJRF9BQ1RJT05fVFlQRVMubWFwKCh4KT0+YFwiJHt4fVwiYCkuam9pbihcIiwgXCIpLnJlcGxhY2UoLywoPyEuKiwpLywgXCIgb3JcIil9IGJ1dCBnb3QgXCIke2FjdGlvbn1cImA7XG4gICAgICAgICAgICB5aWVsZCogRWZmZWN0LmxvZ0Vycm9yKFwiSW52YWxpZCBhY3Rpb24gdHlwZVwiLCBtc2cpO1xuICAgICAgICAgICAgcmV0dXJuIHlpZWxkKiBuZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogXCJCQURfUkVRVUVTVFwiLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBgSW52YWxpZCBhY3Rpb24gdHlwZSAke2FjdGlvbn1gLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IG1zZ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGhvb2sgJiYgIWlzVXBsb2FkVGhpbmdIb29rKGhvb2spKSB7XG4gICAgICAgICAgICBjb25zdCBtc2cgPSBgRXhwZWN0ZWQgJHtWQUxJRF9VVF9IT09LUy5tYXAoKHgpPT5gXCIke3h9XCJgKS5qb2luKFwiLCBcIikucmVwbGFjZSgvLCg/IS4qLCkvLCBcIiBvclwiKX0gYnV0IGdvdCBcIiR7aG9va31cImA7XG4gICAgICAgICAgICB5aWVsZCogRWZmZWN0LmxvZ0Vycm9yKFwiSW52YWxpZCB1cGxvYWR0aGluZyBob29rXCIsIG1zZyk7XG4gICAgICAgICAgICByZXR1cm4geWllbGQqIG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICBjb2RlOiBcIkJBRF9SRVFVRVNUXCIsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGBJbnZhbGlkIHVwbG9hZHRoaW5nIGhvb2sgJHtob29rfWAsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogbXNnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWFjdGlvbiAmJiAhaG9vayB8fCBhY3Rpb24gJiYgaG9vaykge1xuICAgICAgICAgICAgY29uc3QgbXNnID0gYEV4YWN0bHkgb25lIG9mICdhY3Rpb25UeXBlJyBvciAndXBsb2FkdGhpbmctaG9vaycgbXVzdCBiZSBwcm92aWRlZGA7XG4gICAgICAgICAgICB5aWVsZCogRWZmZWN0LmxvZ0Vycm9yKG1zZyk7XG4gICAgICAgICAgICByZXR1cm4geWllbGQqIG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICBjb2RlOiBcIkJBRF9SRVFVRVNUXCIsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogbXNnXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwi4pyU77iOIEFsbCByZXF1ZXN0IGlucHV0IGlzIHZhbGlkXCIpO1xuICAgICAgICAvLyBGSVhNRTogVGhpcyBzaG91bGQgcHJvYmFibHkgcHJvdmlkZSB0aGUgZnVsbCBjb250ZXh0IGF0IG9uY2UgaW5zdGVhZCBvZlxuICAgICAgICAvLyBwYXJ0aWFsbHkgaW4gdGhlIGBydW5SZXF1ZXN0SGFuZGxlckFzeW5jYCBhbmQgcGFydGlhbGx5IGluIGhlcmUuLi5cbiAgICAgICAgLy8gUmVmOiBodHRwczovL2Rpc2NvcmQuY29tL2NoYW5uZWxzL0BtZS8xMjAxOTc3MTU0NTc3ODkxMzY5LzEyMDc0NDE4Mzk5NzI1NDg2NjlcbiAgICAgICAgY29uc3QgY29udGV4dFZhbHVlID0geWllbGQqIEZldGNoQ29udGV4dDtcbiAgICAgICAgY29udGV4dFZhbHVlLmJhc2VIZWFkZXJzW1wieC11cGxvYWR0aGluZy1hcGkta2V5XCJdID0gYXBpS2V5O1xuICAgICAgICBjb250ZXh0VmFsdWUuYmFzZUhlYWRlcnNbXCJ4LXVwbG9hZHRoaW5nLWZlLXBhY2thZ2VcIl0gPSB1dEZyb250ZW5kUGFja2FnZTtcbiAgICAgICAgY29udGV4dFZhbHVlLmJhc2VIZWFkZXJzW1wieC11cGxvYWR0aGluZy1iZS1hZGFwdGVyXCJdID0gYWRhcHRlcjtcbiAgICAgICAgY29uc3QgeyBpc0RldiA9IGlzRGV2ZWxvcG1lbnQgfSA9IG9wdHMuY29uZmlnID8/IHt9O1xuICAgICAgICBpZiAoaXNEZXYpIHlpZWxkKiBFZmZlY3QubG9nSW5mbyhcIlVwbG9hZFRoaW5nIGRldiBzZXJ2ZXIgaXMgbm93IHJ1bm5pbmchXCIpO1xuICAgICAgICBjb25zdCBiYXNlID0ge1xuICAgICAgICAgICAgcmVxLFxuICAgICAgICAgICAgY29uZmlnOiBvcHRzLmNvbmZpZyA/PyB7fSxcbiAgICAgICAgICAgIG1pZGRsZXdhcmVBcmdzOiBpbnB1dC5taWRkbGV3YXJlQXJncyxcbiAgICAgICAgICAgIGlzRGV2LFxuICAgICAgICAgICAgYXBpS2V5LFxuICAgICAgICAgICAgc2x1ZyxcbiAgICAgICAgICAgIHVwbG9hZGFibGUsXG4gICAgICAgICAgICBob29rOiBudWxsLFxuICAgICAgICAgICAgYWN0aW9uOiBudWxsXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBhY3Rpb24gPyB7XG4gICAgICAgICAgICAuLi5iYXNlLFxuICAgICAgICAgICAgYWN0aW9uOiBhY3Rpb25cbiAgICAgICAgfSA6IHtcbiAgICAgICAgICAgIC4uLmJhc2UsXG4gICAgICAgICAgICBob29rOiBob29rXG4gICAgICAgIH07XG4gICAgfSk7XG5cbmNvbnN0IHJlc29sdmVDYWxsYmFja1VybCA9IEVmZmVjdC5nZW4oZnVuY3Rpb24qKCkge1xuICAgIGNvbnN0IHsgY29uZmlnLCByZXEsIGlzRGV2IH0gPSB5aWVsZCogUmVxdWVzdElucHV0O1xuICAgIGxldCBjYWxsYmFja1VybCA9IG5ldyBVUkwocmVxLnVybCk7XG4gICAgaWYgKGNvbmZpZz8uY2FsbGJhY2tVcmwpIHtcbiAgICAgICAgY2FsbGJhY2tVcmwgPSB5aWVsZCogZ2V0RnVsbEFwaVVybChjb25maWcuY2FsbGJhY2tVcmwpO1xuICAgIH0gZWxzZSBpZiAocHJvY2Vzcy5lbnYuVVBMT0FEVEhJTkdfVVJMKSB7XG4gICAgICAgIGNhbGxiYWNrVXJsID0geWllbGQqIGdldEZ1bGxBcGlVcmwocHJvY2Vzcy5lbnYuVVBMT0FEVEhJTkdfVVJMKTtcbiAgICB9XG4gICAgaWYgKGlzRGV2IHx8ICFjYWxsYmFja1VybC5ob3N0LmluY2x1ZGVzKFwibG9jYWxob3N0XCIpKSB7XG4gICAgICAgIHJldHVybiBjYWxsYmFja1VybDtcbiAgICB9XG4gICAgLy8gUHJvZHVjdGlvbiBidWlsZHMgaGF2ZSB0byBoYXZlIGEgcHVibGljIFVSTCBzbyBVVCBjYW4gc2VuZCB3ZWJob29rXG4gICAgLy8gUGFyc2UgdGhlIFVSTCBmcm9tIHRoZSBoZWFkZXJzXG4gICAgbGV0IHBhcnNlZEZyb21IZWFkZXJzID0gcmVxLmhlYWRlcnMuZ2V0KFwib3JpZ2luXCIpID8/IHJlcS5oZWFkZXJzLmdldChcInJlZmVyZXJcIikgPz8gcmVxLmhlYWRlcnMuZ2V0KFwiaG9zdFwiKSA/PyByZXEuaGVhZGVycy5nZXQoXCJ4LWZvcndhcmRlZC1ob3N0XCIpO1xuICAgIGlmIChwYXJzZWRGcm9tSGVhZGVycyAmJiAhcGFyc2VkRnJvbUhlYWRlcnMuaW5jbHVkZXMoXCJodHRwXCIpKSB7XG4gICAgICAgIHBhcnNlZEZyb21IZWFkZXJzID0gKHJlcS5oZWFkZXJzLmdldChcIngtZm9yd2FyZGVkLXByb3RvXCIpID8/IFwiaHR0cHNcIikgKyBcIjovL1wiICsgcGFyc2VkRnJvbUhlYWRlcnM7XG4gICAgfVxuICAgIGlmICghcGFyc2VkRnJvbUhlYWRlcnMgfHwgcGFyc2VkRnJvbUhlYWRlcnMuaW5jbHVkZXMoXCJsb2NhbGhvc3RcIikpIHtcbiAgICAgICAgLy8gRGlkbid0IGZpbmQgYSB2YWxpZCBVUkwgaW4gdGhlIGhlYWRlcnMsIGxvZyBhIHdhcm5pbmcgYW5kIHVzZSB0aGUgb3JpZ2luYWwgdXJsIGFueXdheVxuICAgICAgICBFZmZlY3QubG9nV2FybmluZyhcIllvdSBhcmUgdXNpbmcgYSBsb2NhbGhvc3QgY2FsbGJhY2sgdXJsIGluIHByb2R1Y3Rpb24gd2hpY2ggaXMgbm90IHN1cHBvcnRlZC5cIiwgXCJSZWFkIG1vcmUgYW5kIGxlYXJuIGhvdyB0byBmaXggaXQgaGVyZTogaHR0cHM6Ly9kb2NzLnVwbG9hZHRoaW5nLmNvbS9mYXEjbXktY2FsbGJhY2stcnVucy1pbi1kZXZlbG9wbWVudC1idXQtbm90LWluLXByb2R1Y3Rpb25cIik7XG4gICAgICAgIHJldHVybiBjYWxsYmFja1VybDtcbiAgICB9XG4gICAgcmV0dXJuIHlpZWxkKiBnZXRGdWxsQXBpVXJsKHBhcnNlZEZyb21IZWFkZXJzKTtcbn0pO1xuXG4vKipcbiAqIEFsbG93cyBhZGFwdGVycyB0byBiZSBmdWxseSBhc3luYy9hd2FpdCBpbnN0ZWFkIG9mIHByb3ZpZGluZyBzZXJ2aWNlcyBhbmQgcnVubmluZyBFZmZlY3QgcHJvZ3JhbXNcbiAqLyBjb25zdCBydW5SZXF1ZXN0SGFuZGxlckFzeW5jID0gKGhhbmRsZXIsIGFyZ3MsIGNvbmZpZyk9PmhhbmRsZXIoYXJncykucGlwZSh3aXRoTWluaW1hbExvZ0xldmVsKGNvbmZpZz8ubG9nTGV2ZWwpLCBFZmZlY3QucHJvdmlkZShDb25zb2xhTG9nZ2VyKSwgRWZmZWN0LnByb3ZpZGVTZXJ2aWNlKEZldGNoQ29udGV4dCwge1xuICAgICAgICBmZXRjaDogY29uZmlnPy5mZXRjaCA/PyBnbG9iYWxUaGlzLmZldGNoLFxuICAgICAgICBiYXNlSGVhZGVyczoge1xuICAgICAgICAgICAgXCJ4LXVwbG9hZHRoaW5nLXZlcnNpb25cIjogdmVyc2lvbixcbiAgICAgICAgICAgIC8vIFRoZXNlIGFyZSBmaWxsZWQgaW4gbGF0ZXIgaW4gYHBhcnNlQW5kVmFsaWRhdGVSZXF1ZXN0YFxuICAgICAgICAgICAgXCJ4LXVwbG9hZHRoaW5nLWFwaS1rZXlcIjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgXCJ4LXVwbG9hZHRoaW5nLWJlLWFkYXB0ZXJcIjogdW5kZWZpbmVkLFxuICAgICAgICAgICAgXCJ4LXVwbG9hZHRoaW5nLWZlLXBhY2thZ2VcIjogdW5kZWZpbmVkXG4gICAgICAgIH1cbiAgICB9KSwgYXNIYW5kbGVyT3V0cHV0LCBFZmZlY3QucnVuUHJvbWlzZSk7XG5jb25zdCBhc0hhbmRsZXJPdXRwdXQgPSAoZWZmZWN0KT0+RWZmZWN0LmNhdGNoQWxsKGVmZmVjdCwgKGVycm9yKT0+RWZmZWN0LnN1Y2NlZWQoe1xuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICBlcnJvclxuICAgICAgICB9KSk7XG5jb25zdCBoYW5kbGVSZXF1ZXN0ID0gUmVxdWVzdElucHV0LnBpcGUoRWZmZWN0LmFuZFRoZW4oKHsgYWN0aW9uLCBob29rIH0pPT57XG4gICAgaWYgKGhvb2sgPT09IFwiY2FsbGJhY2tcIikgcmV0dXJuIGhhbmRsZUNhbGxiYWNrUmVxdWVzdDtcbiAgICBzd2l0Y2goYWN0aW9uKXtcbiAgICAgICAgY2FzZSBcInVwbG9hZFwiOlxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZVVwbG9hZEFjdGlvbjtcbiAgICAgICAgY2FzZSBcIm11bHRpcGFydC1jb21wbGV0ZVwiOlxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZU11bHRpcGFydENvbXBsZXRlQWN0aW9uO1xuICAgICAgICBjYXNlIFwiZmFpbHVyZVwiOlxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZU11bHRpcGFydEZhaWx1cmVBY3Rpb247XG4gICAgfVxufSksIEVmZmVjdC5tYXAoKG91dHB1dCk9Pih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIC4uLm91dHB1dFxuICAgIH0pKSk7XG5jb25zdCBidWlsZFJlcXVlc3RIYW5kbGVyID0gKG9wdHMsIGFkYXB0ZXIpPT4oaW5wdXQpPT5oYW5kbGVSZXF1ZXN0LnBpcGUoRWZmZWN0LnByb3ZpZGVTZXJ2aWNlRWZmZWN0KFJlcXVlc3RJbnB1dCwgcGFyc2VBbmRWYWxpZGF0ZVJlcXVlc3QoaW5wdXQsIG9wdHMsIGFkYXB0ZXIpKSwgRWZmZWN0LmNhdGNoVGFncyh7XG4gICAgICAgICAgICBGZXRjaEVycm9yOiAoZSk9Pm5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgY29kZTogXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIixcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogdHlwZW9mIGUuZXJyb3IgPT09IFwic3RyaW5nXCIgPyBlLmVycm9yIDogZS5tZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICBjYXVzZTogZSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogZS5kYXRhXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBQYXJzZUVycm9yOiAoZSk9Pm5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgY29kZTogXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIixcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogXCJBbiBlcnJvciBvY2N1cmVkIHdoaWxlIHBhcnNpbmcgaW5wdXQvb3V0cHV0XCIsXG4gICAgICAgICAgICAgICAgICAgIGNhdXNlOiBlXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgfSksIEVmZmVjdC50YXBFcnJvcigoZSk9PkVmZmVjdC5sb2dFcnJvcihlLm1lc3NhZ2UpKSk7XG5jb25zdCBoYW5kbGVDYWxsYmFja1JlcXVlc3QgPSBFZmZlY3QuZ2VuKGZ1bmN0aW9uKigpIHtcbiAgICBjb25zdCB7IHJlcSwgdXBsb2FkYWJsZSwgYXBpS2V5IH0gPSB5aWVsZCogUmVxdWVzdElucHV0O1xuICAgIGNvbnN0IHZlcmlmaWVkID0geWllbGQqIEVmZmVjdC50cnlQcm9taXNlKHtcbiAgICAgICAgdHJ5OiBhc3luYyAoKT0+dmVyaWZ5U2lnbmF0dXJlKGF3YWl0IHJlcS5jbG9uZSgpLnRleHQoKSwgcmVxLmhlYWRlcnMuZ2V0KFwieC11cGxvYWR0aGluZy1zaWduYXR1cmVcIiksIGFwaUtleSksXG4gICAgICAgIGNhdGNoOiAoKT0+bmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgIGNvZGU6IFwiQkFEX1JFUVVFU1RcIixcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkludmFsaWQgc2lnbmF0dXJlXCJcbiAgICAgICAgICAgIH0pXG4gICAgfSk7XG4gICAgeWllbGQqIEVmZmVjdC5sb2dEZWJ1ZyhcIlNpZ25hdHVyZSB2ZXJpZmllZDpcIiwgdmVyaWZpZWQpO1xuICAgIGlmICghdmVyaWZpZWQpIHtcbiAgICAgICAgeWllbGQqIEVmZmVjdC5sb2dFcnJvcihcIkludmFsaWQgc2lnbmF0dXJlXCIpO1xuICAgICAgICByZXR1cm4geWllbGQqIG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgIGNvZGU6IFwiQkFEX1JFUVVFU1RcIixcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiSW52YWxpZCBzaWduYXR1cmVcIlxuICAgICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgcmVxdWVzdElucHV0ID0geWllbGQqIHBhcnNlUmVxdWVzdEpzb24ocmVxLCBTLlN0cnVjdCh7XG4gICAgICAgIHN0YXR1czogUy5TdHJpbmcsXG4gICAgICAgIGZpbGU6IFVwbG9hZGVkRmlsZURhdGFTY2hlbWEsXG4gICAgICAgIG1ldGFkYXRhOiBTLlJlY29yZChTLlN0cmluZywgUy5Vbmtub3duKVxuICAgIH0pKTtcbiAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiSGFuZGxpbmcgY2FsbGJhY2sgcmVxdWVzdCB3aXRoIGlucHV0OlwiLCByZXF1ZXN0SW5wdXQpO1xuICAgIGNvbnN0IHNlcnZlckRhdGEgPSB5aWVsZCogRWZmZWN0LnRyeVByb21pc2Uoe1xuICAgICAgICB0cnk6IGFzeW5jICgpPT51cGxvYWRhYmxlLnJlc29sdmVyKHtcbiAgICAgICAgICAgICAgICBmaWxlOiByZXF1ZXN0SW5wdXQuZmlsZSxcbiAgICAgICAgICAgICAgICBtZXRhZGF0YTogcmVxdWVzdElucHV0Lm1ldGFkYXRhXG4gICAgICAgICAgICB9KSxcbiAgICAgICAgY2F0Y2g6IChlcnJvcik9Pm5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICBjb2RlOiBcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiRmFpbGVkIHRvIHJ1biBvblVwbG9hZENvbXBsZXRlXCIsXG4gICAgICAgICAgICAgICAgY2F1c2U6IGVycm9yXG4gICAgICAgICAgICB9KVxuICAgIH0pLnBpcGUoRWZmZWN0LnRhcEVycm9yKChlcnJvcik9PkVmZmVjdC5sb2dFcnJvcihcIkZhaWxlZCB0byBydW4gb25VcGxvYWRDb21wbGV0ZS4gWW91IHByb2JhYmx5IHNob3VsZG4ndCBiZSB0aHJvd2luZyBlcnJvcnMgaGVyZS5cIiwgZXJyb3IpKSk7XG4gICAgY29uc3QgcGF5bG9hZCA9IHtcbiAgICAgICAgZmlsZUtleTogcmVxdWVzdElucHV0LmZpbGUua2V5LFxuICAgICAgICBjYWxsYmFja0RhdGE6IHNlcnZlckRhdGEgPz8gbnVsbFxuICAgIH07XG4gICAgeWllbGQqIEVmZmVjdC5sb2dEZWJ1ZyhcIidvblVwbG9hZENvbXBsZXRlJyBjYWxsYmFjayBmaW5pc2hlZC4gU2VuZGluZyByZXNwb25zZSB0byBVcGxvYWRUaGluZzpcIiwgcGF5bG9hZCk7XG4gICAgeWllbGQqIGZldGNoRWZmSnNvbihnZW5lcmF0ZVVwbG9hZFRoaW5nVVJMKFwiL2FwaS9zZXJ2ZXJDYWxsYmFja1wiKSwgU2VydmVyQ2FsbGJhY2tQb3N0UmVzcG9uc2VTY2hlbWEsIHtcbiAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkocGF5bG9hZCksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4ge1xuICAgICAgICBib2R5OiBudWxsXG4gICAgfTtcbn0pO1xuY29uc3QgcnVuUm91dGVNaWRkbGV3YXJlID0gKG9wdHMpPT5FZmZlY3QuZ2VuKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgY29uc3QgeyB1cGxvYWRhYmxlLCBtaWRkbGV3YXJlQXJncyB9ID0geWllbGQqIFJlcXVlc3RJbnB1dDtcbiAgICAgICAgY29uc3QgeyBmaWxlcywgaW5wdXQgfSA9IG9wdHM7XG4gICAgICAgIHlpZWxkKiBFZmZlY3QubG9nRGVidWcoXCJSdW5uaW5nIG1pZGRsZXdhcmVcIik7XG4gICAgICAgIGNvbnN0IG1ldGFkYXRhID0geWllbGQqIEVmZmVjdC50cnlQcm9taXNlKHtcbiAgICAgICAgICAgIHRyeTogYXN5bmMgKCk9PnVwbG9hZGFibGUuX2RlZi5taWRkbGV3YXJlKHtcbiAgICAgICAgICAgICAgICAgICAgLi4ubWlkZGxld2FyZUFyZ3MsXG4gICAgICAgICAgICAgICAgICAgIGlucHV0LFxuICAgICAgICAgICAgICAgICAgICBmaWxlc1xuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgY2F0Y2g6IChlcnJvcik9PmVycm9yIGluc3RhbmNlb2YgVXBsb2FkVGhpbmdFcnJvciA/IGVycm9yIDogbmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBjb2RlOiBcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkZhaWxlZCB0byBydW4gbWlkZGxld2FyZVwiLFxuICAgICAgICAgICAgICAgICAgICBjYXVzZTogZXJyb3JcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICB9KS5waXBlKEVmZmVjdC50YXBFcnJvcigoZXJyb3IpPT5FZmZlY3QubG9nRXJyb3IoXCJBbiBlcnJvciBvY2N1cmVkIGluIHlvdXIgbWlkZGxld2FyZSBmdW5jdGlvblwiLCBlcnJvcikpKTtcbiAgICAgICAgaWYgKG1ldGFkYXRhW1VURmlsZXNdICYmIG1ldGFkYXRhW1VURmlsZXNdLmxlbmd0aCAhPT0gZmlsZXMubGVuZ3RoKSB7XG4gICAgICAgICAgICBjb25zdCBtc2cgPSBgRXhwZWN0ZWQgZmlsZXMgb3ZlcnJpZGUgdG8gaGF2ZSB0aGUgc2FtZSBsZW5ndGggYXMgb3JpZ2luYWwgZmlsZXMsIGdvdCAke21ldGFkYXRhW1VURmlsZXNdLmxlbmd0aH0gYnV0IGV4cGVjdGVkICR7ZmlsZXMubGVuZ3RofWA7XG4gICAgICAgICAgICB5aWVsZCogRWZmZWN0LmxvZ0Vycm9yKG1zZyk7XG4gICAgICAgICAgICByZXR1cm4geWllbGQqIG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICBjb2RlOiBcIkJBRF9SRVFVRVNUXCIsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJGaWxlcyBvdmVycmlkZSBtdXN0IGhhdmUgdGhlIHNhbWUgbGVuZ3RoIGFzIGZpbGVzXCIsXG4gICAgICAgICAgICAgICAgY2F1c2U6IG1zZ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgLy8gQXR0YWNoIGN1c3RvbUlkcyBmcm9tIG1pZGRsZXdhcmUgdG8gdGhlIGZpbGVzXG4gICAgICAgIGNvbnN0IGZpbGVzV2l0aEN1c3RvbUlkcyA9IHlpZWxkKiBFZmZlY3QuZm9yRWFjaChmaWxlcywgKGZpbGUsIGlkeCk9PkVmZmVjdC5nZW4oZnVuY3Rpb24qKCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRoZWlycyA9IG1ldGFkYXRhW1VURmlsZXNdPy5baWR4XTtcbiAgICAgICAgICAgICAgICBpZiAodGhlaXJzICYmIHRoZWlycy5zaXplICE9PSBmaWxlLnNpemUpIHtcbiAgICAgICAgICAgICAgICAgICAgeWllbGQqIEVmZmVjdC5sb2dXYXJuaW5nKFwiRmlsZSBzaXplIG1pc21hdGNoLiBSZXZlcnRpbmcgdG8gb3JpZ2luYWwgc2l6ZVwiKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogdGhlaXJzPy5uYW1lID8/IGZpbGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgc2l6ZTogZmlsZS5zaXplLFxuICAgICAgICAgICAgICAgICAgICBjdXN0b21JZDogdGhlaXJzPy5jdXN0b21JZFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBtZXRhZGF0YSxcbiAgICAgICAgICAgIGZpbGVzV2l0aEN1c3RvbUlkc1xuICAgICAgICB9O1xuICAgIH0pO1xuY29uc3QgaGFuZGxlVXBsb2FkQWN0aW9uID0gRWZmZWN0LmdlbihmdW5jdGlvbiooKSB7XG4gICAgY29uc3Qgb3B0cyA9IHlpZWxkKiBSZXF1ZXN0SW5wdXQ7XG4gICAgY29uc3QgeyBmaWxlcywgaW5wdXQgfSA9IHlpZWxkKiBwYXJzZVJlcXVlc3RKc29uKG9wdHMucmVxLCBVcGxvYWRBY3Rpb25QYXlsb2FkKTtcbiAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiSGFuZGxpbmcgdXBsb2FkIHJlcXVlc3Qgd2l0aCBpbnB1dDpcIiwge1xuICAgICAgICBmaWxlcyxcbiAgICAgICAgaW5wdXRcbiAgICB9KTtcbiAgICAvLyB2YWxpZGF0ZSB0aGUgaW5wdXRcbiAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiUGFyc2luZyB1c2VyIGlucHV0XCIpO1xuICAgIGNvbnN0IGlucHV0UGFyc2VyID0gb3B0cy51cGxvYWRhYmxlLl9kZWYuaW5wdXRQYXJzZXI7XG4gICAgY29uc3QgcGFyc2VkSW5wdXQgPSB5aWVsZCogRWZmZWN0LnRyeVByb21pc2Uoe1xuICAgICAgICB0cnk6IGFzeW5jICgpPT5nZXRQYXJzZUZuKGlucHV0UGFyc2VyKShpbnB1dCksXG4gICAgICAgIGNhdGNoOiAoZXJyb3IpPT5uZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogXCJCQURfUkVRVUVTVFwiLFxuICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiSW52YWxpZCBpbnB1dFwiLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvclxuICAgICAgICAgICAgfSlcbiAgICB9KS5waXBlKEVmZmVjdC50YXBFcnJvcigoZXJyb3IpPT5FZmZlY3QubG9nRXJyb3IoXCJBbiBlcnJvciBvY2N1cmVkIHRyeWluZyB0byBwYXJzZSBpbnB1dFwiLCBlcnJvcikpKTtcbiAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiSW5wdXQgcGFyc2VkIHN1Y2Nlc3NmdWxseVwiLCBwYXJzZWRJbnB1dCk7XG4gICAgY29uc3QgeyBtZXRhZGF0YSwgZmlsZXNXaXRoQ3VzdG9tSWRzIH0gPSB5aWVsZCogcnVuUm91dGVNaWRkbGV3YXJlKHtcbiAgICAgICAgaW5wdXQ6IHBhcnNlZElucHV0LFxuICAgICAgICBmaWxlc1xuICAgIH0pO1xuICAgIHlpZWxkKiBFZmZlY3QubG9nRGVidWcoXCJQYXJzaW5nIHJvdXRlIGNvbmZpZ1wiLCBvcHRzLnVwbG9hZGFibGUuX2RlZi5yb3V0ZXJDb25maWcpO1xuICAgIGNvbnN0IHBhcnNlZENvbmZpZyA9IHlpZWxkKiBmaWxsSW5wdXRSb3V0ZUNvbmZpZyhvcHRzLnVwbG9hZGFibGUuX2RlZi5yb3V0ZXJDb25maWcpLnBpcGUoRWZmZWN0LmNhdGNoVGFnKFwiSW52YWxpZFJvdXRlQ29uZmlnXCIsIChlcnIpPT5uZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICBjb2RlOiBcIkJBRF9SRVFVRVNUXCIsXG4gICAgICAgICAgICBtZXNzYWdlOiBcIkludmFsaWQgY29uZmlnXCIsXG4gICAgICAgICAgICBjYXVzZTogZXJyXG4gICAgICAgIH0pKSk7XG4gICAgeWllbGQqIEVmZmVjdC5sb2dEZWJ1ZyhcIlJvdXRlIGNvbmZpZyBwYXJzZWQgc3VjY2Vzc2Z1bGx5XCIsIHBhcnNlZENvbmZpZyk7XG4gICAgeWllbGQqIEVmZmVjdC5sb2dEZWJ1ZyhcIlZhbGlkYXRpbmcgZmlsZXMgbWVldCB0aGUgY29uZmlnIHJlcXVpcmVtZW50c1wiLCBmaWxlcyk7XG4gICAgeWllbGQqIGFzc2VydEZpbGVzTWVldENvbmZpZyhmaWxlcywgcGFyc2VkQ29uZmlnKS5waXBlKEVmZmVjdC5jYXRjaEFsbCgoZSk9Pm5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgIGNvZGU6IFwiQkFEX1JFUVVFU1RcIixcbiAgICAgICAgICAgIG1lc3NhZ2U6IGBJbnZhbGlkIGNvbmZpZzogJHtlLl90YWd9YCxcbiAgICAgICAgICAgIGNhdXNlOiBcInJlYXNvblwiIGluIGUgPyBlLnJlYXNvbiA6IGUubWVzc2FnZVxuICAgICAgICB9KSkpO1xuICAgIGNvbnN0IGNhbGxiYWNrVXJsID0geWllbGQqIHJlc29sdmVDYWxsYmFja1VybC5waXBlKEVmZmVjdC50YXBFcnJvcigoZXJyb3IpPT5FZmZlY3QubG9nRXJyb3IoXCJGYWlsZWQgdG8gcmVzb2x2ZSBjYWxsYmFjayBVUkxcIiwgZXJyb3IpKSwgRWZmZWN0LmNhdGNoVGFnKFwiSW52YWxpZFVSTFwiLCAoZXJyKT0+bmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgY29kZTogXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIixcbiAgICAgICAgICAgIG1lc3NhZ2U6IGVyci5tZXNzYWdlXG4gICAgICAgIH0pKSk7XG4gICAgeWllbGQqIEVmZmVjdC5sb2dEZWJ1ZyhcIlJldHJpZXZpbmcgcHJlc2lnbmVkIFVSTHMgZnJvbSBVcGxvYWRUaGluZy4gQ2FsbGJhY2sgVVJMIGlzOlwiLCBjYWxsYmFja1VybC5ocmVmKTtcbiAgICBjb25zdCBwcmVzaWduZWRVcmxzID0geWllbGQqIGZldGNoRWZmSnNvbihnZW5lcmF0ZVVwbG9hZFRoaW5nVVJMKFwiL2FwaS9wcmVwYXJlVXBsb2FkXCIpLCBQcmVzaWduZWRVUkxSZXNwb25zZVNjaGVtYSwge1xuICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBmaWxlczogZmlsZXNXaXRoQ3VzdG9tSWRzLFxuICAgICAgICAgICAgcm91dGVDb25maWc6IHBhcnNlZENvbmZpZyxcbiAgICAgICAgICAgIG1ldGFkYXRhLFxuICAgICAgICAgICAgY2FsbGJhY2tVcmw6IGNhbGxiYWNrVXJsLm9yaWdpbiArIGNhbGxiYWNrVXJsLnBhdGhuYW1lLFxuICAgICAgICAgICAgY2FsbGJhY2tTbHVnOiBvcHRzLnNsdWdcbiAgICAgICAgfSksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiXG4gICAgICAgIH1cbiAgICB9KTtcbiAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiVXBsb2FkVGhpbmcgcmVzcG9uZGVkIHdpdGg6XCIsIHByZXNpZ25lZFVybHMpO1xuICAgIHlpZWxkKiBFZmZlY3QubG9nRGVidWcoXCJTZW5kaW5nIHByZXNpZ25lZCBVUkxzIHRvIGNsaWVudFwiKTtcbiAgICBsZXQgcHJvbWlzZSA9IHVuZGVmaW5lZDtcbiAgICBpZiAob3B0cy5pc0Rldikge1xuICAgICAgICBjb25zdCBmZXRjaENvbnRleHQgPSB5aWVsZCogRmV0Y2hDb250ZXh0O1xuICAgICAgICBwcm9taXNlID0gRWZmZWN0LmZvckVhY2gocHJlc2lnbmVkVXJscywgKGZpbGUpPT5jb25kaXRpb25hbERldlNlcnZlcihmaWxlLmtleSwgb3B0cy5hcGlLZXkpLCB7XG4gICAgICAgICAgICBjb25jdXJyZW5jeTogMTBcbiAgICAgICAgfSkucGlwZShFZmZlY3QucHJvdmlkZShDb25zb2xhTG9nZ2VyKSwgRWZmZWN0LnByb3ZpZGVTZXJ2aWNlKEZldGNoQ29udGV4dCwgZmV0Y2hDb250ZXh0KSwgRWZmZWN0LnJ1blByb21pc2UpO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBib2R5OiBwcmVzaWduZWRVcmxzLFxuICAgICAgICBjbGVhbnVwOiBwcm9taXNlXG4gICAgfTtcbn0pO1xuY29uc3QgaGFuZGxlTXVsdGlwYXJ0Q29tcGxldGVBY3Rpb24gPSBFZmZlY3QuZ2VuKGZ1bmN0aW9uKigpIHtcbiAgICBjb25zdCBvcHRzID0geWllbGQqIFJlcXVlc3RJbnB1dDtcbiAgICBjb25zdCByZXF1ZXN0SW5wdXQgPSB5aWVsZCogcGFyc2VSZXF1ZXN0SnNvbihvcHRzLnJlcSwgTXVsdGlwYXJ0Q29tcGxldGVBY3Rpb25QYXlsb2FkKTtcbiAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiSGFuZGxpbmcgbXVsdGlwYXJ0LWNvbXBsZXRlIHJlcXVlc3Qgd2l0aCBpbnB1dDpcIiwgcmVxdWVzdElucHV0KTtcbiAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiTm90aWZ5aW5nIFVwbG9hZFRoaW5nIHRoYXQgbXVsdGlwYXJ0IHVwbG9hZCBpcyBjb21wbGV0ZVwiKTtcbiAgICBjb25zdCBjb21wbGV0aW9uUmVzcG9uc2UgPSB5aWVsZCogY29tcGxldGVNdWx0aXBhcnRVcGxvYWQoe1xuICAgICAgICBrZXk6IHJlcXVlc3RJbnB1dC5maWxlS2V5LFxuICAgICAgICB1cGxvYWRJZDogcmVxdWVzdElucHV0LnVwbG9hZElkXG4gICAgfSwgcmVxdWVzdElucHV0LmV0YWdzKTtcbiAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiVXBsb2FkVGhpbmcgcmVzcG9uZGVkIHdpdGg6XCIsIGNvbXBsZXRpb25SZXNwb25zZSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgYm9keTogbnVsbFxuICAgIH07XG59KTtcbmNvbnN0IGhhbmRsZU11bHRpcGFydEZhaWx1cmVBY3Rpb24gPSBFZmZlY3QuZ2VuKGZ1bmN0aW9uKigpIHtcbiAgICBjb25zdCB7IHJlcSwgdXBsb2FkYWJsZSB9ID0geWllbGQqIFJlcXVlc3RJbnB1dDtcbiAgICBjb25zdCB7IGZpbGVLZXksIHVwbG9hZElkIH0gPSB5aWVsZCogcGFyc2VSZXF1ZXN0SnNvbihyZXEsIEZhaWx1cmVBY3Rpb25QYXlsb2FkKTtcbiAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiSGFuZGxpbmcgZmFpbHVyZSByZXF1ZXN0IHdpdGggaW5wdXQ6XCIsIHtcbiAgICAgICAgZmlsZUtleSxcbiAgICAgICAgdXBsb2FkSWRcbiAgICB9KTtcbiAgICB5aWVsZCogRWZmZWN0LmxvZ0RlYnVnKFwiTm90aWZ5aW5nIFVwbG9hZFRoaW5nIHRoYXQgdXBsb2FkIGZhaWxlZFwiKTtcbiAgICBjb25zdCBmYWlsdXJlUmVzcG9uc2UgPSB5aWVsZCogYWJvcnRNdWx0aXBhcnRVcGxvYWQoe1xuICAgICAgICBrZXk6IGZpbGVLZXksXG4gICAgICAgIHVwbG9hZElkXG4gICAgfSk7XG4gICAgeWllbGQqIEVmZmVjdC5sb2dEZWJ1ZyhcIlVwbG9hZFRoaW5nIHJlc3BvbmRlZCB3aXRoOlwiLCBmYWlsdXJlUmVzcG9uc2UpO1xuICAgIHlpZWxkKiBFZmZlY3QubG9nRGVidWcoXCJSdW5uaW5nICdvblVwbG9hZEVycm9yJyBjYWxsYmFja1wiKTtcbiAgICB5aWVsZCogRWZmZWN0LnRyeSh7XG4gICAgICAgIHRyeTogKCk9PntcbiAgICAgICAgICAgIHVwbG9hZGFibGUuX2RlZi5vblVwbG9hZEVycm9yKHtcbiAgICAgICAgICAgICAgICBlcnJvcjogbmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBjb2RlOiBcIlVQTE9BRF9GQUlMRURcIixcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogYFVwbG9hZCBmYWlsZWQgZm9yICR7ZmlsZUtleX1gXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgZmlsZUtleVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIGNhdGNoOiAoZXJyb3IpPT5uZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIixcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIkZhaWxlZCB0byBydW4gb25VcGxvYWRFcnJvclwiLFxuICAgICAgICAgICAgICAgIGNhdXNlOiBlcnJvclxuICAgICAgICAgICAgfSlcbiAgICB9KS5waXBlKEVmZmVjdC50YXBFcnJvcigoZXJyb3IpPT5FZmZlY3QubG9nRXJyb3IoXCJGYWlsZWQgdG8gcnVuIG9uVXBsb2FkRXJyb3IuIFlvdSBwcm9iYWJseSBzaG91bGRuJ3QgYmUgdGhyb3dpbmcgZXJyb3JzIGhlcmUuXCIsIGVycm9yKSkpO1xuICAgIHJldHVybiB7XG4gICAgICAgIGJvZHk6IG51bGxcbiAgICB9O1xufSk7XG5jb25zdCBidWlsZFBlcm1pc3Npb25zSW5mb0hhbmRsZXIgPSAob3B0cyk9PntcbiAgICByZXR1cm4gKCk9PntcbiAgICAgICAgY29uc3QgcGVybWlzc2lvbnMgPSBvYmplY3RLZXlzKG9wdHMucm91dGVyKS5tYXAoKHNsdWcpPT57XG4gICAgICAgICAgICBjb25zdCByb3V0ZSA9IG9wdHMucm91dGVyW3NsdWddO1xuICAgICAgICAgICAgY29uc3QgY29uZmlnID0gRWZmZWN0LnJ1blN5bmMoZmlsbElucHV0Um91dGVDb25maWcocm91dGUuX2RlZi5yb3V0ZXJDb25maWcpKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc2x1ZyxcbiAgICAgICAgICAgICAgICBjb25maWdcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcGVybWlzc2lvbnM7XG4gICAgfTtcbn07XG5cbmZ1bmN0aW9uIGluY29tcGF0aWJsZU5vZGVHdWFyZCgpIHtcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MgPT09IFwidW5kZWZpbmVkXCIpIHJldHVybjtcbiAgICBsZXQgbWFqb3I7XG4gICAgbGV0IG1pbm9yO1xuICAgIGNvbnN0IG1heWJlTm9kZVZlcnNpb24gPSBwcm9jZXNzLnZlcnNpb25zPy5ub2RlPy5zcGxpdChcIi5cIik7XG4gICAgaWYgKG1heWJlTm9kZVZlcnNpb24pIHtcbiAgICAgICAgW21ham9yLCBtaW5vcl0gPSBtYXliZU5vZGVWZXJzaW9uLm1hcCgodik9PnBhcnNlSW50KHYsIDEwKSk7XG4gICAgfVxuICAgIGNvbnN0IG1heWJlTm9kZVBhdGggPSBwcm9jZXNzLmVudj8uTk9ERTtcbiAgICBpZiAoIW1ham9yICYmIG1heWJlTm9kZVBhdGgpIHtcbiAgICAgICAgY29uc3Qgbm9kZVZlcnNpb24gPSAvdihcXGQrKVxcLihcXGQrKVxcLihcXGQrKS8uZXhlYyhtYXliZU5vZGVQYXRoKT8uWzBdO1xuICAgICAgICBpZiAobm9kZVZlcnNpb24pIHtcbiAgICAgICAgICAgIFttYWpvciwgbWlub3JdID0gbm9kZVZlcnNpb24uc3Vic3RyaW5nKDEpLnNwbGl0KFwiLlwiKS5tYXAoKHYpPT5wYXJzZUludCh2LCAxMCkpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghbWFqb3IgfHwgIW1pbm9yKSByZXR1cm47XG4gICAgLy8gUmVxdWlyZSBeMTguMTMuMFxuICAgIGlmIChtYWpvciA+IDE4KSByZXR1cm47XG4gICAgaWYgKG1ham9yID09PSAxOCAmJiBtaW5vciA+PSAxMykgcmV0dXJuO1xuICAgIEVmZmVjdC5ydW5TeW5jKEVmZmVjdC5sb2dFcnJvcihgWU9VIEFSRSBVU0lORyBBIExFR0FDWSAoJHttYWpvcn0uJHttaW5vcn0pIE5PREUgVkVSU0lPTiBXSElDSCBJU04nVCBPRkZJQ0lBTExZIFNVUFBPUlRFRC4gUExFQVNFIFVQR1JBREUgVE8gTk9ERSBeMTguMTMuYCkpO1xuICAgIC8vIEtpbGwgdGhlIHByb2Nlc3MgaWYgaXQgaXNuJ3QgZ29pbmcgdG8gd29yayBjb3JyZWN0bHkgYW55d2F5XG4gICAgLy8gSWYgd2UndmUgZ290dGVuIHRoaXMgZmFyIHdlIGtub3cgd2UgaGF2ZSBhIE5vZGUuanMgcnVudGltZSBzbyBleGl0IGlzIGRlZmluZWQuIE92ZXJyaWRlIHN0ZC1lbnYgdHlwZS5cbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzLCBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWNhbGxcbiAgICBwcm9jZXNzLmV4aXQ/LigxKTtcbn1cblxuZnVuY3Rpb24gaW50ZXJuYWxDcmVhdGVCdWlsZGVyKGluaXREZWYgPSB7fSkge1xuICAgIGNvbnN0IF9kZWYgPSB7XG4gICAgICAgIC8vIERlZmF1bHQgcm91dGVyIGNvbmZpZ1xuICAgICAgICByb3V0ZXJDb25maWc6IHtcbiAgICAgICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgICAgICAgbWF4RmlsZVNpemU6IFwiNE1CXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSxcbiAgICAgICAgaW5wdXRQYXJzZXI6IHtcbiAgICAgICAgICAgIHBhcnNlOiAoKT0+dW5kZWZpbmVkLFxuICAgICAgICAgICAgX2lucHV0OiB1bmRlZmluZWQsXG4gICAgICAgICAgICBfb3V0cHV0OiB1bmRlZmluZWRcbiAgICAgICAgfSxcbiAgICAgICAgbWlkZGxld2FyZTogKCk9Pih7fSksXG4gICAgICAgIG9uVXBsb2FkRXJyb3I6ICgpPT4oe30pLFxuICAgICAgICBlcnJvckZvcm1hdHRlcjogaW5pdERlZi5lcnJvckZvcm1hdHRlciA/PyBkZWZhdWx0RXJyb3JGb3JtYXR0ZXIsXG4gICAgICAgIC8vIE92ZXJsb2FkIHdpdGggcHJvcGVydGllcyBwYXNzZWQgaW5cbiAgICAgICAgLi4uaW5pdERlZlxuICAgIH07XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaW5wdXQgKHVzZXJQYXJzZXIpIHtcbiAgICAgICAgICAgIHJldHVybiBpbnRlcm5hbENyZWF0ZUJ1aWxkZXIoe1xuICAgICAgICAgICAgICAgIC4uLl9kZWYsXG4gICAgICAgICAgICAgICAgaW5wdXRQYXJzZXI6IHVzZXJQYXJzZXJcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuICAgICAgICBtaWRkbGV3YXJlICh1c2VyTWlkZGxld2FyZSkge1xuICAgICAgICAgICAgcmV0dXJuIGludGVybmFsQ3JlYXRlQnVpbGRlcih7XG4gICAgICAgICAgICAgICAgLi4uX2RlZixcbiAgICAgICAgICAgICAgICBtaWRkbGV3YXJlOiB1c2VyTWlkZGxld2FyZVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG4gICAgICAgIG9uVXBsb2FkQ29tcGxldGUgKHVzZXJVcGxvYWRDb21wbGV0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBfZGVmLFxuICAgICAgICAgICAgICAgIHJlc29sdmVyOiB1c2VyVXBsb2FkQ29tcGxldGVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0sXG4gICAgICAgIG9uVXBsb2FkRXJyb3IgKHVzZXJPblVwbG9hZEVycm9yKSB7XG4gICAgICAgICAgICByZXR1cm4gaW50ZXJuYWxDcmVhdGVCdWlsZGVyKHtcbiAgICAgICAgICAgICAgICAuLi5fZGVmLFxuICAgICAgICAgICAgICAgIG9uVXBsb2FkRXJyb3I6IHVzZXJPblVwbG9hZEVycm9yXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59XG5mdW5jdGlvbiBjcmVhdGVCdWlsZGVyKG9wdHMpIHtcbiAgICByZXR1cm4gKGlucHV0KT0+e1xuICAgICAgICByZXR1cm4gaW50ZXJuYWxDcmVhdGVCdWlsZGVyKHtcbiAgICAgICAgICAgIHJvdXRlckNvbmZpZzogaW5wdXQsXG4gICAgICAgICAgICAuLi5vcHRzXG4gICAgICAgIH0pO1xuICAgIH07XG59XG5cbi8qKlxuICogRXh0ZW5zaW9uIG9mIHRoZSBCbG9iIGNsYXNzIHRoYXQgc2ltcGxpZmllcyBzZXR0aW5nIHRoZSBgbmFtZWAgYW5kIGBjdXN0b21JZGAgcHJvcGVydGllcyxcbiAqIHNpbWlsYXIgdG8gdGhlIGJ1aWx0LWluIEZpbGUgY2xhc3MgZnJvbSBOb2RlID4gMjAuXG4gKi8gY2xhc3MgVVRGaWxlIGV4dGVuZHMgQmxvYiB7XG4gICAgY29uc3RydWN0b3IocGFydHMsIG5hbWUsIG9wdGlvbnMpe1xuICAgICAgICBjb25zdCBvcHRpb25zV2l0aERlZmF1bHRzID0ge1xuICAgICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgICAgIHR5cGU6IG9wdGlvbnM/LnR5cGUgPz8gKGxvb2t1cChuYW1lKSB8fCBcImFwcGxpY2F0aW9uL29jdGV0LXN0cmVhbVwiKSxcbiAgICAgICAgICAgIGxhc3RNb2RpZmllZDogb3B0aW9ucz8ubGFzdE1vZGlmaWVkID8/IERhdGUubm93KClcbiAgICAgICAgfTtcbiAgICAgICAgc3VwZXIocGFydHMsIG9wdGlvbnNXaXRoRGVmYXVsdHMpO1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLmN1c3RvbUlkID0gb3B0aW9uc1dpdGhEZWZhdWx0cy5jdXN0b21JZDtcbiAgICAgICAgdGhpcy5sYXN0TW9kaWZpZWQgPSBvcHRpb25zV2l0aERlZmF1bHRzLmxhc3RNb2RpZmllZDtcbiAgICB9XG59XG5cbmNvbnN0IHVwbG9hZFByZXNpZ25lZFBvc3QgPSAoZmlsZSwgcHJlc2lnbmVkKT0+RWZmZWN0LmdlbihmdW5jdGlvbiooKSB7XG4gICAgICAgIHlpZWxkKiBFZmZlY3QubG9nRGVidWcoYFVwbG9hZGluZyBmaWxlICR7ZmlsZS5uYW1lfSB1c2luZyBwcmVzaWduZWQgUE9TVCBVUkxgKTtcbiAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgT2JqZWN0LmVudHJpZXMocHJlc2lnbmVkLmZpZWxkcykuZm9yRWFjaCgoW2ssIHZdKT0+Zm9ybURhdGEuYXBwZW5kKGssIHYpKTtcbiAgICAgICAgZm9ybURhdGEuYXBwZW5kKFwiZmlsZVwiLCBmaWxlKTsgLy8gRmlsZSBkYXRhICoqTVVTVCBHTyBMQVNUKipcbiAgICAgICAgY29uc3QgcmVzID0geWllbGQqIGZldGNoRWZmKHByZXNpZ25lZC51cmwsIHtcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICBib2R5OiBmb3JtRGF0YSxcbiAgICAgICAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHtcbiAgICAgICAgICAgICAgICBBY2NlcHQ6IFwiYXBwbGljYXRpb24veG1sXCJcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0pLnBpcGUoRWZmZWN0LnRhcEVycm9yQ2F1c2UoKCk9PmZldGNoRWZmSnNvbihnZW5lcmF0ZVVwbG9hZFRoaW5nVVJMKFwiL2FwaS9mYWlsdXJlQ2FsbGJhY2tcIiksIEZhaWx1cmVDYWxsYmFja1Jlc3BvbnNlU2NoZW1hLCB7XG4gICAgICAgICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIGZpbGVLZXk6IHByZXNpZ25lZC5rZXksXG4gICAgICAgICAgICAgICAgICAgIHVwbG9hZElkOiBudWxsXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pKSk7XG4gICAgICAgIGlmICghcmVzLm9rKSB7XG4gICAgICAgICAgICBjb25zdCB0ZXh0ID0geWllbGQqIEVmZmVjdC5wcm9taXNlKHJlcy50ZXh0KTtcbiAgICAgICAgICAgIHlpZWxkKiBFZmZlY3QubG9nRXJyb3IoYEZhaWxlZCB0byB1cGxvYWQgZmlsZSAke2ZpbGUubmFtZX0gdG8gcHJlc2lnbmVkIFBPU1QgVVJMLiBSZXNwb25zZTogJHt0ZXh0fWApO1xuICAgICAgICAgICAgcmV0dXJuIHlpZWxkKiBuZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgY29kZTogXCJVUExPQURfRkFJTEVEXCIsXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogXCJGYWlsZWQgdG8gdXBsb2FkIGZpbGVcIixcbiAgICAgICAgICAgICAgICBjYXVzZTogdGV4dFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgeWllbGQqIEVmZmVjdC5sb2dEZWJ1ZyhcIkZpbGVcIiwgZmlsZS5uYW1lLCBcInVwbG9hZGVkIHN1Y2Nlc3NmdWxseVwiKTtcbiAgICB9KTtcblxuZnVuY3Rpb24gZ3VhcmRTZXJ2ZXJPbmx5KCkge1xuICAgIGlmICh0eXBlb2Ygd2luZG93ICE9PSBcInVuZGVmaW5lZFwiKSB7XG4gICAgICAgIHRocm93IG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgIGNvZGU6IFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsXG4gICAgICAgICAgICBtZXNzYWdlOiBcIlRoZSBgdXRhcGlgIGNhbiBvbmx5IGJlIHVzZWQgb24gdGhlIHNlcnZlci5cIlxuICAgICAgICB9KTtcbiAgICB9XG59XG5jb25zdCB1cGxvYWRGaWxlc0ludGVybmFsID0gKGlucHV0KT0+Z2V0UHJlc2lnbmVkVXJscyhpbnB1dCkucGlwZShFZmZlY3QuYW5kVGhlbigocHJlc2lnbmVkcyk9PkVmZmVjdC5mb3JFYWNoKHByZXNpZ25lZHMsIChmaWxlKT0+dXBsb2FkRmlsZShmaWxlKS5waXBlKEVmZmVjdC5tYXRjaCh7XG4gICAgICAgICAgICAgICAgb25GYWlsdXJlOiAoZXJyb3IpPT4oe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBVcGxvYWRUaGluZ0Vycm9yLnRvT2JqZWN0KGVycm9yIGluc3RhbmNlb2YgVXBsb2FkVGhpbmdFcnJvciA/IGVycm9yIDogbmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiRmFpbGVkIHRvIHVwbG9hZCBmaWxlLlwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvZGU6IFwiQkFEX1JFUVVFU1RcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXVzZTogZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICAgICAgICBvblN1Y2Nlc3M6IChkYXRhKT0+KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogbnVsbFxuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSkpLCB7XG4gICAgICAgICAgICBjb25jdXJyZW5jeTogMTBcbiAgICAgICAgfSkpKTtcbi8qKlxuICogRklYTUU6IGRvd25sb2FkaW5nIGV2ZXJ5dGhpbmcgaW50byBtZW1vcnkgYW5kIHRoZW4gdXBsb2FkXG4gKiBpc24ndCB0aGUgYmVzdC4gV2Ugc2hvdWxkIHN1cHBvcnQgc3RyZWFtcyBzbyB3ZSBjYW4gZG93bmxvYWRcbiAqIGp1c3QgYXMgbXVjaCBhcyB3ZSBuZWVkIGF0IGFueSB0aW1lLlxuICovIGNvbnN0IGRvd25sb2FkRmlsZXMgPSAodXJscywgZG93bmxvYWRFcnJvcnMpPT5FZmZlY3QuZm9yRWFjaCh1cmxzLCAoX3VybCwgaWR4KT0+RWZmZWN0LmdlbihmdW5jdGlvbiooKSB7XG4gICAgICAgICAgICBsZXQgdXJsID0gaXNPYmplY3QoX3VybCkgPyBfdXJsLnVybCA6IF91cmw7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHVybCA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgICAgICAgIC8vIHNpbmNlIGRhdGF1cmxzIHdpbGwgcmVzdWx0IGluIG5hbWUgYmVpbmcgdG9vIGxvbmcsIHRlbGwgdGhlIHVzZXJcbiAgICAgICAgICAgICAgICAvLyB0byB1c2UgdXBsb2FkRmlsZXMgaW5zdGVhZC5cbiAgICAgICAgICAgICAgICBpZiAodXJsLnN0YXJ0c1dpdGgoXCJkYXRhOlwiKSkge1xuICAgICAgICAgICAgICAgICAgICBkb3dubG9hZEVycm9yc1tpZHhdID0gVXBsb2FkVGhpbmdFcnJvci50b09iamVjdChuZXcgVXBsb2FkVGhpbmdFcnJvcih7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb2RlOiBcIkJBRF9SRVFVRVNUXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcIlBsZWFzZSB1c2UgdXBsb2FkRmlsZXMoKSBmb3IgZGF0YSBVUkxzLiB1cGxvYWRGaWxlc0Zyb21VcmwoKSBpcyBpbnRlbmRlZCBmb3IgdXNlIHdpdGggcmVtb3RlIFVSTHMgb25seS5cIlxuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHVybCA9IG5ldyBVUkwodXJsKTtcbiAgICAgICAgICAgIGNvbnN0IHsgbmFtZSA9IHVybC5wYXRobmFtZS5zcGxpdChcIi9cIikucG9wKCkgPz8gXCJ1bmtub3duLWZpbGVuYW1lXCIsIGN1c3RvbUlkID0gdW5kZWZpbmVkIH0gPSBpc09iamVjdChfdXJsKSA/IF91cmwgOiB7fTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0geWllbGQqIGZldGNoRWZmKHVybCk7XG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgZG93bmxvYWRFcnJvcnNbaWR4XSA9IFVwbG9hZFRoaW5nRXJyb3IudG9PYmplY3QobmV3IFVwbG9hZFRoaW5nRXJyb3Ioe1xuICAgICAgICAgICAgICAgICAgICBjb2RlOiBcIkJBRF9SRVFVRVNUXCIsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IFwiRmFpbGVkIHRvIGRvd25sb2FkIHJlcXVlc3RlZCBmaWxlLlwiLFxuICAgICAgICAgICAgICAgICAgICBjYXVzZTogcmVzcG9uc2VcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB5aWVsZCogRWZmZWN0LnByb21pc2UoKCk9PnJlc3BvbnNlLmJsb2IoKSkucGlwZShFZmZlY3QuYW5kVGhlbigoYmxvYik9Pm5ldyBVVEZpbGUoW1xuICAgICAgICAgICAgICAgICAgICBibG9iXG4gICAgICAgICAgICAgICAgXSwgbmFtZSwge1xuICAgICAgICAgICAgICAgICAgICBjdXN0b21JZFxuICAgICAgICAgICAgICAgIH0pKSk7XG4gICAgICAgIH0pLCB7XG4gICAgICAgIGNvbmN1cnJlbmN5OiAxMFxuICAgIH0pO1xuY29uc3QgZ2V0UHJlc2lnbmVkVXJscyA9IChpbnB1dCk9PkVmZmVjdC5nZW4oZnVuY3Rpb24qKCkge1xuICAgICAgICBjb25zdCB7IGZpbGVzLCBtZXRhZGF0YSwgY29udGVudERpc3Bvc2l0aW9uLCBhY2wgfSA9IGlucHV0O1xuICAgICAgICBjb25zdCBmaWxlRGF0YSA9IGZpbGVzLm1hcCgoZmlsZSk9Pih7XG4gICAgICAgICAgICAgICAgbmFtZTogZmlsZS5uYW1lID8/IFwidW5uYW1lZC1ibG9iXCIsXG4gICAgICAgICAgICAgICAgdHlwZTogZmlsZS50eXBlLFxuICAgICAgICAgICAgICAgIHNpemU6IGZpbGUuc2l6ZSxcbiAgICAgICAgICAgICAgICAuLi5cImN1c3RvbUlkXCIgaW4gZmlsZSA/IHtcbiAgICAgICAgICAgICAgICAgICAgY3VzdG9tSWQ6IGZpbGUuY3VzdG9tSWRcbiAgICAgICAgICAgICAgICB9IDoge31cbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgeWllbGQqIEVmZmVjdC5sb2dEZWJ1ZyhcIkdldHRpbmcgcHJlc2lnbmVkIFVSTHMgZm9yIGZpbGVzXCIsIGZpbGVEYXRhKTtcbiAgICAgICAgY29uc3QgcmVzcG9uc2VTY2hlbWEgPSBTLlN0cnVjdCh7XG4gICAgICAgICAgICBkYXRhOiBQcmVzaWduZWRVUkxSZXNwb25zZVNjaGVtYVxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgcHJlc2lnbmVkcyA9IHlpZWxkKiBmZXRjaEVmZkpzb24oZ2VuZXJhdGVVcGxvYWRUaGluZ1VSTChcIi9hcGkvdXBsb2FkRmlsZXNcIiksIHJlc3BvbnNlU2NoZW1hLCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgY2FjaGU6IFwibm8tc3RvcmVcIixcbiAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICBmaWxlczogZmlsZURhdGEsXG4gICAgICAgICAgICAgICAgbWV0YWRhdGEsXG4gICAgICAgICAgICAgICAgY29udGVudERpc3Bvc2l0aW9uLFxuICAgICAgICAgICAgICAgIGFjbFxuICAgICAgICAgICAgfSksXG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSkucGlwZShFZmZlY3QuY2F0Y2hUYWcoXCJQYXJzZUVycm9yXCIsIChlKT0+RWZmZWN0LmRpZShlKSksIEVmZmVjdC5jYXRjaFRhZyhcIkZldGNoRXJyb3JcIiwgKGUpPT5FZmZlY3QuZGllKGUpKSk7XG4gICAgICAgIHlpZWxkKiBFZmZlY3QubG9nRGVidWcoXCJHb3QgcHJlc2lnbmVkIFVSTHM6XCIsIHByZXNpZ25lZHMuZGF0YSk7XG4gICAgICAgIHJldHVybiBmaWxlcy5tYXAoKGZpbGUsIGkpPT4oe1xuICAgICAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAgICAgcHJlc2lnbmVkOiBwcmVzaWduZWRzLmRhdGFbaV1cbiAgICAgICAgICAgIH0pKTtcbiAgICB9KTtcbmNvbnN0IHVwbG9hZEZpbGUgPSAoaW5wdXQpPT5FZmZlY3QuZ2VuKGZ1bmN0aW9uKigpIHtcbiAgICAgICAgY29uc3QgeyBmaWxlLCBwcmVzaWduZWQgfSA9IGlucHV0O1xuICAgICAgICBpZiAoXCJ1cmxzXCIgaW4gcHJlc2lnbmVkKSB7XG4gICAgICAgICAgICB5aWVsZCogdXBsb2FkTXVsdGlwYXJ0KGZpbGUsIHByZXNpZ25lZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB5aWVsZCogdXBsb2FkUHJlc2lnbmVkUG9zdChmaWxlLCBwcmVzaWduZWQpO1xuICAgICAgICB9XG4gICAgICAgIHlpZWxkKiBmZXRjaEVmZkpzb24oZ2VuZXJhdGVVcGxvYWRUaGluZ1VSTChgL2FwaS9wb2xsVXBsb2FkLyR7cHJlc2lnbmVkLmtleX1gKSwgUG9sbFVwbG9hZFJlc3BvbnNlU2NoZW1hKS5waXBlKEVmZmVjdC50YXAoRWZmZWN0LmxvZ0RlYnVnKFwiUG9sbGVkIHVwbG9hZFwiLCBwcmVzaWduZWQua2V5KSksIEVmZmVjdC5hbmRUaGVuKChyZXMpPT5yZXMuc3RhdHVzID09PSBcImRvbmVcIiA/IEVmZmVjdC5zdWNjZWVkKHVuZGVmaW5lZCkgOiBFZmZlY3QuZmFpbChuZXcgUmV0cnlFcnJvcigpKSksIEVmZmVjdC5yZXRyeSh7XG4gICAgICAgICAgICB3aGlsZTogKGVycik9PmVyciBpbnN0YW5jZW9mIFJldHJ5RXJyb3IsXG4gICAgICAgICAgICBzY2hlZHVsZTogZXhwb25lbnRpYWxCYWNrb2ZmXG4gICAgICAgIH0pLCBFZmZlY3QuY2F0Y2hUYWcoXCJSZXRyeUVycm9yXCIsIChlKT0+RWZmZWN0LmRpZShlKSkpO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAga2V5OiBwcmVzaWduZWQua2V5LFxuICAgICAgICAgICAgdXJsOiBwcmVzaWduZWQuZmlsZVVybCxcbiAgICAgICAgICAgIG5hbWU6IGZpbGUubmFtZSxcbiAgICAgICAgICAgIHNpemU6IGZpbGUuc2l6ZSxcbiAgICAgICAgICAgIHR5cGU6IGZpbGUudHlwZSxcbiAgICAgICAgICAgIGN1c3RvbUlkOiBcImN1c3RvbUlkXCIgaW4gZmlsZSA/IGZpbGUuY3VzdG9tSWQgPz8gbnVsbCA6IG51bGxcbiAgICAgICAgfTtcbiAgICB9KTtcbmZ1bmN0aW9uIHBhcnNlVGltZVRvU2Vjb25kcyh0aW1lKSB7XG4gICAgY29uc3QgbWF0Y2ggPSB0aW1lLnRvU3RyaW5nKCkuc3BsaXQoLyhcXGQrKS8pLmZpbHRlcihCb29sZWFuKTtcbiAgICBjb25zdCBudW0gPSBOdW1iZXIobWF0Y2hbMF0pO1xuICAgIGNvbnN0IHVuaXQgPSAobWF0Y2hbMV0gPz8gXCJzXCIpLnRyaW0oKS5zbGljZSgwLCAxKTtcbiAgICBjb25zdCBtdWx0aXBsaWVyID0ge1xuICAgICAgICBzOiAxLFxuICAgICAgICBtOiA2MCxcbiAgICAgICAgaDogMzYwMCxcbiAgICAgICAgZDogODY0MDBcbiAgICB9W3VuaXRdO1xuICAgIHJldHVybiBudW0gKiBtdWx0aXBsaWVyO1xufVxuXG5jbGFzcyBVVEFwaSB7XG4gICAgY29uc3RydWN0b3Iob3B0cyl7XG4gICAgICAgIHRoaXMucmVxdWVzdFVwbG9hZFRoaW5nID0gKHBhdGhuYW1lLCBib2R5LCByZXNwb25zZVNjaGVtYSk9PntcbiAgICAgICAgICAgIGNvbnN0IHVybCA9IGdlbmVyYXRlVXBsb2FkVGhpbmdVUkwocGF0aG5hbWUpO1xuICAgICAgICAgICAgRWZmZWN0LnJ1blN5bmMoRWZmZWN0LmxvZ0RlYnVnKFwiUmVxdWVzdGluZyBVcGxvYWRUaGluZzpcIiwge1xuICAgICAgICAgICAgICAgIHVybCxcbiAgICAgICAgICAgICAgICBib2R5LFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHRoaXMuZGVmYXVsdEhlYWRlcnNcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJldHVybiBmZXRjaEVmZkpzb24odXJsLCByZXNwb25zZVNjaGVtYSwge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgICAgICAgY2FjaGU6IFwibm8tc3RvcmVcIixcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShib2R5KSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgIC4uLmZpbHRlck9iamVjdFZhbHVlcyh0aGlzLmRlZmF1bHRIZWFkZXJzLCAodik9PnR5cGVvZiB2ID09PSBcInN0cmluZ1wiKSxcbiAgICAgICAgICAgICAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5waXBlKEVmZmVjdC5jYXRjaFRhZyhcIkZldGNoRXJyb3JcIiwgKGVycik9PkVmZmVjdC5sb2dFcnJvcihcIlJlcXVlc3QgZmFpbGVkOlwiLCBlcnIpLnBpcGUoRWZmZWN0LmFuZFRoZW4oKCk9PkVmZmVjdC5kaWUoZXJyKSkpKSwgRWZmZWN0LmNhdGNoVGFnKFwiUGFyc2VFcnJvclwiLCAoZXJyKT0+RWZmZWN0LmxvZ0Vycm9yKFwiUmVzcG9uc2UgcGFyc2luZyBmYWlsZWQ6XCIsIGVycikucGlwZShFZmZlY3QuYW5kVGhlbigoKT0+RWZmZWN0LmRpZShlcnIpKSkpLCBFZmZlY3QudGFwKChyZXMpPT5FZmZlY3QubG9nRGVidWcoXCJVcGxvYWRUaGluZyByZXNwb25zZTpcIiwgcmVzKSkpO1xuICAgICAgICB9O1xuICAgICAgICB0aGlzLmV4ZWN1dGVBc3luYyA9IChwcm9ncmFtKT0+cHJvZ3JhbS5waXBlKHdpdGhNaW5pbWFsTG9nTGV2ZWwodGhpcy5sb2dMZXZlbCksIEVmZmVjdC5wcm92aWRlKENvbnNvbGFMb2dnZXIpLCBFZmZlY3QucHJvdmlkZVNlcnZpY2UoRmV0Y2hDb250ZXh0LCB7XG4gICAgICAgICAgICAgICAgZmV0Y2g6IHRoaXMuZmV0Y2gsXG4gICAgICAgICAgICAgICAgYmFzZUhlYWRlcnM6IHRoaXMuZGVmYXVsdEhlYWRlcnNcbiAgICAgICAgICAgIH0pLCBFZmZlY3QucnVuUHJvbWlzZSk7XG4gICAgICAgIC8qKlxuICAgKiBSZXF1ZXN0IHRvIGRlbGV0ZSBmaWxlcyBmcm9tIFVwbG9hZFRoaW5nIHN0b3JhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nIHwgc3RyaW5nW119IGZpbGVLZXlzXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGF3YWl0IGRlbGV0ZUZpbGVzKFwiMmUwZmRiNjQtOTk1Ny00MjYyLThlNDUtZjM3MmJhOTAzYWM4X2ltYWdlLmpwZ1wiKTtcbiAgICpcbiAgICogQGV4YW1wbGVcbiAgICogYXdhaXQgZGVsZXRlRmlsZXMoW1wiMmUwZmRiNjQtOTk1Ny00MjYyLThlNDUtZjM3MmJhOTAzYWM4X2ltYWdlLmpwZ1wiLFwiMTY0OTM1M2ItMDRlYS00OGEyLTlkYjctMzFkZTdmNTYyYzhkX2ltYWdlMi5qcGdcIl0pXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGF3YWl0IGRlbGV0ZUZpbGVzKFwibXlDdXN0b21JZGVudGlmaWVyXCIsIHsga2V5VHlwZTogXCJjdXN0b21JZFwiIH0pXG4gICAqLyB0aGlzLmRlbGV0ZUZpbGVzID0gYXN5bmMgKGtleXMsIG9wdHMpPT57XG4gICAgICAgICAgICBndWFyZFNlcnZlck9ubHkoKTtcbiAgICAgICAgICAgIGNvbnN0IHsga2V5VHlwZSA9IHRoaXMuZGVmYXVsdEtleVR5cGUgfSA9IG9wdHMgPz8ge307XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZVNjaGVtYSA9IFMuU3RydWN0KHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBTLkJvb2xlYW5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZUFzeW5jKHRoaXMucmVxdWVzdFVwbG9hZFRoaW5nKFwiL2FwaS9kZWxldGVGaWxlc1wiLCBrZXlUeXBlID09PSBcImZpbGVLZXlcIiA/IHtcbiAgICAgICAgICAgICAgICBmaWxlS2V5czogYXNBcnJheShrZXlzKVxuICAgICAgICAgICAgfSA6IHtcbiAgICAgICAgICAgICAgICBjdXN0b21JZHM6IGFzQXJyYXkoa2V5cylcbiAgICAgICAgICAgIH0sIHJlc3BvbnNlU2NoZW1hKSk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgKiBSZXF1ZXN0IGZpbGUgVVJMcyBmcm9tIFVwbG9hZFRoaW5nIHN0b3JhZ2UuXG4gICAqIEBwYXJhbSB7c3RyaW5nIHwgc3RyaW5nW119IGZpbGVLZXlzXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGNvbnN0IGRhdGEgPSBhd2FpdCBnZXRGaWxlVXJscyhcIjJlMGZkYjY0LTk5NTctNDI2Mi04ZTQ1LWYzNzJiYTkwM2FjOF9pbWFnZS5qcGdcIik7XG4gICAqIGNvbnNvbGUubG9nKGRhdGEpOyAvLyBbe2tleTogXCIyZTBmZGI2NC05OTU3LTQyNjItOGU0NS1mMzcyYmE5MDNhYzhfaW1hZ2UuanBnXCIsIHVybDogXCJodHRwczovL3VwbG9hZHRoaW5nLmNvbS9mLzJlMGZkYjY0LTk5NTctNDI2Mi04ZTQ1LWYzNzJiYTkwM2FjOF9pbWFnZS5qcGdcIn1dXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGNvbnN0IGRhdGEgPSBhd2FpdCBnZXRGaWxlVXJscyhbXCIyZTBmZGI2NC05OTU3LTQyNjItOGU0NS1mMzcyYmE5MDNhYzhfaW1hZ2UuanBnXCIsXCIxNjQ5MzUzYi0wNGVhLTQ4YTItOWRiNy0zMWRlN2Y1NjJjOGRfaW1hZ2UyLmpwZ1wiXSlcbiAgICogY29uc29sZS5sb2coZGF0YSkgLy8gW3trZXk6IFwiMmUwZmRiNjQtOTk1Ny00MjYyLThlNDUtZjM3MmJhOTAzYWM4X2ltYWdlLmpwZ1wiLCB1cmw6IFwiaHR0cHM6Ly91cGxvYWR0aGluZy5jb20vZi8yZTBmZGI2NC05OTU3LTQyNjItOGU0NS1mMzcyYmE5MDNhYzhfaW1hZ2UuanBnXCIgfSx7a2V5OiBcIjE2NDkzNTNiLTA0ZWEtNDhhMi05ZGI3LTMxZGU3ZjU2MmM4ZF9pbWFnZTIuanBnXCIsIHVybDogXCJodHRwczovL3VwbG9hZHRoaW5nLmNvbS9mLzE2NDkzNTNiLTA0ZWEtNDhhMi05ZGI3LTMxZGU3ZjU2MmM4ZF9pbWFnZTIuanBnXCJ9XVxuICAgKi8gdGhpcy5nZXRGaWxlVXJscyA9IGFzeW5jIChrZXlzLCBvcHRzKT0+e1xuICAgICAgICAgICAgZ3VhcmRTZXJ2ZXJPbmx5KCk7XG4gICAgICAgICAgICBjb25zdCB7IGtleVR5cGUgPSB0aGlzLmRlZmF1bHRLZXlUeXBlIH0gPSBvcHRzID8/IHt9O1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VTY2hlbWEgPSBTLlN0cnVjdCh7XG4gICAgICAgICAgICAgICAgZGF0YTogUy5BcnJheShTLlN0cnVjdCh7XG4gICAgICAgICAgICAgICAgICAgIGtleTogUy5TdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIHVybDogUy5TdHJpbmdcbiAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZUFzeW5jKHRoaXMucmVxdWVzdFVwbG9hZFRoaW5nKFwiL2FwaS9nZXRGaWxlVXJsXCIsIGtleVR5cGUgPT09IFwiZmlsZUtleVwiID8ge1xuICAgICAgICAgICAgICAgIGZpbGVLZXlzOiBrZXlzXG4gICAgICAgICAgICB9IDoge1xuICAgICAgICAgICAgICAgIGN1c3RvbUlkczoga2V5c1xuICAgICAgICAgICAgfSwgcmVzcG9uc2VTY2hlbWEpKTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqXG4gICAqIFJlcXVlc3QgZmlsZSBsaXN0IGZyb20gVXBsb2FkVGhpbmcgc3RvcmFnZS5cbiAgICogQHBhcmFtIHtvYmplY3R9IG9wdHNcbiAgICogQHBhcmFtIHtudW1iZXJ9IG9wdHMubGltaXQgVGhlIG1heGltdW0gbnVtYmVyIG9mIGZpbGVzIHRvIHJldHVyblxuICAgKiBAcGFyYW0ge251bWJlcn0gb3B0cy5vZmZzZXQgVGhlIG51bWJlciBvZiBmaWxlcyB0byBza2lwXG4gICAqXG4gICAqIEBleGFtcGxlXG4gICAqIGNvbnN0IGRhdGEgPSBhd2FpdCBsaXN0RmlsZXMoeyBsaW1pdDogMSB9KTtcbiAgICogY29uc29sZS5sb2coZGF0YSk7IC8vIHsga2V5OiBcIjJlMGZkYjY0LTk5NTctNDI2Mi04ZTQ1LWYzNzJiYTkwM2FjOF9pbWFnZS5qcGdcIiwgaWQ6IFwiMmUwZmRiNjQtOTk1Ny00MjYyLThlNDUtZjM3MmJhOTAzYWM4XCIgfVxuICAgKi8gdGhpcy5saXN0RmlsZXMgPSBhc3luYyAob3B0cyk9PntcbiAgICAgICAgICAgIGd1YXJkU2VydmVyT25seSgpO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VTY2hlbWEgPSBTLlN0cnVjdCh7XG4gICAgICAgICAgICAgICAgZmlsZXM6IFMuQXJyYXkoUy5TdHJ1Y3Qoe1xuICAgICAgICAgICAgICAgICAgICBpZDogUy5TdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIGtleTogUy5TdHJpbmcsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IFMuU3RyaW5nLFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IFMuTGl0ZXJhbChcIkRlbGV0aW9uIFBlbmRpbmdcIiwgXCJGYWlsZWRcIiwgXCJVcGxvYWRlZFwiLCBcIlVwbG9hZGluZ1wiKVxuICAgICAgICAgICAgICAgIH0pKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5leGVjdXRlQXN5bmModGhpcy5yZXF1ZXN0VXBsb2FkVGhpbmcoXCIvYXBpL2xpc3RGaWxlc1wiLCB7XG4gICAgICAgICAgICAgICAgLi4ub3B0c1xuICAgICAgICAgICAgfSwgcmVzcG9uc2VTY2hlbWEpKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5yZW5hbWVGaWxlcyA9IGFzeW5jICh1cGRhdGVzKT0+e1xuICAgICAgICAgICAgZ3VhcmRTZXJ2ZXJPbmx5KCk7XG4gICAgICAgICAgICBjb25zdCByZXNwb25zZVNjaGVtYSA9IFMuU3RydWN0KHtcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiBTLkJvb2xlYW5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZUFzeW5jKHRoaXMucmVxdWVzdFVwbG9hZFRoaW5nKFwiL2FwaS9yZW5hbWVGaWxlc1wiLCB7XG4gICAgICAgICAgICAgICAgdXBkYXRlczogYXNBcnJheSh1cGRhdGVzKVxuICAgICAgICAgICAgfSwgcmVzcG9uc2VTY2hlbWEpKTtcbiAgICAgICAgfTtcbiAgICAgICAgLyoqIEBkZXByZWNhdGVkIFVzZSB7QGxpbmsgcmVuYW1lRmlsZXN9IGluc3RlYWQuICovIHRoaXMucmVuYW1lRmlsZSA9IHRoaXMucmVuYW1lRmlsZXM7XG4gICAgICAgIHRoaXMuZ2V0VXNhZ2VJbmZvID0gYXN5bmMgKCk9PntcbiAgICAgICAgICAgIGd1YXJkU2VydmVyT25seSgpO1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VTY2hlbWEgPSBTLlN0cnVjdCh7XG4gICAgICAgICAgICAgICAgdG90YWxCeXRlczogUy5OdW1iZXIsXG4gICAgICAgICAgICAgICAgdG90YWxSZWFkYWJsZTogUy5TdHJpbmcsXG4gICAgICAgICAgICAgICAgYXBwVG90YWxCeXRlczogUy5OdW1iZXIsXG4gICAgICAgICAgICAgICAgYXBwVG90YWxSZWFkYWJsZTogUy5TdHJpbmcsXG4gICAgICAgICAgICAgICAgZmlsZXNVcGxvYWRlZDogUy5OdW1iZXIsXG4gICAgICAgICAgICAgICAgbGltaXRCeXRlczogUy5OdW1iZXIsXG4gICAgICAgICAgICAgICAgbGltaXRSZWFkYWJsZTogUy5TdHJpbmdcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuZXhlY3V0ZUFzeW5jKHRoaXMucmVxdWVzdFVwbG9hZFRoaW5nKFwiL2FwaS9nZXRVc2FnZUluZm9cIiwge30sIHJlc3BvbnNlU2NoZW1hKSk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKiBSZXF1ZXN0IGEgcHJlc2lnbmVkIHVybCBmb3IgYSBwcml2YXRlIGZpbGUocykgKi8gdGhpcy5nZXRTaWduZWRVUkwgPSBhc3luYyAoa2V5LCBvcHRzKT0+e1xuICAgICAgICAgICAgZ3VhcmRTZXJ2ZXJPbmx5KCk7XG4gICAgICAgICAgICBjb25zdCBleHBpcmVzSW4gPSBvcHRzPy5leHBpcmVzSW4gPyBwYXJzZVRpbWVUb1NlY29uZHMob3B0cy5leHBpcmVzSW4pIDogdW5kZWZpbmVkO1xuICAgICAgICAgICAgY29uc3QgeyBrZXlUeXBlID0gdGhpcy5kZWZhdWx0S2V5VHlwZSB9ID0gb3B0cyA/PyB7fTtcbiAgICAgICAgICAgIGlmIChvcHRzPy5leHBpcmVzSW4gJiYgaXNOYU4oZXhwaXJlc0luKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgY29kZTogXCJCQURfUkVRVUVTVFwiLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcImV4cGlyZXNJbiBtdXN0IGJlIGEgdmFsaWQgdGltZSBzdHJpbmcsIGZvciBleGFtcGxlICcxZCcsICcyIGRheXMnLCBvciBhIG51bWJlciBvZiBzZWNvbmRzLlwiXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoZXhwaXJlc0luICYmIGV4cGlyZXNJbiA+IDg2NDAwICogNykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBVcGxvYWRUaGluZ0Vycm9yKHtcbiAgICAgICAgICAgICAgICAgICAgY29kZTogXCJCQURfUkVRVUVTVFwiLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBcImV4cGlyZXNJbiBtdXN0IGJlIGxlc3MgdGhhbiA3IGRheXMgKDYwNDgwMCBzZWNvbmRzKS5cIlxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VTY2hlbWEgPSBTLlN0cnVjdCh7XG4gICAgICAgICAgICAgICAgdXJsOiBTLlN0cmluZ1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5leGVjdXRlQXN5bmModGhpcy5yZXF1ZXN0VXBsb2FkVGhpbmcoXCIvYXBpL3JlcXVlc3RGaWxlQWNjZXNzXCIsIGtleVR5cGUgPT09IFwiZmlsZUtleVwiID8ge1xuICAgICAgICAgICAgICAgIGZpbGVLZXk6IGtleSxcbiAgICAgICAgICAgICAgICBleHBpcmVzSW5cbiAgICAgICAgICAgIH0gOiB7XG4gICAgICAgICAgICAgICAgY3VzdG9tSWQ6IGtleSxcbiAgICAgICAgICAgICAgICBleHBpcmVzSW5cbiAgICAgICAgICAgIH0sIHJlc3BvbnNlU2NoZW1hKSk7XG4gICAgICAgIH07XG4gICAgICAgIC8qKlxuICAgKiBVcGRhdGUgdGhlIEFDTCBvZiBhIGZpbGUgb3Igc2V0IG9mIGZpbGVzLlxuICAgKlxuICAgKiBAZXhhbXBsZVxuICAgKiAvLyBNYWtlIGEgc2luZ2xlIGZpbGUgcHVibGljXG4gICAqIGF3YWl0IHV0YXBpLnVwZGF0ZUFDTChcIjJlMGZkYjY0LTk5NTctNDI2Mi04ZTQ1LWYzNzJiYTkwM2FjOF9pbWFnZS5qcGdcIiwgXCJwdWJsaWMtcmVhZFwiKTtcbiAgICpcbiAgICogLy8gTWFrZSBtdWx0aXBsZSBmaWxlcyBwcml2YXRlXG4gICAqIGF3YWl0IHV0YXBpLnVwZGF0ZUFDTChcbiAgICogICBbXG4gICAqICAgICBcIjJlMGZkYjY0LTk5NTctNDI2Mi04ZTQ1LWYzNzJiYTkwM2FjOF9pbWFnZS5qcGdcIixcbiAgICogICAgIFwiMTY0OTM1M2ItMDRlYS00OGEyLTlkYjctMzFkZTdmNTYyYzhkX2ltYWdlMi5qcGdcIixcbiAgICogICBdLFxuICAgKiAgIFwicHJpdmF0ZVwiLFxuICAgKiApO1xuICAgKi8gdGhpcy51cGRhdGVBQ0wgPSBhc3luYyAoa2V5cywgYWNsLCBvcHRzKT0+e1xuICAgICAgICAgICAgZ3VhcmRTZXJ2ZXJPbmx5KCk7XG4gICAgICAgICAgICBjb25zdCB7IGtleVR5cGUgPSB0aGlzLmRlZmF1bHRLZXlUeXBlIH0gPSBvcHRzID8/IHt9O1xuICAgICAgICAgICAgY29uc3QgdXBkYXRlcyA9IGFzQXJyYXkoa2V5cykubWFwKChrZXkpPT57XG4gICAgICAgICAgICAgICAgcmV0dXJuIGtleVR5cGUgPT09IFwiZmlsZUtleVwiID8ge1xuICAgICAgICAgICAgICAgICAgICBmaWxlS2V5OiBrZXksXG4gICAgICAgICAgICAgICAgICAgIGFjbFxuICAgICAgICAgICAgICAgIH0gOiB7XG4gICAgICAgICAgICAgICAgICAgIGN1c3RvbUlkOiBrZXksXG4gICAgICAgICAgICAgICAgICAgIGFjbFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlU2NoZW1hID0gUy5TdHJ1Y3Qoe1xuICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IFMuQm9vbGVhblxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5leGVjdXRlQXN5bmModGhpcy5yZXF1ZXN0VXBsb2FkVGhpbmcoXCIvYXBpL3VwZGF0ZUFDTFwiLCB7XG4gICAgICAgICAgICAgICAgdXBkYXRlc1xuICAgICAgICAgICAgfSwgcmVzcG9uc2VTY2hlbWEpKTtcbiAgICAgICAgfTtcbiAgICAgICAgLy8gQXNzZXJ0IHNvbWUgc3R1ZmZcbiAgICAgICAgZ3VhcmRTZXJ2ZXJPbmx5KCk7XG4gICAgICAgIGluY29tcGF0aWJsZU5vZGVHdWFyZCgpO1xuICAgICAgICBjb25zdCBhcGlLZXkgPSBnZXRBcGlLZXlPclRocm93KG9wdHM/LmFwaUtleSk7XG4gICAgICAgIHRoaXMuZmV0Y2ggPSBvcHRzPy5mZXRjaCA/PyBnbG9iYWxUaGlzLmZldGNoO1xuICAgICAgICB0aGlzLmRlZmF1bHRIZWFkZXJzID0ge1xuICAgICAgICAgICAgXCJ4LXVwbG9hZHRoaW5nLWFwaS1rZXlcIjogYXBpS2V5LFxuICAgICAgICAgICAgXCJ4LXVwbG9hZHRoaW5nLXZlcnNpb25cIjogdmVyc2lvbixcbiAgICAgICAgICAgIFwieC11cGxvYWR0aGluZy1iZS1hZGFwdGVyXCI6IFwic2VydmVyLXNka1wiLFxuICAgICAgICAgICAgXCJ4LXVwbG9hZHRoaW5nLWZlLXBhY2thZ2VcIjogdW5kZWZpbmVkXG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZGVmYXVsdEtleVR5cGUgPSBvcHRzPy5kZWZhdWx0S2V5VHlwZSA/PyBcImZpbGVLZXlcIjtcbiAgICAgICAgdGhpcy5sb2dMZXZlbCA9IG9wdHM/LmxvZ0xldmVsO1xuICAgIH1cbiAgICBhc3luYyB1cGxvYWRGaWxlcyhmaWxlcywgb3B0cykge1xuICAgICAgICBndWFyZFNlcnZlck9ubHkoKTtcbiAgICAgICAgY29uc3QgdXBsb2FkcyA9IGF3YWl0IHRoaXMuZXhlY3V0ZUFzeW5jKHVwbG9hZEZpbGVzSW50ZXJuYWwoe1xuICAgICAgICAgICAgZmlsZXM6IGFzQXJyYXkoZmlsZXMpLFxuICAgICAgICAgICAgY29udGVudERpc3Bvc2l0aW9uOiBvcHRzPy5jb250ZW50RGlzcG9zaXRpb24gPz8gXCJpbmxpbmVcIixcbiAgICAgICAgICAgIG1ldGFkYXRhOiBvcHRzPy5tZXRhZGF0YSA/PyB7fSxcbiAgICAgICAgICAgIGFjbDogb3B0cz8uYWNsXG4gICAgICAgIH0pKTtcbiAgICAgICAgY29uc3QgdXBsb2FkRmlsZVJlc3BvbnNlID0gQXJyYXkuaXNBcnJheShmaWxlcykgPyB1cGxvYWRzIDogdXBsb2Fkc1swXTtcbiAgICAgICAgRWZmZWN0LnJ1blN5bmMoRWZmZWN0LmxvZ0RlYnVnKFwiRmluaXNoZWQgdXBsb2FkaW5nOlwiLCB1cGxvYWRGaWxlUmVzcG9uc2UpKTtcbiAgICAgICAgcmV0dXJuIHVwbG9hZEZpbGVSZXNwb25zZTtcbiAgICB9XG4gICAgYXN5bmMgdXBsb2FkRmlsZXNGcm9tVXJsKHVybHMsIG9wdHMpIHtcbiAgICAgICAgZ3VhcmRTZXJ2ZXJPbmx5KCk7XG4gICAgICAgIGNvbnN0IGRvd25sb2FkRXJyb3JzID0ge307XG4gICAgICAgIGNvbnN0IHVwbG9hZHMgPSBhd2FpdCB0aGlzLmV4ZWN1dGVBc3luYyhkb3dubG9hZEZpbGVzKGFzQXJyYXkodXJscyksIGRvd25sb2FkRXJyb3JzKS5waXBlKEVmZmVjdC5hbmRUaGVuKChmaWxlcyk9PmZpbGVzLmZpbHRlcigoZik9PmYgIT0gbnVsbCkpLCBFZmZlY3QuYW5kVGhlbigoZmlsZXMpPT51cGxvYWRGaWxlc0ludGVybmFsKHtcbiAgICAgICAgICAgICAgICBmaWxlcyxcbiAgICAgICAgICAgICAgICBjb250ZW50RGlzcG9zaXRpb246IG9wdHM/LmNvbnRlbnREaXNwb3NpdGlvbiA/PyBcImlubGluZVwiLFxuICAgICAgICAgICAgICAgIG1ldGFkYXRhOiBvcHRzPy5tZXRhZGF0YSA/PyB7fSxcbiAgICAgICAgICAgICAgICBhY2w6IG9wdHM/LmFjbFxuICAgICAgICAgICAgfSkpKSk7XG4gICAgICAgIC8qKiBQdXQgaXQgYWxsIGJhY2sgdG9nZXRoZXIsIHByZXNlcnZlIHRoZSBvcmRlciBvZiBmaWxlcyAqLyBjb25zdCByZXNwb25zZXMgPSBhc0FycmF5KHVybHMpLm1hcCgoXywgaW5kZXgpPT57XG4gICAgICAgICAgICBpZiAoZG93bmxvYWRFcnJvcnNbaW5kZXhdKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGRvd25sb2FkRXJyb3JzW2luZGV4XVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdXBsb2Fkcy5zaGlmdCgpO1xuICAgICAgICB9KTtcbiAgICAgICAgLyoqIFJldHVybiBzaW5nbGUgb2JqZWN0IG9yIGFycmF5IGJhc2VkIG9uIGlucHV0IHVybHMgKi8gY29uc3QgdXBsb2FkRmlsZVJlc3BvbnNlID0gQXJyYXkuaXNBcnJheSh1cmxzKSA/IHJlc3BvbnNlcyA6IHJlc3BvbnNlc1swXTtcbiAgICAgICAgRWZmZWN0LnJ1blN5bmMoRWZmZWN0LmxvZ0RlYnVnKFwiRmluaXNoZWQgdXBsb2FkaW5nOlwiLCB1cGxvYWRGaWxlUmVzcG9uc2UpKTtcbiAgICAgICAgcmV0dXJuIHVwbG9hZEZpbGVSZXNwb25zZTtcbiAgICB9XG59XG5cbmNvbnN0IGNyZWF0ZVVwbG9hZHRoaW5nID0gKG9wdHMpPT5jcmVhdGVCdWlsZGVyKG9wdHMpO1xuLyoqIEBpbnRlcm5hbCAqLyBjb25zdCBJTlRFUk5BTF9ET19OT1RfVVNFX2NyZWF0ZVJvdXRlSGFuZGxlckNvcmUgPSAob3B0cywgYWRhcHRlcik9PntcbiAgICBpbmNvbXBhdGlibGVOb2RlR3VhcmQoKTtcbiAgICBjb25zdCByZXF1ZXN0SGFuZGxlciA9IGJ1aWxkUmVxdWVzdEhhbmRsZXIob3B0cywgYWRhcHRlcik7XG4gICAgY29uc3QgZ2V0QnVpbGRQZXJtcyA9IGJ1aWxkUGVybWlzc2lvbnNJbmZvSGFuZGxlcihvcHRzKTtcbiAgICBjb25zdCBQT1NUID0gYXN5bmMgKHJlcXVlc3QpPT57XG4gICAgICAgIGNvbnN0IHJlcSA9IHJlcXVlc3QgaW5zdGFuY2VvZiBSZXF1ZXN0ID8gcmVxdWVzdCA6IHJlcXVlc3QucmVxdWVzdDtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBydW5SZXF1ZXN0SGFuZGxlckFzeW5jKHJlcXVlc3RIYW5kbGVyLCB7XG4gICAgICAgICAgICByZXEsXG4gICAgICAgICAgICBtaWRkbGV3YXJlQXJnczoge1xuICAgICAgICAgICAgICAgIHJlcSxcbiAgICAgICAgICAgICAgICBldmVudDogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHJlczogdW5kZWZpbmVkXG4gICAgICAgICAgICB9XG4gICAgICAgIH0sIG9wdHMuY29uZmlnKTtcbiAgICAgICAgaWYgKHJlc3BvbnNlLnN1Y2Nlc3MgPT09IGZhbHNlKSB7XG4gICAgICAgICAgICByZXR1cm4gUmVzcG9uc2UuanNvbihmb3JtYXRFcnJvcihyZXNwb25zZS5lcnJvciwgb3B0cy5yb3V0ZXIpLCB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiBnZXRTdGF0dXNDb2RlRnJvbUVycm9yKHJlc3BvbnNlLmVycm9yKSxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgIFwieC11cGxvYWR0aGluZy12ZXJzaW9uXCI6IHZlcnNpb25cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXMgPSBSZXNwb25zZS5qc29uKHJlc3BvbnNlLmJvZHksIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICBcIngtdXBsb2FkdGhpbmctdmVyc2lvblwiOiB2ZXJzaW9uXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIC0gdGhpcyBpcyBhIGN1c3RvbSBwcm9wZXJ0eVxuICAgICAgICByZXMuY2xlYW51cCA9IHJlc3BvbnNlLmNsZWFudXA7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgfTtcbiAgICBjb25zdCBHRVQgPSAocmVxdWVzdCk9PntcbiAgICAgICAgcmV0dXJuIFJlc3BvbnNlLmpzb24oZ2V0QnVpbGRQZXJtcygpLCB7XG4gICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgXCJ4LXVwbG9hZHRoaW5nLXZlcnNpb25cIjogdmVyc2lvblxuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9O1xuICAgIHJldHVybiB7XG4gICAgICAgIEdFVCxcbiAgICAgICAgUE9TVFxuICAgIH07XG59O1xuY29uc3QgY3JlYXRlUm91dGVIYW5kbGVyID0gKG9wdHMpPT5JTlRFUk5BTF9ET19OT1RfVVNFX2NyZWF0ZVJvdXRlSGFuZGxlckNvcmUob3B0cywgXCJzZXJ2ZXJcIik7XG5jb25zdCBleHRyYWN0Um91dGVyQ29uZmlnID0gKHJvdXRlcik9PmJ1aWxkUGVybWlzc2lvbnNJbmZvSGFuZGxlcih7XG4gICAgICAgIHJvdXRlclxuICAgIH0pKCk7XG4vKipcbiAqIEBkZXByZWNhdGVkIFVzZSB7QGxpbmsgY3JlYXRlUm91dGVIYW5kbGVyfSBpbnN0ZWFkXG4gKi8gY29uc3QgY3JlYXRlU2VydmVySGFuZGxlciA9IGNyZWF0ZVJvdXRlSGFuZGxlcjtcblxuZXhwb3J0IHsgSU5URVJOQUxfRE9fTk9UX1VTRV9jcmVhdGVSb3V0ZUhhbmRsZXJDb3JlLCBVVEFwaSwgVVRGaWxlLCBjcmVhdGVSb3V0ZUhhbmRsZXIsIGNyZWF0ZVNlcnZlckhhbmRsZXIsIGNyZWF0ZVVwbG9hZHRoaW5nLCBleHRyYWN0Um91dGVyQ29uZmlnIH07XG4iXSwibmFtZXMiOlsiQ29udGVudERpc3Bvc2l0aW9uU2NoZW1hIiwiZmV0Y2hFZmZKc29uIiwiZ2VuZXJhdGVVcGxvYWRUaGluZ1VSTCIsIlJldHJ5RXJyb3IiLCJleHBvbmVudGlhbEJhY2tvZmYiLCJVcGxvYWRUaGluZ0Vycm9yIiwic2lnblBheWxvYWQiLCJmZXRjaEVmZiIsImlzT2JqZWN0IiwiY29udGVudERpc3Bvc2l0aW9uIiwiYnl0ZXNUb0ZpbGVTaXplIiwiZ2V0VHlwZUZyb21GaWxlTmFtZSIsIm9iamVjdEtleXMiLCJJbnZhbGlkUm91dGVDb25maWdFcnJvciIsImZpbGVTaXplVG9CeXRlcyIsIkZldGNoQ29udGV4dCIsImdldEZ1bGxBcGlVcmwiLCJ2ZXJpZnlTaWduYXR1cmUiLCJwYXJzZVJlcXVlc3RKc29uIiwiZmlsbElucHV0Um91dGVDb25maWciLCJmaWx0ZXJPYmplY3RWYWx1ZXMiLCJhc0FycmF5IiwiZ2V0U3RhdHVzQ29kZUZyb21FcnJvciIsIlMiLCJFZmZlY3QiLCJjcmVhdGVDb25zb2xhIiwiTG9nZ2VyIiwiRWZmZWN0TG9nTGV2ZWwiLCJwcm9jZXNzIiwiaXNEZXZlbG9wbWVudCIsIkNvbnRleHQiLCJUYWdnZWRFcnJvciIsImlzQWN0aW9uVHlwZSIsIlZBTElEX0FDVElPTl9UWVBFUyIsImlzVXBsb2FkVGhpbmdIb29rIiwiVkFMSURfVVRfSE9PS1MiLCJVVEZpbGVzIiwibG9va3VwIiwidmVyc2lvbiIsImRlZmF1bHRFcnJvckZvcm1hdHRlciIsImVycm9yIiwibWVzc2FnZSIsImZvcm1hdEVycm9yIiwicm91dGVyIiwiZXJyb3JGb3JtYXR0ZXIiLCJPYmplY3QiLCJrZXlzIiwiX2RlZiIsIkZpbGVVcGxvYWREYXRhU2NoZW1hIiwiU3RydWN0IiwibmFtZSIsIlN0cmluZyIsInNpemUiLCJOdW1iZXIiLCJ0eXBlIiwiRmlsZVVwbG9hZERhdGFXaXRoQ3VzdG9tSWRTY2hlbWEiLCJleHRlbmQiLCJjdXN0b21JZCIsIk51bGxPciIsIlVwbG9hZGVkRmlsZURhdGFTY2hlbWEiLCJrZXkiLCJ1cmwiLCJQcmVzaWduZWRCYXNlU2NoZW1hIiwiZmlsZU5hbWUiLCJmaWxlVHlwZSIsImZpbGVVcmwiLCJwb2xsaW5nSnd0IiwicG9sbGluZ1VybCIsIk1QVVJlc3BvbnNlU2NoZW1hIiwidXJscyIsIkFycmF5IiwidXBsb2FkSWQiLCJjaHVua1NpemUiLCJjaHVua0NvdW50IiwiUFNQUmVzcG9uc2VTY2hlbWEiLCJmaWVsZHMiLCJSZWNvcmQiLCJQcmVzaWduZWRVUkxSZXNwb25zZVNjaGVtYSIsIlVuaW9uIiwiUG9sbFVwbG9hZFJlc3BvbnNlU2NoZW1hIiwic3RhdHVzIiwiZmlsZURhdGEiLCJvcHRpb25hbCIsImZpbGVLZXkiLCJmaWxlU2l6ZSIsIm1ldGFkYXRhIiwiY2FsbGJhY2tVcmwiLCJjYWxsYmFja1NsdWciLCJGYWlsdXJlQ2FsbGJhY2tSZXNwb25zZVNjaGVtYSIsInN1Y2Nlc3MiLCJCb29sZWFuIiwiU2VydmVyQ2FsbGJhY2tQb3N0UmVzcG9uc2VTY2hlbWEiLCJVcGxvYWRBY3Rpb25QYXlsb2FkIiwiZmlsZXMiLCJpbnB1dCIsIlVua25vd24iLCJGYWlsdXJlQWN0aW9uUGF5bG9hZCIsInN0b3JhZ2VQcm92aWRlckVycm9yIiwiTXVsdGlwYXJ0Q29tcGxldGVBY3Rpb25QYXlsb2FkIiwiZXRhZ3MiLCJ0YWciLCJwYXJ0TnVtYmVyIiwiaXNWYWxpZFJlc3BvbnNlIiwicmVzcG9uc2UiLCJvayIsImhlYWRlcnMiLCJoYXMiLCJjb25kaXRpb25hbERldlNlcnZlciIsImFwaUtleSIsImdlbiIsImZpbGUiLCJwaXBlIiwiYW5kVGhlbiIsInJlcyIsInN1Y2NlZWQiLCJmYWlsIiwicmV0cnkiLCJ3aGlsZSIsImVyciIsInNjaGVkdWxlIiwiY2F0Y2hUYWciLCJlIiwiZGllIiwidW5kZWZpbmVkIiwibG9nRXJyb3IiLCJjb2RlIiwic3RhcnRzV2l0aCIsImxvZ0luZm8iLCJwYXlsb2FkIiwiSlNPTiIsInN0cmluZ2lmeSIsInBhcnNlIiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwic2lnbmF0dXJlIiwidHJ5UHJvbWlzZSIsInRyeSIsImNhdGNoIiwiY2F1c2UiLCJjYWxsYmFja1Jlc3BvbnNlIiwibWV0aG9kIiwiYm9keSIsIlJlc3BvbnNlIiwidHJpbSIsImNvbG9yaXplIiwic3RyIiwibGV2ZWwiLCJpY29ucyIsImZhdGFsIiwid2FybiIsImluZm8iLCJsb2ciLCJkZWJ1ZyIsInRyYWNlIiwiZm9ybWF0U3RhY2siLCJzdGFjayIsImN3ZCIsInNwbGl0Iiwic3BsaWNlIiwibWFwIiwibCIsInJlcGxhY2UiLCJqb2luIiwiZm9ybWF0QXJncyIsImFyZ3MiLCJmbXRBcmdzIiwiYXJnIiwibG9nZ2VyIiwicmVwb3J0ZXJzIiwibG9nT2JqIiwiZGF0ZSIsImljb24iLCJsb2dQcmVmaXgiLCJ0b0xvY2FsZVRpbWVTdHJpbmciLCJsaW5lcyIsImNvbnNvbGUiLCJkZWZhdWx0cyIsImVmZmVjdExvZ2dlckxldmVsVG9Db25zb2xhTGV2ZWwiLCJBbGwiLCJGYXRhbCIsIkVycm9yIiwiSW5mbyIsIkRlYnVnIiwiVHJhY2UiLCJXYXJuaW5nIiwiTm9uZSIsIndpdGhNaW5pbWFsTG9nTGV2ZWwiLCJ3aXRoTWluaW11bUxvZ0xldmVsIiwic2lsZW50IiwidmVyYm9zZSIsIkNvbnNvbGFMb2dnZXIiLCJkZWZhdWx0TG9nZ2VyIiwibWFrZSIsImxvZ0xldmVsIiwiX3RhZyIsInVwbG9hZE11bHRpcGFydCIsInByZXNpZ25lZCIsImxvZ0RlYnVnIiwibGVuZ3RoIiwiZm9yRWFjaCIsImluZGV4Iiwib2Zmc2V0IiwiZW5kIiwiTWF0aCIsIm1pbiIsImNodW5rIiwic2xpY2UiLCJ1cGxvYWRQYXJ0IiwiY29udGVudFR5cGUiLCJtYXhSZXRyaWVzIiwiZXRhZyIsImNvbmN1cnJlbmN5IiwiY29tcGxldGVNdWx0aXBhcnRVcGxvYWQiLCJvcHRzIiwiZ2V0IiwidGltZXMiLCJ0YXBFcnJvclRhZyIsImFib3J0TXVsdGlwYXJ0VXBsb2FkIiwiZ2V0UGFyc2VGbiIsInBhcnNlciIsImdldEFwaUtleSIsImVudiIsIlVQTE9BRFRISU5HX1NFQ1JFVCIsImdldEFwaUtleU9yVGhyb3ciLCJGaWxlU2l6ZU1pc21hdGNoIiwiY29uc3RydWN0b3IiLCJtYXgiLCJhY3R1YWwiLCJyZWFzb24iLCJGaWxlQ291bnRNaXNtYXRjaCIsImJvdW5kdHlwZSIsImJvdW5kIiwiYXNzZXJ0RmlsZXNNZWV0Q29uZmlnIiwicm91dGVDb25maWciLCJjb3VudHMiLCJzaXplTGltaXQiLCJtYXhGaWxlU2l6ZSIsInNpemVMaW1pdEJ5dGVzIiwiX2tleSIsImNvbmZpZyIsImNvdW50IiwibWluRmlsZUNvdW50IiwibWF4RmlsZUNvdW50IiwiUmVxdWVzdElucHV0IiwiVGFnIiwicGFyc2VBbmRWYWxpZGF0ZVJlcXVlc3QiLCJhZGFwdGVyIiwicmVxIiwiaXNFZmZlY3QiLCJVUkwiLCJwYXJhbXMiLCJzZWFyY2hQYXJhbXMiLCJhY3Rpb24iLCJzbHVnIiwiaG9vayIsInV0RnJvbnRlbmRQYWNrYWdlIiwiY2xpZW50VmVyc2lvbiIsInVwbG9hZHRoaW5nU2VjcmV0IiwibXNnIiwidXBsb2FkYWJsZSIsIngiLCJjb250ZXh0VmFsdWUiLCJiYXNlSGVhZGVycyIsImlzRGV2IiwiYmFzZSIsIm1pZGRsZXdhcmVBcmdzIiwicmVzb2x2ZUNhbGxiYWNrVXJsIiwiVVBMT0FEVEhJTkdfVVJMIiwiaG9zdCIsImluY2x1ZGVzIiwicGFyc2VkRnJvbUhlYWRlcnMiLCJsb2dXYXJuaW5nIiwicnVuUmVxdWVzdEhhbmRsZXJBc3luYyIsImhhbmRsZXIiLCJwcm92aWRlIiwicHJvdmlkZVNlcnZpY2UiLCJmZXRjaCIsImdsb2JhbFRoaXMiLCJhc0hhbmRsZXJPdXRwdXQiLCJydW5Qcm9taXNlIiwiZWZmZWN0IiwiY2F0Y2hBbGwiLCJoYW5kbGVSZXF1ZXN0IiwiaGFuZGxlQ2FsbGJhY2tSZXF1ZXN0IiwiaGFuZGxlVXBsb2FkQWN0aW9uIiwiaGFuZGxlTXVsdGlwYXJ0Q29tcGxldGVBY3Rpb24iLCJoYW5kbGVNdWx0aXBhcnRGYWlsdXJlQWN0aW9uIiwib3V0cHV0IiwiYnVpbGRSZXF1ZXN0SGFuZGxlciIsInByb3ZpZGVTZXJ2aWNlRWZmZWN0IiwiY2F0Y2hUYWdzIiwiRmV0Y2hFcnJvciIsImRhdGEiLCJQYXJzZUVycm9yIiwidGFwRXJyb3IiLCJ2ZXJpZmllZCIsImNsb25lIiwidGV4dCIsInJlcXVlc3RJbnB1dCIsInNlcnZlckRhdGEiLCJyZXNvbHZlciIsImNhbGxiYWNrRGF0YSIsInJ1blJvdXRlTWlkZGxld2FyZSIsIm1pZGRsZXdhcmUiLCJmaWxlc1dpdGhDdXN0b21JZHMiLCJpZHgiLCJ0aGVpcnMiLCJpbnB1dFBhcnNlciIsInBhcnNlZElucHV0Iiwicm91dGVyQ29uZmlnIiwicGFyc2VkQ29uZmlnIiwiaHJlZiIsInByZXNpZ25lZFVybHMiLCJvcmlnaW4iLCJwYXRobmFtZSIsInByb21pc2UiLCJmZXRjaENvbnRleHQiLCJjbGVhbnVwIiwiY29tcGxldGlvblJlc3BvbnNlIiwiZmFpbHVyZVJlc3BvbnNlIiwib25VcGxvYWRFcnJvciIsImJ1aWxkUGVybWlzc2lvbnNJbmZvSGFuZGxlciIsInBlcm1pc3Npb25zIiwicm91dGUiLCJydW5TeW5jIiwiaW5jb21wYXRpYmxlTm9kZUd1YXJkIiwibWFqb3IiLCJtaW5vciIsIm1heWJlTm9kZVZlcnNpb24iLCJ2ZXJzaW9ucyIsIm5vZGUiLCJ2IiwicGFyc2VJbnQiLCJtYXliZU5vZGVQYXRoIiwiTk9ERSIsIm5vZGVWZXJzaW9uIiwiZXhlYyIsInN1YnN0cmluZyIsImV4aXQiLCJpbnRlcm5hbENyZWF0ZUJ1aWxkZXIiLCJpbml0RGVmIiwiaW1hZ2UiLCJfaW5wdXQiLCJfb3V0cHV0IiwidXNlclBhcnNlciIsInVzZXJNaWRkbGV3YXJlIiwib25VcGxvYWRDb21wbGV0ZSIsInVzZXJVcGxvYWRDb21wbGV0ZSIsInVzZXJPblVwbG9hZEVycm9yIiwiY3JlYXRlQnVpbGRlciIsIlVURmlsZSIsIkJsb2IiLCJwYXJ0cyIsIm9wdGlvbnMiLCJvcHRpb25zV2l0aERlZmF1bHRzIiwibGFzdE1vZGlmaWVkIiwiRGF0ZSIsIm5vdyIsInVwbG9hZFByZXNpZ25lZFBvc3QiLCJmb3JtRGF0YSIsIkZvcm1EYXRhIiwiZW50cmllcyIsImsiLCJhcHBlbmQiLCJIZWFkZXJzIiwiQWNjZXB0IiwidGFwRXJyb3JDYXVzZSIsImd1YXJkU2VydmVyT25seSIsInVwbG9hZEZpbGVzSW50ZXJuYWwiLCJnZXRQcmVzaWduZWRVcmxzIiwicHJlc2lnbmVkcyIsInVwbG9hZEZpbGUiLCJtYXRjaCIsIm9uRmFpbHVyZSIsInRvT2JqZWN0Iiwib25TdWNjZXNzIiwiZG93bmxvYWRGaWxlcyIsImRvd25sb2FkRXJyb3JzIiwiX3VybCIsInBvcCIsImJsb2IiLCJhY2wiLCJyZXNwb25zZVNjaGVtYSIsImNhY2hlIiwiaSIsInRhcCIsInBhcnNlVGltZVRvU2Vjb25kcyIsInRpbWUiLCJ0b1N0cmluZyIsImZpbHRlciIsIm51bSIsInVuaXQiLCJtdWx0aXBsaWVyIiwicyIsIm0iLCJoIiwiZCIsIlVUQXBpIiwicmVxdWVzdFVwbG9hZFRoaW5nIiwiZGVmYXVsdEhlYWRlcnMiLCJleGVjdXRlQXN5bmMiLCJwcm9ncmFtIiwiZGVsZXRlRmlsZXMiLCJrZXlUeXBlIiwiZGVmYXVsdEtleVR5cGUiLCJmaWxlS2V5cyIsImN1c3RvbUlkcyIsImdldEZpbGVVcmxzIiwibGlzdEZpbGVzIiwiaWQiLCJMaXRlcmFsIiwicmVuYW1lRmlsZXMiLCJ1cGRhdGVzIiwicmVuYW1lRmlsZSIsImdldFVzYWdlSW5mbyIsInRvdGFsQnl0ZXMiLCJ0b3RhbFJlYWRhYmxlIiwiYXBwVG90YWxCeXRlcyIsImFwcFRvdGFsUmVhZGFibGUiLCJmaWxlc1VwbG9hZGVkIiwibGltaXRCeXRlcyIsImxpbWl0UmVhZGFibGUiLCJnZXRTaWduZWRVUkwiLCJleHBpcmVzSW4iLCJpc05hTiIsInVwZGF0ZUFDTCIsInVwbG9hZEZpbGVzIiwidXBsb2FkcyIsInVwbG9hZEZpbGVSZXNwb25zZSIsImlzQXJyYXkiLCJ1cGxvYWRGaWxlc0Zyb21VcmwiLCJmIiwicmVzcG9uc2VzIiwiXyIsInNoaWZ0IiwiY3JlYXRlVXBsb2FkdGhpbmciLCJJTlRFUk5BTF9ET19OT1RfVVNFX2NyZWF0ZVJvdXRlSGFuZGxlckNvcmUiLCJyZXF1ZXN0SGFuZGxlciIsImdldEJ1aWxkUGVybXMiLCJQT1NUIiwicmVxdWVzdCIsIlJlcXVlc3QiLCJldmVudCIsImpzb24iLCJHRVQiLCJjcmVhdGVSb3V0ZUhhbmRsZXIiLCJleHRyYWN0Um91dGVyQ29uZmlnIiwiY3JlYXRlU2VydmVySGFuZGxlciJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/uploadthing/server/index.js\n");

/***/ })

};
;